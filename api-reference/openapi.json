{
  "openapi": "3.1.1",
  "info": {
    "contact": {
      "email": "support@narrative.io",
      "name": "Narrative Support",
      "url": "https://www.narrative.io"
    },
    "termsOfService": "https://www.narrative.io/legal/terms-of-service",
    "x-logo": {
      "url": "https://cdn.narrative.io/images/company-logos/prod/narrative-logo-text-white.svg",
      "backgroundColor": "rgb(9, 34, 166)",
      "altText": "Narrative Logo"
    },
    "description": "The [Narrative Data Collaboration Platform](https://app.narrative.io) API is organized around REST. Our API has predictable resource-oriented URLs, accepts form-encoded request bodies, returns JSON-encoded responses, and uses standard HTTP response codes, authentication, and verbs.\n\n\nThe current version is a pre-release beta.  It may result in unexpected behavior and there may be breaking changes in future releases up to the 1.0 release.",
    "title": "Narrative Data Collaboration Platform API",
    "version": "2.4.x"
  },
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer"
      },
      "App_Token": {
        "type": "http",
        "scheme": "oauth2",
        "description": "App tokens are issued through the [client credentials](https://oauth.net/2/grant-types/client-credentials/) grant type.\nThey allow clients to use the API in the background, without a user present."
      },
      "TokenRequest": {
        "type": "http",
        "scheme": "basic",
        "description": "Security scheme for requesting and refreshing tokens using the /auth/token endpoint.  Uses basic authentication with\n`client_id` as the username and `client_secret` as the password."
      },
      "BearerJWT": {
        "type": "http",
        "scheme": "bearer",
        "description": "Enter the token with the `Bearer: ` prefix, e.g. \"Bearer abcde12345\".\nThe token must not have expired (i.e., `expr` should be in the future), have a company_id and the dataset_id\nThe token can be obtained using the /ingestion/token endpoint"
      },
      "DataPlaneSecretAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-Narrative-Data-Plane-Secret"
      }
    },
    "schemas": {
      "AccessToken": {
        "type": "object",
        "properties": {
          "access_token": {
            "type": "string",
            "description": "The access token",
            "example": "xxxxxxxxxxx"
          },
          "access_token_expires_in": {
            "type": "integer",
            "description": "The TTL of the `access_token` in seconds",
            "example": 3600
          },
          "refresh_token": {
            "type": "string",
            "description": "The refresh token",
            "example": "yyyyyyyyyyy"
          },
          "refresh_token_expires_in": {
            "type": "integer",
            "description": "The TTL of the `refresh_token` in seconds",
            "example": 14400
          }
        },
        "required": [
          "access_token",
          "access_token_expires_in",
          "refresh_token",
          "refresh_token_expires_in"
        ]
      },
      "Permission": {
        "type": "object",
        "required": [
          "access",
          "resource"
        ],
        "properties": {
          "access": {
            "description": "Access type given to the resource",
            "type": "string",
            "enum": [
              "admin",
              "read",
              "write",
              "create",
              "revise"
            ]
          },
          "resource": {
            "description": "The resource that the permission gives access to",
            "type": "string"
          }
        },
        "example": {
          "resource": "datasets",
          "access": "read"
        }
      },
      "AccessTokenWithoutCredentials": {
        "type": "object",
        "required": [
          "id",
          "name",
          "permissions",
          "expires_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "The id of the token"
          },
          "name": {
            "type": "string",
            "description": "The name of the token"
          },
          "permissions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Permission"
            },
            "description": "The permissions granted to the token"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "The token expiration timestamp"
          },
          "access_token": {
            "type": "string",
            "description": "The access token"
          }
        },
        "example": {
          "id": "546c65d6-e589-4d3c-b1fe-7e61711cc418",
          "name": "My Token",
          "permissions": [
            {
              "access": "read",
              "resource": "datasets"
            },
            {
              "access": "write",
              "resource": "datasets"
            },
            {
              "access": "read",
              "resource": "subscriptions"
            },
            {
              "access": "write",
              "resource": "subscriptions"
            }
          ],
          "expires_at": "2023-10-31T11:19:13.400498Z"
        }
      },
      "response": {
        "type": "object",
        "required": [
          "records"
        ],
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AccessTokenWithoutCredentials"
            }
          }
        },
        "example": {
          "records": [
            {
              "id": "546c65d6-e589-4d3c-b1fe-7e61711cc418",
              "name": "My Read/Write Token",
              "permissions": [
                {
                  "access": "read",
                  "resource": "datasets"
                },
                {
                  "access": "write",
                  "resource": "datasets"
                },
                {
                  "access": "read",
                  "resource": "subscriptions"
                },
                {
                  "access": "write",
                  "resource": "subscriptions"
                }
              ],
              "expires_at": "2023-10-31T11:19:13.400498Z"
            },
            {
              "id": "2fb4df74-5318-4ecf-9f23-a8e1066689ba",
              "name": "My Read-Only Token",
              "permissions": [
                {
                  "access": "read",
                  "resource": "datasets"
                },
                {
                  "access": "read",
                  "resource": "subscriptions"
                }
              ],
              "expires_at": "2023-11-30T11:19:13.400498Z"
            }
          ]
        }
      },
      "Error": {
        "type": "object",
        "required": [
          "error",
          "error_description"
        ],
        "properties": {
          "error": {
            "type": "string",
            "example": "Unauthorized"
          },
          "error_description": {
            "type": "string",
            "example": "You are not authorized to use this endpoint."
          }
        }
      },
      "request": {
        "type": "object",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the token"
          },
          "permissions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Permission"
            },
            "description": "The requested permissions"
          },
          "expires_at": {
            "oneOf": [
              {
                "type": "string",
                "format": "date-time",
                "description": "The requested token expiration timestamp"
              },
              {
                "type": "string",
                "format": "date",
                "description": "The requested token expiration date (at midnight)"
              }
            ]
          }
        },
        "example": {
          "name": "My Token",
          "permissions": [
            {
              "access": "read",
              "resource": "datasets"
            },
            {
              "access": "write",
              "resource": "datasets"
            },
            {
              "access": "read",
              "resource": "subscriptions"
            },
            {
              "access": "write",
              "resource": "subscriptions"
            }
          ],
          "expires_at": "2023-10-31T11:19:13.400498Z"
        }
      },
      "tokens_AccessToken": {
        "type": "object",
        "required": [
          "id",
          "name",
          "permissions",
          "expires_at",
          "access_token"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "The id of the token"
          },
          "name": {
            "type": "string",
            "description": "The name of the token"
          },
          "permissions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Permission"
            },
            "description": "The permissions granted to the token"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "description": "The token expiration timestamp"
          },
          "access_token": {
            "type": "string",
            "description": "The access token"
          }
        },
        "example": {
          "id": "546c65d6-e589-4d3c-b1fe-7e61711cc418",
          "name": "My Token",
          "permissions": [
            {
              "access": "read",
              "resource": "datasets"
            },
            {
              "access": "write",
              "resource": "datasets"
            },
            {
              "access": "read",
              "resource": "subscriptions"
            },
            {
              "access": "write",
              "resource": "subscriptions"
            }
          ],
          "expires_at": "2023-10-31T11:19:13.400498Z",
          "access_token": "ldg8uuGibVJNHI9s+dcdIQ=="
        }
      },
      "get_response": {
        "type": "object",
        "required": [
          "record"
        ],
        "properties": {
          "record": {
            "$ref": "#/components/schemas/AccessTokenWithoutCredentials"
          }
        },
        "example": {
          "record": {
            "id": "546c65d6-e589-4d3c-b1fe-7e61711cc418",
            "name": "My Token",
            "permissions": [
              {
                "access": "read",
                "resource": "datasets"
              },
              {
                "access": "write",
                "resource": "datasets"
              },
              {
                "access": "read",
                "resource": "subscriptions"
              },
              {
                "access": "write",
                "resource": "subscriptions"
              }
            ],
            "expires_at": "2023-10-31T11:19:13.400498Z"
          }
        }
      },
      "update_request": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the token"
          },
          "permissions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Permission"
            },
            "description": "The requested permissions"
          },
          "expires_at": {
            "oneOf": [
              {
                "type": "string",
                "format": "date-time",
                "description": "The requested token expiration timestamp"
              },
              {
                "type": "string",
                "format": "date",
                "description": "The requested token expiration date (at midnight)"
              }
            ]
          }
        },
        "example": {
          "name": "My Token",
          "permissions": [
            {
              "access": "read",
              "resource": "datasets"
            },
            {
              "access": "write",
              "resource": "datasets"
            },
            {
              "access": "read",
              "resource": "subscriptions"
            },
            {
              "access": "write",
              "resource": "subscriptions"
            }
          ],
          "expires_at": "2023-10-31T11:19:13.400498Z"
        }
      },
      "AccessRuleName": {
        "type": "string",
        "description": "It should be unique.\nAlso should not intersect with Dataset names.\nMust be <= 256 characters and consist of only alphanumeric characters and underscores."
      },
      "AccessRuleId": {
        "type": "integer",
        "description": "Unique identifier for the access rule."
      },
      "AccessRuleCompanyId": {
        "type": "integer",
        "format": "int64",
        "description": "The id of an existing company",
        "example": 345
      },
      "AccessRuleCompanyName": {
        "type": "string",
        "description": "Name of the company that owns this rule."
      },
      "AccessRuleCompanySlug": {
        "type": "string",
        "description": "Optional. Unique slug assigned to company."
      },
      "AccessRuleDisplayName": {
        "type": "string",
        "description": "Optional. Display Name must be non-empty and less than 1000 chars."
      },
      "AccessRuleDescription": {
        "type": "string",
        "description": "A human-friendly description of the access rule."
      },
      "AccessRuleImage": {
        "type": "string",
        "description": "Optional. Image url must be < 1000 characters, start from https://, ends with one of: jpg, apng, jpeg, jfif, pjpeg, webp, pjp, svg, avif, png, gif, bmp, tiff"
      },
      "AccessRuleTags": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "Optional. `_nio_access_rule` will be added even if not presented. Access Rule tag must be non-empty and less than 256 chars."
      },
      "AccessRuleNQL": {
        "type": "string",
        "description": "NQL query of access rule."
      },
      "AccessRuleSchema": {
        "description": "Schema describing a structure of View (Access Rule)\n",
        "type": "object",
        "additionalProperties": true
      },
      "All": {
        "type": "object",
        "description": "This resource is accessible by anyone.",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "all"
            ]
          }
        },
        "required": [
          "type"
        ]
      },
      "None": {
        "type": "object",
        "description": "This resource is private to the owning company.",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "none"
            ]
          }
        },
        "required": [
          "type"
        ]
      },
      "Anonymous": {
        "type": "object",
        "description": "This resource is visible to non-authenticated users.",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "anonymous"
            ]
          }
        },
        "required": [
          "type"
        ]
      },
      "Inclusion": {
        "type": "object",
        "description": "This resource is accessible by all companies specified in in `company_ids`.",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "inclusion"
            ]
          },
          "company_ids": {
            "type": "array",
            "description": "The companies to which the constraint applies.",
            "items": {
              "type": "integer"
            }
          }
        },
        "required": [
          "type",
          "company_ids"
        ]
      },
      "Exclusion": {
        "type": "object",
        "description": "This resource is accessible by all companies _except_ those specified in `company_ids`.",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "inclusion"
            ]
          },
          "company_ids": {
            "type": "array",
            "description": "The companies to which the constraint applies.",
            "items": {
              "type": "integer"
            }
          }
        },
        "required": [
          "type",
          "company_ids"
        ]
      },
      "View": {
        "type": "object",
        "description": "Describes who can view a resource",
        "properties": {
          "type": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/All"
              },
              {
                "$ref": "#/components/schemas/None"
              },
              {
                "$ref": "#/components/schemas/Anonymous"
              },
              {
                "$ref": "#/components/schemas/Inclusion"
              },
              {
                "$ref": "#/components/schemas/Exclusion"
              }
            ]
          },
          "company_ids": {
            "type": "array",
            "description": "The companies to which the constraint applies.\nOnly valid on types 'inclusion' and 'exclusion'"
          }
        },
        "required": [
          "type"
        ]
      },
      "Query": {
        "type": "object",
        "description": "Describes who can query a resource",
        "properties": {
          "type": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/All"
              },
              {
                "$ref": "#/components/schemas/None"
              },
              {
                "$ref": "#/components/schemas/Inclusion"
              },
              {
                "$ref": "#/components/schemas/Exclusion"
              }
            ]
          },
          "company_ids": {
            "type": "array",
            "description": "The companies to which the constraint applies.\nOnly valid on types 'inclusion' and 'exclusion'"
          }
        },
        "required": [
          "type"
        ]
      },
      "Collaborators": {
        "type": "object",
        "description": "Describes who can view or query a resource",
        "properties": {
          "view": {
            "$ref": "#/components/schemas/View"
          },
          "query": {
            "$ref": "#/components/schemas/Query"
          }
        },
        "required": [
          "view",
          "query"
        ]
      },
      "AccessRulePriceCpmUsd": {
        "type": "number",
        "format": "double",
        "description": "How much to charge for a row which matches this access rule.\nCost per mille (CPM), more commonly called “cost per thousand,” is how much a buyer pays for 1,000 records."
      },
      "AccessRuleDatasetIds": {
        "type": "array",
        "items": {
          "type": "integer",
          "format": "int64"
        },
        "description": "All datasets that were used to form the data."
      },
      "AccessRuleMetadata": {
        "type": "object",
        "description": "An NQL policy describing which columns of which datasets are targeted by an access rule",
        "properties": {
          "created_at": {
            "description": "ISO-8601 timestamp indicating when the access rule was created.",
            "type": "string"
          },
          "updated_at": {
            "description": "ISO-8601 timestamp indicating when the access rule was last updated.",
            "type": "string"
          }
        },
        "required": [
          "created_at",
          "updated_at"
        ]
      },
      "AccessRuleOwnedType": {
        "type": "string",
        "description": "Indicates the ownership of the access rule.",
        "enum": [
          "owned"
        ]
      },
      "AccessRuleIsOwned": {
        "type": "boolean",
        "description": "Indicates if the query is owned by the user's own company."
      },
      "OwnedAccessRuleV2Response": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/AccessRuleName"
          },
          "id": {
            "$ref": "#/components/schemas/AccessRuleId"
          },
          "company_id": {
            "$ref": "#/components/schemas/AccessRuleCompanyId"
          },
          "company_name": {
            "$ref": "#/components/schemas/AccessRuleCompanyName"
          },
          "company_slug": {
            "$ref": "#/components/schemas/AccessRuleCompanySlug"
          },
          "display_name": {
            "$ref": "#/components/schemas/AccessRuleDisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/AccessRuleDescription"
          },
          "image": {
            "$ref": "#/components/schemas/AccessRuleImage"
          },
          "status": {
            "type": "string",
            "description": "Indicates the status of the access rule.\n\nAt the moment the only valid status is `active`.",
            "enum": [
              "active"
            ]
          },
          "tags": {
            "$ref": "#/components/schemas/AccessRuleTags"
          },
          "nql": {
            "$ref": "#/components/schemas/AccessRuleNQL"
          },
          "schema": {
            "$ref": "#/components/schemas/AccessRuleSchema"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "price_cpm_usd": {
            "$ref": "#/components/schemas/AccessRulePriceCpmUsd"
          },
          "dataset_ids": {
            "$ref": "#/components/schemas/AccessRuleDatasetIds"
          },
          "metadata": {
            "$ref": "#/components/schemas/AccessRuleMetadata"
          },
          "type": {
            "$ref": "#/components/schemas/AccessRuleOwnedType"
          },
          "is_owned": {
            "$ref": "#/components/schemas/AccessRuleIsOwned"
          }
        },
        "required": [
          "id",
          "company_id",
          "company_name",
          "status",
          "price_cpm_usd",
          "metadata",
          "type"
        ],
        "example": {
          "name": "access_rule_ebc86610_0907_4374_8fc9_be360f0ff8d0",
          "id": 1,
          "company_id": 1,
          "company_name": "company",
          "company_slug": "company_slug_60a4e678_1d56_48a7_8b8b_4e1d689b11a6",
          "display_name": "display name",
          "description": "description",
          "image": "https://narrative.test/1.png",
          "status": "active",
          "tags": [
            "_nio_access_rule"
          ],
          "nql": "select company_data.\"1\".columnA from company_data.\"1\" WHERE columnA = columnB",
          "schema": {
            "type": "object",
            "properties": {
              "columnA": {
                "display_name": "columnA",
                "type": "string"
              }
            },
            "required": [
              "columnA"
            ]
          },
          "collaborators": {
            "query": {
              "type": "inclusion",
              "company_ids": [
                789
              ]
            },
            "view": {
              "type": "all"
            }
          },
          "price_cpm_usd": 1000.054,
          "metadata": {
            "created_at": "2023-12-14T21:36:51.847901",
            "updated_at": "2023-12-14T21:36:51.847901"
          },
          "dataset_ids": [
            42
          ],
          "type": "owned",
          "is_owned": true
        }
      },
      "AccessRuleSharedType": {
        "type": "string",
        "description": "Indicates the ownership of the access rule.",
        "enum": [
          "explicit_share",
          "implicit_share"
        ]
      },
      "SharedAccessRuleV2Response": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/AccessRuleName"
          },
          "id": {
            "$ref": "#/components/schemas/AccessRuleId"
          },
          "company_id": {
            "$ref": "#/components/schemas/AccessRuleCompanyId"
          },
          "company_name": {
            "$ref": "#/components/schemas/AccessRuleCompanyName"
          },
          "company_slug": {
            "$ref": "#/components/schemas/AccessRuleCompanySlug"
          },
          "display_name": {
            "$ref": "#/components/schemas/AccessRuleDisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/AccessRuleDescription"
          },
          "image": {
            "$ref": "#/components/schemas/AccessRuleImage"
          },
          "tags": {
            "$ref": "#/components/schemas/AccessRuleTags"
          },
          "schema": {
            "$ref": "#/components/schemas/AccessRuleSchema"
          },
          "price_cpm_usd": {
            "$ref": "#/components/schemas/AccessRulePriceCpmUsd"
          },
          "metadata": {
            "$ref": "#/components/schemas/AccessRuleMetadata"
          },
          "type": {
            "$ref": "#/components/schemas/AccessRuleSharedType"
          }
        },
        "required": [
          "id",
          "company_id",
          "company_name",
          "price_cpm_usd",
          "metadata",
          "type"
        ],
        "example": {
          "name": "name",
          "id": 2,
          "company_id": 42,
          "company_name": "company name",
          "company_slug": "sompany_slug",
          "display_name": "access rule",
          "description": "description",
          "image": "https://google.com/1.jpg",
          "tags": [
            "tag"
          ],
          "schema": {
            "type": "object",
            "properties": {
              "id": {
                "order": 1,
                "display_name": "id of field",
                "type": "string"
              }
            },
            "required": [
              "id"
            ]
          },
          "price_cpm_usd": 42.123,
          "metadata": {
            "created_at": "2007-12-03T10:15:30",
            "updated_at": "2008-12-03T10:15:30"
          },
          "type": "explicit_share"
        }
      },
      "AccessRuleV2Response": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/OwnedAccessRuleV2Response"
          },
          {
            "$ref": "#/components/schemas/SharedAccessRuleV2Response"
          }
        ]
      },
      "AccessRuleStatus": {
        "type": "string",
        "description": "Current status of access rule: Active, Archieved",
        "enum": [
          "archived",
          "active"
        ]
      },
      "AccessRuleUpdateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/AccessRuleName"
          },
          "displayName": {
            "$ref": "#/components/schemas/AccessRuleDisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/AccessRuleDescription"
          },
          "tags": {
            "$ref": "#/components/schemas/AccessRuleTags"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "image": {
            "$ref": "#/components/schemas/AccessRuleImage"
          },
          "status": {
            "$ref": "#/components/schemas/AccessRuleStatus"
          },
          "priceCpmUsd": {
            "$ref": "#/components/schemas/AccessRulePriceCpmUsd"
          }
        },
        "example": {
          "display_name": "Updated Access Rule",
          "description": "This is an updated description for the access rule.",
          "image": "http://example.com/updated_image.png",
          "status": "inactive",
          "tags": [
            "updated_tag1",
            "updated_tag2"
          ],
          "collaborators": {
            "query": {
              "type": "inclusion",
              "company_ids": [
                789
              ]
            },
            "view": {
              "type": "all"
            }
          }
        }
      },
      "PrevPage": {
        "type": "integer",
        "format": "int64",
        "description": "The number of previous page (if exists). Also can refer to the latest existing page if non-existing page was requested.",
        "example": 1
      },
      "CurrentPage": {
        "type": "integer",
        "format": "int64",
        "description": "The number of requested page.",
        "example": 1
      },
      "NextPage": {
        "type": "integer",
        "format": "int64",
        "description": "The number of next page (if exists).",
        "example": 42
      },
      "TotalRecords": {
        "type": "integer",
        "format": "int64",
        "description": "Total amount of accessible Access Rules",
        "example": 15000
      },
      "TotalPages": {
        "type": "integer",
        "format": "int64",
        "description": "Total amount of pages.",
        "example": 10
      },
      "AccessRulesV2PaginatedResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AccessRuleV2Response"
            }
          },
          "prev_page": {
            "$ref": "#/components/schemas/PrevPage"
          },
          "current_page": {
            "$ref": "#/components/schemas/CurrentPage"
          },
          "next_page": {
            "$ref": "#/components/schemas/NextPage"
          },
          "total_records": {
            "$ref": "#/components/schemas/TotalRecords"
          },
          "total_pages": {
            "$ref": "#/components/schemas/TotalPages"
          }
        },
        "required": [
          "records"
        ],
        "example": {
          "prev_page": null,
          "current_page": 1,
          "next_page": null,
          "total_records": 2,
          "total_pages": 1,
          "records": [
            {
              "name": "name",
              "id": 2,
              "company_id": 42,
              "company_name": "company name",
              "company_slug": "company_slug",
              "display_name": "access rule",
              "description": "description",
              "image": "https://google.com/1.jpg",
              "tags": [
                "tag"
              ],
              "schema": {
                "type": "object",
                "properties": {
                  "id": {
                    "order": 1,
                    "display_name": "id of field",
                    "type": "string"
                  }
                },
                "required": [
                  "id"
                ]
              },
              "price_cpm_usd": 42,
              "metadata": {
                "created_at": "2007-12-03T10:15:30",
                "updated_at": "2008-12-03T10:15:30"
              },
              "type": "explicit_share"
            },
            {
              "name": "access_rule_ebc86610_0907_4374_8fc9_be360f0ff8d0",
              "id": 1,
              "company_id": 1,
              "company_name": "company",
              "company_slug": "company_slug_60a4e678_1d56_48a7_8b8b_4e1d689b11a6",
              "display_name": "display name",
              "description": "description",
              "image": "https://narrative.test/1.png",
              "status": "active",
              "tags": [
                "_nio_access_rule"
              ],
              "nql": "select company_data.\"1\".columnA from company_data.\"1\" WHERE columnA = columnB",
              "schema": {
                "type": "object",
                "properties": {
                  "columnA": {
                    "display_name": "columnA",
                    "type": "string"
                  }
                },
                "required": [
                  "columnA"
                ]
              },
              "collaborators": {
                "query": {
                  "type": "inclusion",
                  "company_ids": [
                    789
                  ]
                },
                "view": {
                  "type": "all"
                }
              },
              "price_cpm_usd": 1000,
              "metadata": {
                "created_at": "2023-12-14T21:36:51.847901",
                "updated_at": "2023-12-14T21:36:51.847901"
              },
              "dataset_ids": [
                42
              ],
              "type": "owned"
            }
          ]
        }
      },
      "AccessRuleCreateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/AccessRuleName"
          },
          "nql": {
            "$ref": "#/components/schemas/AccessRuleNQL"
          },
          "display_name": {
            "$ref": "#/components/schemas/AccessRuleDisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/AccessRuleDescription"
          },
          "tags": {
            "$ref": "#/components/schemas/AccessRuleTags"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "price_cpm_usd": {
            "$ref": "#/components/schemas/AccessRulePriceCpmUsd"
          }
        },
        "required": [
          "name",
          "nql",
          "collaborators",
          "price_cpm_usd"
        ],
        "example": {
          "name": "example_access_rule",
          "display_name": "Example Access Rule",
          "description": "This is an example access rule.",
          "image_url": "http://example.com/image.png",
          "status": "active",
          "tags": [
            "tag1",
            "tag2"
          ],
          "nql": "SELECT tar.\"maid\" FROM company_data.\"11370\" tar",
          "collaborators": {
            "query": {
              "type": "inclusion",
              "company_ids": [
                789
              ]
            },
            "view": {
              "type": "all"
            }
          },
          "price_cpm_usd": 10
        }
      },
      "UUID": {
        "type": "string",
        "format": "uuid"
      },
      "QueryName": {
        "type": "string",
        "description": "It should be unique.\nMust be <= 256 characters and consist of only alphanumeric characters and underscores."
      },
      "DisplayName": {
        "type": "string",
        "description": "Optional. Display Name must be non-empty and less than 1000 chars."
      },
      "Description": {
        "type": "string",
        "description": "A human-friendly description of the query."
      },
      "Tags": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "Optional. Each tag must be less than 256 chars."
      },
      "CompanyId": {
        "type": "integer",
        "format": "int64",
        "description": "The id of an existing company",
        "example": 345
      },
      "CompanyName": {
        "type": "string",
        "description": "Name of the company."
      },
      "CompanySlug": {
        "type": "string",
        "description": "Unique slug assigned to company."
      },
      "Owner": {
        "type": "object",
        "description": "Information about the owner of the query",
        "properties": {
          "company_id": {
            "$ref": "#/components/schemas/CompanyId"
          },
          "company_name": {
            "$ref": "#/components/schemas/CompanyName"
          },
          "company_slug": {
            "$ref": "#/components/schemas/CompanySlug"
          }
        },
        "required": [
          "company_id",
          "company_name"
        ]
      },
      "IsOwned": {
        "type": "boolean",
        "description": "Whether the requestor owns the query."
      },
      "UserId": {
        "type": "integer",
        "format": "int64",
        "description": "The id of an existing user",
        "example": 345
      },
      "Metadata": {
        "type": "object",
        "description": "Metadata about when and by whom a query was created/updated",
        "properties": {
          "created_by_user_id": {
            "$ref": "#/components/schemas/UserId"
          },
          "created_at": {
            "description": "ISO-8601 timestamp indicating when the query was created.",
            "type": "string"
          },
          "updated_by_user_id": {
            "$ref": "#/components/schemas/UserId"
          },
          "updated_at": {
            "description": "ISO-8601 timestamp indicating when the query was last updated.",
            "type": "string"
          }
        },
        "required": [
          "created_by_user_id",
          "created_at",
          "updated_by",
          "updated_at"
        ]
      },
      "AST": {
        "type": "object",
        "description": "The AST representing the query."
      },
      "OwnedQueryResponse": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/UUID"
          },
          "name": {
            "$ref": "#/components/schemas/QueryName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/Description"
          },
          "tags": {
            "$ref": "#/components/schemas/Tags"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "owner": {
            "$ref": "#/components/schemas/Owner"
          },
          "is_owned": {
            "$ref": "#/components/schemas/IsOwned"
          },
          "metadata": {
            "$ref": "#/components/schemas/Metadata"
          },
          "ast": {
            "$ref": "#/components/schemas/AST"
          }
        },
        "required": [
          "id",
          "name",
          "collaborators",
          "owner",
          "metadata",
          "ast"
        ],
        "example": {
          "name": "query1",
          "id": "7409b999-2a9a-40cd-89dc-8430d85e0391",
          "display_name": "Query One",
          "owner": {
            "company_id": 456,
            "company_name": "ExampleCorp",
            "company_slug": "examplecorp"
          },
          "tags": [
            "tag1",
            "tag2"
          ],
          "collaborators": {
            "query": {
              "type": "inclusion",
              "company_ids": [
                789
              ]
            },
            "view": {
              "type": "all"
            }
          },
          "is_owned": true,
          "metadata": {
            "created_at": "2024-04-12T19:57:05.012908",
            "created_by_user_id": 321,
            "updated_at": "2024-04-12T20:03:48.031825",
            "updated_by_user_id": 321
          },
          "ast": {
            "type": "select",
            "nql": "SELECT age FROM narrative.rosetta_stone",
            "budget": null,
            "columns": [
              {
                "type": "table",
                "nql": "age",
                "db": null,
                "schema": null,
                "table": "age"
              }
            ],
            "from": {
              "type": "table",
              "nql": "narrative.rosetta_stone",
              "db": null,
              "schema": "narrative",
              "table": "rosetta_stone"
            },
            "group_by": [],
            "having": null,
            "is_distinct": false,
            "limit": null,
            "order_by": [],
            "qualify": null,
            "where": null,
            "windows": [],
            "with": []
          }
        }
      },
      "SharedQueryResponse": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/UUID"
          },
          "name": {
            "$ref": "#/components/schemas/QueryName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/Description"
          },
          "tags": {
            "$ref": "#/components/schemas/Tags"
          },
          "owner": {
            "$ref": "#/components/schemas/Owner"
          },
          "is_owned": {
            "$ref": "#/components/schemas/IsOwned"
          },
          "ast": {
            "$ref": "#/components/schemas/AST"
          }
        },
        "required": [
          "id",
          "name",
          "owner",
          "ast"
        ],
        "example": {
          "name": "query1",
          "id": "7409b999-2a9a-40cd-89dc-8430d85e0391",
          "display_name": "Query One",
          "owner": {
            "company_id": 456,
            "company_name": "ExampleCorp",
            "company_slug": "examplecorp"
          },
          "tags": [
            "tag1",
            "tag2"
          ],
          "is_owned": false,
          "ast": {
            "type": "select",
            "nql": "SELECT age FROM narrative.rosetta_stone",
            "budget": null,
            "columns": [
              {
                "type": "table",
                "nql": "age",
                "db": null,
                "schema": null,
                "table": "age"
              }
            ],
            "from": {
              "type": "table",
              "nql": "narrative.rosetta_stone",
              "db": null,
              "schema": "narrative",
              "table": "rosetta_stone"
            },
            "group_by": [],
            "having": null,
            "is_distinct": false,
            "limit": null,
            "order_by": [],
            "qualify": null,
            "where": null,
            "windows": [],
            "with": []
          }
        }
      },
      "QueriesResponse": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/OwnedQueryResponse"
          },
          {
            "$ref": "#/components/schemas/SharedQueryResponse"
          }
        ]
      },
      "UpdateQueryRequest": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/QueryName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/Description"
          },
          "tags": {
            "$ref": "#/components/schemas/Tags"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "ast": {
            "$ref": "#/components/schemas/AST"
          }
        },
        "example": {
          "name": "updated name",
          "tags": [
            "tag3"
          ]
        }
      },
      "QueriesPaginatedResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/QueriesResponse"
            }
          },
          "prev_page": {
            "$ref": "#/components/schemas/PrevPage"
          },
          "current_page": {
            "$ref": "#/components/schemas/CurrentPage"
          },
          "next_page": {
            "$ref": "#/components/schemas/NextPage"
          },
          "total_records": {
            "$ref": "#/components/schemas/TotalRecords"
          },
          "total_pages": {
            "$ref": "#/components/schemas/TotalPages"
          }
        },
        "required": [
          "records"
        ],
        "example": {
          "prev_page": null,
          "current_page": 1,
          "next_page": null,
          "total_records": 1,
          "total_pages": 1,
          "records": [
            {
              "name": "query1",
              "id": "7409b999-2a9a-40cd-89dc-8430d85e0391",
              "display_name": "Query One",
              "owner": {
                "company_id": 456,
                "company_name": "ExampleCorp",
                "company_slug": "examplecorp"
              },
              "tags": [
                "tag1",
                "tag2"
              ],
              "collaborators": {
                "query": {
                  "type": "inclusion",
                  "company_ids": [
                    789
                  ]
                },
                "view": {
                  "type": "all"
                }
              },
              "is_owned": true,
              "metadata": {
                "created_at": "2024-04-12T19:57:05.012908",
                "created_by_user_id": 321,
                "updated_at": "2024-04-12T20:03:48.031825",
                "updated_by_user_id": 321
              },
              "ast": {
                "type": "select",
                "nql": "SELECT age FROM narrative.rosetta_stone",
                "budget": null,
                "columns": [
                  {
                    "type": "table",
                    "nql": "age",
                    "db": null,
                    "schema": null,
                    "table": "age"
                  }
                ],
                "from": {
                  "type": "table",
                  "nql": "narrative.rosetta_stone",
                  "db": null,
                  "schema": "narrative",
                  "table": "rosetta_stone"
                },
                "group_by": [],
                "having": null,
                "is_distinct": false,
                "limit": null,
                "order_by": [],
                "qualify": null,
                "where": null,
                "windows": [],
                "with": []
              }
            }
          ]
        }
      },
      "CreateQueryRequest": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/QueryName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/Description"
          },
          "tags": {
            "$ref": "#/components/schemas/Tags"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "ast": {
            "$ref": "#/components/schemas/AST"
          }
        },
        "required": [
          "name",
          "collaborators",
          "ast"
        ],
        "example": {
          "name": "query1",
          "display_name": "Query One",
          "tags": [
            "tag1",
            "tag2"
          ],
          "collaborators": {
            "query": {
              "type": "inclusion",
              "company_ids": [
                789
              ]
            },
            "view": {
              "type": "all"
            }
          },
          "ast": {
            "type": "select",
            "nql": "SELECT age FROM narrative.rosetta_stone",
            "budget": null,
            "columns": [
              {
                "type": "table",
                "nql": "age",
                "db": null,
                "schema": null,
                "table": "age"
              }
            ],
            "from": {
              "type": "table",
              "nql": "narrative.rosetta_stone",
              "db": null,
              "schema": "narrative",
              "table": "rosetta_stone"
            },
            "group_by": [],
            "having": null,
            "is_distinct": false,
            "limit": null,
            "order_by": [],
            "qualify": null,
            "where": null,
            "windows": [],
            "with": []
          }
        }
      },
      "ViewId": {
        "type": "string",
        "format": "uuid"
      },
      "ViewName": {
        "type": "string",
        "description": "It should be unique.\nMust be <= 256 characters and consist of only alphanumeric characters and underscores."
      },
      "shared_Owner": {
        "type": "object",
        "description": "Information about the owner of the view",
        "properties": {
          "company_id": {
            "$ref": "#/components/schemas/CompanyId"
          },
          "company_name": {
            "$ref": "#/components/schemas/CompanyName"
          },
          "company_slug": {
            "$ref": "#/components/schemas/CompanySlug"
          }
        },
        "required": [
          "company_id",
          "company_name"
        ]
      },
      "shared_IsOwned": {
        "type": "boolean",
        "description": "Whether the requestor owns the view."
      },
      "shared_Metadata": {
        "type": "object",
        "description": "Metadata about when and by whom a view was created/updated",
        "properties": {
          "created_by_user_id": {
            "$ref": "#/components/schemas/UserId"
          },
          "created_at": {
            "description": "ISO-8601 timestamp indicating when the view was created.",
            "type": "string"
          },
          "updated_by_user_id": {
            "$ref": "#/components/schemas/UserId"
          },
          "updated_at": {
            "description": "ISO-8601 timestamp indicating when the view was last updated.",
            "type": "string"
          }
        },
        "required": [
          "created_by_user_id",
          "created_at",
          "updated_by",
          "updated_at"
        ]
      },
      "Schema": {
        "type": "object",
        "description": "NQL schema for the view.",
        "additionalProperties": true
      },
      "OwnedViewResponse": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/ViewId"
          },
          "name": {
            "$ref": "#/components/schemas/ViewName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DisplayName"
          },
          "tags": {
            "$ref": "#/components/schemas/Tags"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "owner": {
            "$ref": "#/components/schemas/shared_Owner"
          },
          "is_owned": {
            "$ref": "#/components/schemas/shared_IsOwned"
          },
          "metadata": {
            "$ref": "#/components/schemas/shared_Metadata"
          },
          "nql": {
            "type": "string"
          },
          "schema": {
            "$ref": "#/components/schemas/Schema"
          }
        },
        "required": [
          "id",
          "name",
          "collaborators",
          "owner",
          "metadata",
          "nql"
        ],
        "example": {
          "name": "view1",
          "id": "7409b999-2a9a-40cd-89dc-8430d85e0391",
          "display_name": "Query One",
          "owner": {
            "company_id": 456,
            "company_name": "ExampleCorp",
            "company_slug": "examplecorp"
          },
          "tags": [
            "tag1",
            "tag2"
          ],
          "collaborators": {
            "query": {
              "type": "inclusion",
              "company_ids": [
                789
              ]
            },
            "view": {
              "type": "all"
            }
          },
          "is_owned": true,
          "metadata": {
            "created_at": "2024-04-12T19:57:05.012908",
            "created_by_user_id": 321,
            "updated_at": "2024-04-12T20:03:48.031825",
            "updated_by_user_id": 321
          },
          "nql": "SELECT age FROM narrative.rosetta_stone",
          "schema": {
            "type": "object",
            "properties": {
              "age": {
                "display_name": "age",
                "type": "double"
              }
            },
            "required": [
              "id"
            ]
          }
        }
      },
      "SharedViewResponse": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/ViewId"
          },
          "name": {
            "$ref": "#/components/schemas/ViewName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DisplayName"
          },
          "tags": {
            "$ref": "#/components/schemas/Tags"
          },
          "owner": {
            "$ref": "#/components/schemas/shared_Owner"
          },
          "is_owned": {
            "$ref": "#/components/schemas/shared_IsOwned"
          },
          "nql": {
            "type": "string"
          },
          "schema": {
            "$ref": "#/components/schemas/Schema"
          }
        },
        "required": [
          "id",
          "name",
          "owner",
          "nql"
        ],
        "example": {
          "name": "view1",
          "id": "7409b999-2a9a-40cd-89dc-8430d85e0391",
          "display_name": "View One",
          "owner": {
            "company_id": 456,
            "company_name": "ExampleCorp",
            "company_slug": "examplecorp"
          },
          "tags": [
            "tag1",
            "tag2"
          ],
          "is_owned": false,
          "nql": "SELECT age FROM narrative.rosetta_stone",
          "schema": {
            "type": "object",
            "properties": {
              "age": {
                "display_name": "age",
                "type": "double"
              }
            },
            "required": [
              "id"
            ]
          }
        }
      },
      "ViewsResponse": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/OwnedViewResponse"
          },
          {
            "$ref": "#/components/schemas/SharedViewResponse"
          }
        ]
      },
      "UpdateViewRequest": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/ViewName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DisplayName"
          },
          "tags": {
            "$ref": "#/components/schemas/Tags"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "nql": {
            "type": "string"
          }
        },
        "example": {
          "name": "updated name",
          "tags": [
            "tag3"
          ]
        }
      },
      "ViewsPaginatedResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ViewsResponse"
            }
          },
          "prev_page": {
            "$ref": "#/components/schemas/PrevPage"
          },
          "current_page": {
            "$ref": "#/components/schemas/CurrentPage"
          },
          "next_page": {
            "$ref": "#/components/schemas/NextPage"
          },
          "total_records": {
            "$ref": "#/components/schemas/TotalRecords"
          },
          "total_pages": {
            "$ref": "#/components/schemas/TotalPages"
          }
        },
        "required": [
          "records"
        ],
        "example": {
          "prev_page": null,
          "current_page": 1,
          "next_page": null,
          "total_records": 1,
          "total_pages": 1,
          "records": [
            {
              "name": "view1",
              "id": "7409b999-2a9a-40cd-89dc-8430d85e0391",
              "display_name": "View One",
              "owner": {
                "company_id": 456,
                "company_name": "ExampleCorp",
                "company_slug": "examplecorp"
              },
              "tags": [
                "tag1",
                "tag2"
              ],
              "collaborators": {
                "query": {
                  "type": "inclusion",
                  "company_ids": [
                    789
                  ]
                },
                "view": {
                  "type": "all"
                }
              },
              "is_owned": true,
              "metadata": {
                "created_at": "2024-04-12T19:57:05.012908",
                "created_by_user_id": 321,
                "updated_at": "2024-04-12T20:03:48.031825",
                "updated_by_user_id": 321
              },
              "nql": "SELECT age FROM narrative.rosetta_stone",
              "schema": {
                "type": "object",
                "properties": {
                  "age": {
                    "display_name": "age",
                    "type": "double"
                  }
                },
                "required": [
                  "id"
                ]
              }
            }
          ]
        }
      },
      "CreateViewRequest": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/ViewName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DisplayName"
          },
          "tags": {
            "$ref": "#/components/schemas/Tags"
          },
          "collaborators": {
            "$ref": "#/components/schemas/Collaborators"
          },
          "nql": {
            "type": "string"
          }
        },
        "required": [
          "name",
          "collaborators",
          "nql"
        ],
        "example": {
          "name": "view 1",
          "display_name": "View One",
          "tags": [
            "tag1",
            "tag2"
          ],
          "collaborators": {
            "query": {
              "type": "inclusion",
              "company_ids": [
                789
              ]
            },
            "view": {
              "type": "all"
            }
          },
          "nql": "SELECT age FROM narrative.rosetta_stone"
        }
      },
      "EventContext": {
        "type": "object",
        "properties": {
          "companyId": {
            "type": "string"
          },
          "connectionId": {
            "type": "string",
            "format": "uuid"
          },
          "datasetId": {
            "type": "integer",
            "format": "int64"
          },
          "profileId": {
            "type": "string",
            "format": "uuid"
          }
        },
        "required": [
          "companyId"
        ]
      },
      "EventType": {
        "type": "object",
        "properties": {
          "value": {
            "type": "string"
          }
        },
        "required": [
          "value"
        ]
      },
      "IdempotencyKey": {
        "type": "object",
        "properties": {
          "value": {
            "type": "string"
          }
        },
        "required": [
          "value"
        ]
      },
      "EventPayload": {
        "type": "object",
        "description": "Arbitrary JSON payload",
        "properties": {
          "value": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "required": [
          "value"
        ]
      },
      "WebhookAppEvent": {
        "type": "object",
        "properties": {
          "context": {
            "$ref": "#/components/schemas/EventContext"
          },
          "eventTimestamp": {
            "type": "string",
            "format": "date-time"
          },
          "eventType": {
            "$ref": "#/components/schemas/EventType"
          },
          "idempotencyKey": {
            "$ref": "#/components/schemas/IdempotencyKey"
          },
          "payload": {
            "$ref": "#/components/schemas/EventPayload"
          }
        },
        "required": [
          "context",
          "eventTimestamp",
          "eventType",
          "idempotencyKey",
          "payload"
        ]
      },
      "WebhookAppEventBulkRequest": {
        "type": "object",
        "properties": {
          "events": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookAppEvent"
            }
          }
        },
        "required": [
          "events"
        ]
      },
      "WebhookEventDetails": {
        "type": "object",
        "properties": {
          "webhookEventId": {
            "type": "string",
            "format": "uuid"
          },
          "webhookSubscriptionId": {
            "type": "string",
            "format": "uuid"
          },
          "idempotencyKey": {
            "type": "string"
          },
          "eventType": {
            "type": "string"
          },
          "companyId": {
            "type": "string"
          }
        }
      },
      "WebhookAppEventResponse": {
        "type": "object",
        "properties": {
          "enqueued": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookEventDetails"
            }
          },
          "rejected": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WebhookEventDetails"
            }
          }
        }
      },
      "ProfilesResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "type": "string",
              "description": "Unique ID of the profiles.",
              "format": "uuid"
            }
          }
        },
        "required": [
          "records"
        ]
      },
      "GetSchemaResponse": {
        "type": "object",
        "properties": {
          "version_id": {
            "type": "string",
            "description": "Unique ID of the version.",
            "format": "uuid"
          },
          "stream_id": {
            "type": "string",
            "description": "Unique ID of the schema stream. Stream is associated with some particular app.",
            "format": "uuid"
          },
          "version_number": {
            "description": "Sequential ID of the version.",
            "type": "number"
          },
          "value": {
            "type": "object",
            "description": "Persisted JSON Schema (2019-09 version).",
            "additionalProperties": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "ISO-8601 timestamp indicating when the schema version was appended."
          }
        }
      },
      "GetSchemasResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/GetSchemaResponse"
        }
      },
      "PostSchemaResponse": {
        "type": "object",
        "properties": {
          "version_id": {
            "type": "string",
            "description": "Unique ID of the version.",
            "format": "uuid"
          },
          "stream_id": {
            "type": "string",
            "description": "Unique ID of the schema stream. Stream is associated with some particular app.",
            "format": "uuid"
          },
          "version_number": {
            "description": "Sequential ID of the version.",
            "type": "number"
          },
          "value": {
            "type": "object",
            "description": "Persisted JSON Schema (2019-09 version).",
            "additionalProperties": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "ISO-8601 timestamp indicating when the schema version was appended."
          }
        }
      },
      "GetDataResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique ID of the data instance.",
            "format": "uuid"
          },
          "schema_version_id": {
            "type": "string",
            "description": "Unique ID of the schema.",
            "format": "uuid"
          },
          "value": {
            "type": "object",
            "description": "Persisted instance of the data",
            "additionalProperties": true
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "ISO-8601 timestamp indicating when the schema version was appended."
          }
        }
      },
      "DataInstance": {
        "type": "object",
        "description": "saved instance",
        "additionalProperties": true
      },
      "DataMeta": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique ID of the data instance.",
            "format": "uuid"
          },
          "schema_version_id": {
            "type": "string",
            "description": "Unique ID of the schema.",
            "format": "uuid"
          }
        }
      },
      "PutDataResponse": {
        "type": "object",
        "properties": {
          "data": {
            "$ref": "#/components/schemas/DataInstance"
          },
          "meta": {
            "$ref": "#/components/schemas/DataMeta"
          }
        }
      },
      "AttributeDescription": {
        "type": "string",
        "description": "A description of the type of data the attribute represents, including collection methodology, assumptions, etc."
      },
      "AttributeDisplayName": {
        "type": "string",
        "description": "A public-facing descriptive name for the attribute."
      },
      "AttributeName": {
        "type": "string",
        "description": "An short identifier for the attribute to be used when it is referenced in validations.\n\nAttribute names must consist of only alphanumeric characters or underscores and be < 255 characters long."
      },
      "Validations": {
        "type": "array",
        "description": "A raw Spark SQL expression determining whether a value for the given column is valid or not.\n\nIf more than one validation is specified then _all_ the validation must evaluate to `true` for the column value to be considered valid.\n\nIf `validations` is not specified or empty then all rows will match the access rule.\n\nE.g. for an attribute with the following definition:\n\n```\n{\n  \"name\": \"unique_id\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"identifier_value\": {\n      \"type\": \"string\"\n    },\n    \"identifier_type\": {\n      \"type\": \"string\"\n    },\n    \"timestamp\": {\n      \"type\": \"timestamptz\"\n    }\n  },\n  \"required\": [\n    \"value\"\n  ]\n}\n```\n\nValid validations include:\n\n- Is the ID type lowercased?\n\n```sql\n\"identifier_type\": {\n  \"type\": \"string\",\n  \"validations\": [\n    \"lower($this.identifier_type) = $this.identifier_type\"\n  ]\n}\n```\n- Was the row collected within the last 90 days?\n\n```sql\n\"timestamp\": {\n  \"type\": \"timestamptz\",\n  \"validations\": [\n    \"$this.timestamp > date_sub(current_date(), 90)\"\n  ]\n}\n```",
        "items": {
          "type": "string"
        }
      },
      "ArrayType": {
        "type": "object",
        "required": [
          "type",
          "items"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "An array with elements of any data type.",
            "enum": [
              "array"
            ]
          },
          "validations": {
            "$ref": "#/components/schemas/Validations"
          }
        }
      },
      "BooleanType": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "True/false values. Input values must be one of `true` or `false`.",
            "enum": [
              "boolean"
            ]
          },
          "validations": {
            "$ref": "#/components/schemas/Validations"
          }
        }
      },
      "DoubleType": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "64-bit IEEE 754 floating point values.",
            "enum": [
              "double"
            ]
          },
          "validations": {
            "$ref": "#/components/schemas/Validations"
          }
        }
      },
      "LongType": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "64-bit signed integer values.",
            "enum": [
              "long"
            ]
          },
          "enum": {
            "type": "array",
            "description": "An optional set of possible values for the field.",
            "items": {
              "type": "integer",
              "format": "int64"
            }
          },
          "validations": {
            "$ref": "#/components/schemas/Validations"
          }
        }
      },
      "ObjectProperty": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "description": {
                "type": "string",
                "description": "A description of the named field."
              },
              "display_name": {
                "type": "string",
                "description": "A display name of the named field."
              }
            }
          }
        ]
      },
      "ObjectType": {
        "type": "object",
        "required": [
          "type",
          "properties"
        ],
        "properties": {
          "type": {
            "description": "A record consisting of named fields of any type.",
            "enum": [
              "object"
            ]
          },
          "properties": {
            "type": "object",
            "description": "A map from field names to field types.\n\nField names must consist of only alphanumeric characters or underscores and be < 255 characters long.",
            "additionalProperties": {
              "$ref": "#/components/schemas/ObjectProperty"
            }
          },
          "required": {
            "description": "An optional array of properties whose values are never missing or null.",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "unsellable": {
            "description": "An optional array of properties that cannot be sold to buyers.",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "StringType": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Abitrary-length character sequences encoded with UTF-8.",
            "enum": [
              "string"
            ]
          },
          "enum": {
            "type": "array",
            "description": "An optional set of possible values for the field.",
            "items": {
              "type": "string"
            }
          },
          "validations": {
            "$ref": "#/components/schemas/Validations"
          }
        }
      },
      "TimestampTzType": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Timestamp with timezone, stored as microseconds. Input values are expected to be valid [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) strings.",
            "enum": [
              "timestamptz"
            ]
          },
          "validations": {
            "$ref": "#/components/schemas/Validations"
          }
        }
      },
      "AttributeTypeWithoutRef": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/ArrayType"
          },
          {
            "$ref": "#/components/schemas/BooleanType"
          },
          {
            "$ref": "#/components/schemas/DoubleType"
          },
          {
            "$ref": "#/components/schemas/LongType"
          },
          {
            "$ref": "#/components/schemas/ObjectType"
          },
          {
            "$ref": "#/components/schemas/StringType"
          },
          {
            "$ref": "#/components/schemas/TimestampTzType"
          }
        ]
      },
      "AttributeResponseWithoutExample": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer",
                "description": "Unique identifier for the attribute."
              },
              "description": {
                "$ref": "#/components/schemas/AttributeDescription"
              },
              "display_name": {
                "$ref": "#/components/schemas/AttributeDisplayName"
              },
              "name": {
                "$ref": "#/components/schemas/AttributeName"
              },
              "tags": {
                "type": "array",
                "description": "List of tags associated with the attribute",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          {
            "$ref": "#/components/schemas/AttributeTypeWithoutRef"
          }
        ]
      },
      "Participants": {
        "description": "Defines which companies can participate in viewing or mapping attributes.",
        "oneOf": [
          {
            "type": "object",
            "description": "No companies are allowed",
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "none"
                ]
              }
            },
            "required": [
              "type"
            ]
          },
          {
            "type": "object",
            "description": "Specific companies are included",
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "inclusion"
                ]
              },
              "companies": {
                "type": "array",
                "items": {
                  "type": "integer",
                  "description": "Company ID"
                }
              }
            },
            "required": [
              "type",
              "companies"
            ]
          },
          {
            "type": "object",
            "description": "All companies are allowed",
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "all"
                ]
              }
            },
            "required": [
              "type"
            ]
          }
        ]
      },
      "AttributeOwnedResponse": {
        "description": "An owned attribute response includes additional fields for attributes owned by the requesting company.",
        "allOf": [
          {
            "$ref": "#/components/schemas/AttributeResponseWithoutExample"
          },
          {
            "type": "object",
            "required": [
              "company_id",
              "collaborators"
            ],
            "properties": {
              "company_id": {
                "type": "integer",
                "description": "The ID of the company that owns this attribute"
              },
              "collaborators": {
                "type": "object",
                "description": "Defines which companies have access to view and map this attribute",
                "properties": {
                  "view": {
                    "$ref": "#/components/schemas/Participants"
                  },
                  "map": {
                    "$ref": "#/components/schemas/Participants"
                  }
                }
              }
            }
          }
        ],
        "example": {
          "id": 123456789,
          "name": "price",
          "description": "The price of an order, product, or a price component. Currency field accepts ISO 4217 currency codes",
          "display_name": "Price",
          "type": "object",
          "properties": {
            "value": {
              "type": "double",
              "validations": [
                "$this.value >= 0.0"
              ]
            },
            "iso_4217_currency": {
              "type": "string",
              "enum": [
                "USD",
                "GBP",
                "JPY"
              ]
            }
          },
          "required": [
            "value",
            "iso_4217_currency"
          ],
          "company_id": 12345,
          "collaborators": {
            "view": {
              "type": "inclusion",
              "companies": [
                12345,
                67890
              ]
            },
            "map": {
              "type": "inclusion",
              "companies": [
                12345
              ]
            }
          },
          "tags": [
            "ecommerce",
            "transaction"
          ]
        }
      },
      "AttributeSharedResponse": {
        "description": "A shared attribute response is returned when the requesting company does not own the attribute.",
        "allOf": [
          {
            "$ref": "#/components/schemas/AttributeResponseWithoutExample"
          }
        ],
        "example": {
          "id": 123456789,
          "name": "price",
          "description": "The price of an order, product, or a price component. Currency field accepts ISO 4217 currency codes",
          "display_name": "Price",
          "type": "object",
          "properties": {
            "value": {
              "type": "double",
              "validations": [
                "$this.value >= 0.0"
              ]
            },
            "iso_4217_currency": {
              "type": "string",
              "enum": [
                "USD",
                "GBP",
                "JPY"
              ]
            }
          },
          "required": [
            "value",
            "iso_4217_currency"
          ],
          "tags": [
            "ecommerce",
            "transaction"
          ]
        }
      },
      "AttributeResponse": {
        "description": "An attribute models a standardized data point available for sale on the Narrative marketplace.\n\nNarrative automatically turns data points from provider datasets into attributes so that buyers can purchase\nwell-formed, standardized data from any supplier on the marketplace.\n\nThe response will be one of two types:\n- AttributeOwnedResponse: When the requesting company owns the attribute (includes company_id and collaborators)\n- AttributeSharedResponse: When the requesting company does not own the attribute",
        "oneOf": [
          {
            "$ref": "#/components/schemas/AttributeOwnedResponse"
          },
          {
            "$ref": "#/components/schemas/AttributeSharedResponse"
          }
        ]
      },
      "AttributesResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttributeResponse"
            }
          }
        },
        "example": {
          "records": [
            {
              "id": 123456789,
              "name": "price",
              "description": "The price of an order, product, or a price component. Currency field accepts ISO 4217 currency codes",
              "display_name": "Price",
              "type": "object",
              "properties": {
                "value": {
                  "type": "double",
                  "validations": [
                    "$this.value >= 0.0"
                  ]
                },
                "iso_4217_currency": {
                  "type": "string",
                  "enum": [
                    "USD",
                    "GBP",
                    "JPY"
                  ]
                },
                "tags": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "tags": [
                "ecommerce",
                "transaction"
              ],
              "required": [
                "value",
                "iso_4217_currency"
              ]
            }
          ]
        }
      },
      "AttributeCreateRequest": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "name": {
                "$ref": "#/components/schemas/AttributeName"
              },
              "description": {
                "$ref": "#/components/schemas/AttributeDescription"
              },
              "display_name": {
                "$ref": "#/components/schemas/AttributeDisplayName"
              },
              "tags": {
                "type": "array",
                "description": "List of tags to associate with the attribute",
                "items": {
                  "type": "string"
                },
                "default": []
              },
              "collaborators": {
                "type": "object",
                "description": "Defines which companies have access to view and map this attribute. Defaults to no companies (owner only).",
                "properties": {
                  "view": {
                    "$ref": "#/components/schemas/Participants"
                  },
                  "map": {
                    "$ref": "#/components/schemas/Participants"
                  }
                },
                "default": {
                  "view": {
                    "type": "none"
                  },
                  "map": {
                    "type": "none"
                  }
                }
              }
            },
            "required": [
              "name",
              "display_name",
              "collaborators"
            ]
          },
          {
            "$ref": "#/components/schemas/AttributeTypeWithoutRef"
          }
        ],
        "example": {
          "name": "price",
          "description": "The price of an order, product, or a price component. Currency field accepts ISO 4217 currency codes",
          "display_name": "Price",
          "type": "object",
          "properties": {
            "value": {
              "type": "double",
              "validations": [
                "$this.value >= 0.0"
              ]
            },
            "iso_4217_currency": {
              "type": "string",
              "enum": [
                "USD",
                "GBP",
                "JPY"
              ]
            },
            "tags": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "required": [
            "value",
            "iso_4217_currency"
          ],
          "tags": [
            "ecommerce",
            "pricing"
          ],
          "collaborators": {
            "view": {
              "type": "all"
            },
            "map": {
              "type": "inclusion",
              "companies": [
                12345,
                67890
              ]
            }
          }
        }
      },
      "AttributeCooccurrence": {
        "type": "object",
        "properties": {
          "attribute": {
            "$ref": "#/components/schemas/AttributeResponse"
          },
          "cooccurrence_pct": {
            "type": "number",
            "description": "A number between 0 and 1 representing how often the attribute is mapped to the same datasets as the \nreturned attribute"
          }
        }
      },
      "AttributeMetadata": {
        "type": "object",
        "description": "Some metadata about the attribute being returned",
        "properties": {
          "attribute_cooccurrence": {
            "type": "array",
            "description": "Attributes that are commonly mapped to the same datasets",
            "items": {
              "$ref": "#/components/schemas/AttributeCooccurrence"
            }
          }
        }
      },
      "AttributeOwnedResponseWithMetadata": {
        "allOf": [
          {
            "$ref": "#/components/schemas/AttributeOwnedResponse"
          },
          {
            "$ref": "#/components/schemas/AttributeMetadata"
          }
        ],
        "example": {
          "id": 123456789,
          "name": "price",
          "description": "The price of an order, product, or a price component. Currency field accepts ISO 4217 currency codes",
          "display_name": "Price",
          "type": "object",
          "properties": {
            "value": {
              "type": "double",
              "validations": [
                "$this.value >= 0.0"
              ]
            },
            "iso_4217_currency": {
              "type": "string",
              "enum": [
                "USD",
                "GBP",
                "JPY"
              ]
            }
          },
          "required": [
            "value",
            "iso_4217_currency"
          ],
          "company_id": 12345,
          "collaborators": {
            "view": {
              "type": "inclusion",
              "companies": [
                12345,
                67890
              ]
            },
            "map": {
              "type": "inclusion",
              "companies": [
                12345
              ]
            }
          },
          "tags": [
            "ecommerce",
            "transaction"
          ],
          "metadata": {
            "attribute_cooccurrence": [
              {
                "attribute": {
                  "id": 2,
                  "name": "unique_id",
                  "type": "string"
                },
                "cooccurrence_pct": 0.42
              }
            ]
          }
        }
      },
      "AttributeSharedResponseWithMetadata": {
        "allOf": [
          {
            "$ref": "#/components/schemas/AttributeSharedResponse"
          },
          {
            "$ref": "#/components/schemas/AttributeMetadata"
          }
        ],
        "example": {
          "id": 123456789,
          "name": "price",
          "description": "The price of an order, product, or a price component. Currency field accepts ISO 4217 currency codes",
          "display_name": "Price",
          "type": "object",
          "properties": {
            "value": {
              "type": "double",
              "validations": [
                "$this.value >= 0.0"
              ]
            },
            "iso_4217_currency": {
              "type": "string",
              "enum": [
                "USD",
                "GBP",
                "JPY"
              ]
            }
          },
          "required": [
            "value",
            "iso_4217_currency"
          ],
          "tags": [
            "ecommerce",
            "transaction"
          ],
          "metadata": {
            "attribute_cooccurrence": [
              {
                "attribute": {
                  "id": 2,
                  "name": "unique_id",
                  "type": "string"
                },
                "cooccurrence_pct": 0.42
              }
            ]
          }
        }
      },
      "AttributeResponseWithMetadata": {
        "description": "An attribute response that includes metadata. Can be either owned or shared based on the requesting company.",
        "oneOf": [
          {
            "$ref": "#/components/schemas/AttributeOwnedResponseWithMetadata"
          },
          {
            "$ref": "#/components/schemas/AttributeSharedResponseWithMetadata"
          }
        ]
      },
      "LoginRequest": {
        "type": "object",
        "properties": {
          "stytch_session_token": {
            "type": "string",
            "description": "The Stytch session token"
          }
        },
        "required": [
          "stytch_session_token"
        ],
        "example": {
          "stytch_session_token": "1rjpyoFiYLucsV-nuoi7dZ_VOkMUkcZLw6rICEYBzAy0"
        }
      },
      "LoginResponse": {
        "type": "object",
        "properties": {
          "user": {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer"
              },
              "role": {
                "type": "string",
                "enum": [
                  "global_admin",
                  "partner_admin",
                  "partner_user"
                ]
              },
              "name": {
                "type": "string"
              },
              "company_id": {
                "type": "integer"
              },
              "company_name": {
                "type": "string"
              },
              "email": {
                "type": "string"
              }
            },
            "required": [
              "id",
              "name",
              "company_id",
              "company_name",
              "email"
            ]
          },
          "api_token": {
            "$ref": "#/components/schemas/AccessToken"
          },
          "legacy_token": {
            "type": "string"
          }
        },
        "required": [
          "user",
          "api_token",
          "legacy_token"
        ],
        "example": {
          "user": {
            "id": 10,
            "name": "First Last",
            "role": "partner_admin",
            "company_id": 100,
            "company_name": "ACME Corp"
          },
          "api_token": {
            "access_token": "OI2Sfun5GnOS9zk0irkc3w==",
            "access_token_expires_in": 1000,
            "refresh_token": "yZYCdZrvHvlnEQw9/C640Q",
            "refresh_token_expires_in": 10000
          },
          "legacy_token": "legacy-dsm-token"
        }
      },
      "B2bRegisterRequest": {
        "type": "object",
        "properties": {
          "stytch_session_token": {
            "type": "string",
            "description": "The Stytch session token"
          },
          "name": {
            "type": "string",
            "description": "The name of the user"
          }
        },
        "required": [
          "stytch_session_token",
          "company_name"
        ],
        "example": {
          "stytch_session_token": "1rjpyoFiYLucsV-nuoi7dZ_VOkMUkcZLw6rICEYBzAy0",
          "name": "First Last",
          "company_name": "ACME Corp"
        }
      },
      "RegisterResponse": {
        "type": "object",
        "properties": {
          "user_id": {
            "type": "integer"
          }
        },
        "example": {
          "user_id": 100
        }
      },
      "B2bRegistrationStatusRequest": {
        "type": "object",
        "properties": {
          "stytch_token": {
            "type": "string"
          },
          "session_duration_minutes": {
            "type": "integer",
            "description": "The duration in minutes of the Stytch session to create"
          }
        },
        "required": [
          "stytch_token"
        ],
        "example": {
          "stytch_token": "cykuz7f22h7rx5SPomBZUB359jj6GA-4NUBkuZDiduun",
          "session_duration_minutes": 5
        }
      },
      "RegistrationStatusResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "complete",
              "pending"
            ]
          },
          "email": {
            "type": "string"
          },
          "stytch_session_token": {
            "type": "string"
          },
          "stytch_session_jwt": {
            "type": "string"
          }
        },
        "required": [
          "status",
          "stytch_session_token",
          "stytch_session_jwt"
        ],
        "example": {
          "status": "complete",
          "email": "first.last@example.com",
          "stytch_session_token": "10hLht9FCo9cBp3I69uY5KjYMmy5VqmZjAVEz1CKZjsa",
          "stytch_session_jwt": "eyJhbGciOiJSUzI1NiIsImtpZCI6Imp3ay10ZXN0LTk1YjU2OGZhLTk1NWUtNGQ2OC04NDljLTM5MDA0MmEwZTlmOCIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsicHJvamVjdC10ZXN0LWQ1Y2E2MjhlLWFmMzctNDhmZC1hZTliLWIzMmUwY2Y5NmEyYyJdLCJleHAiOjE2ODUxMjkwNTAsImh0dHBzOi8vc3R5dGNoLmNvbS9zZXNzaW9uIjp7ImlkIjoic2Vzc2lvbi10ZXN0LTRlNTg4ZDQ3LTJlZjctNDZhNy1iMGQxLTQxOGJhMmZjNTljMiIsInN0YXJ0ZWRfYXQiOiIyMDIzLTA1LTI2VDE5OjE0OjU1WiIsImxhc3RfYWNjZXNzZWRfYXQiOiIyMDIzLTA1LTI2VDE5OjE5OjEwWiIsImV4cGlyZXNfYXQiOiIyMDIzLTA1LTI2VDIwOjE0OjU1WiIsImF0dHJpYnV0ZXMiOnsidXNlcl9hZ2VudCI6IiIsImlwX2FkZHJlc3MiOiIifSwiYXV0aGVudGljYXRpb25fZmFjdG9ycyI6W3sidHlwZSI6Im9hdXRoIiwiZGVsaXZlcnlfbWV0aG9kIjoib2F1dGhfZ2l0aHViIiwibGFzdF9hdXRoZW50aWNhdGVkX2F0IjoiMjAyMy0wNS0yNlQxOToxNDo1NVoiLCJnaXRodWJfb2F1dGhfZmFjdG9yIjp7ImlkIjoib2F1dGgtdXNlci10ZXN0LTdlY2M5YjUxLTU0YzUtNDg2MS04NjI2LTQyM2Q0Y2ZiYjQxMiIsInByb3ZpZGVyX3N1YmplY3QiOiIxNDIzMjkifX1dfSwiaWF0IjoxNjg1MTI4NzUwLCJpc3MiOiJzdHl0Y2guY29tL3Byb2plY3QtdGVzdC1kNWNhNjI4ZS1hZjM3LTQ4ZmQtYWU5Yi1iMzJlMGNmOTZhMmMiLCJuYmYiOjE2ODUxMjg3NTAsInN1YiI6InVzZXItdGVzdC03ZDYzYmMwNS05YzlmLTRmMTktODhhYS1iMmQwODk3ZGNiN2YifQ.OthwVlyy7Eu0g8h9K3tG2KzZBiOi3hykP-BpdTjrR4tZUXwqPyYPs8BmiaPRQOd17zyUNLxjGH4q5sfU6F0z4BXQXd3U8hWdRYRmUNVFPvLhFWva5FNP5ZYRD8XX_cjYTWV0E41Zd_W3YvFK5hCYs7cwYyR0mMw2XRzTYX1CjTfHOtNmPW-uLwhvHqAroLa2vM7PoyFlS0Xs2j0Dje01WI0eqJYgSVTwB5ZMTWttJKqXjFPaLQ-7XkJxHtmpXTxCoO-U38kDba26cyhTQrXBoHV2c8KMtrBWS3L3_kN-gw96FzcJ0C2W8HxhZJrI_GIZ4OLxFy3jxXvjDcsjMX940w"
        }
      },
      "RegisterRequest": {
        "type": "object",
        "properties": {
          "stytch_session_token": {
            "type": "string",
            "description": "The Stytch session token"
          },
          "name": {
            "type": "string",
            "description": "The name of the user"
          },
          "company_name": {
            "type": "string",
            "description": "The name of the company"
          }
        },
        "required": [
          "stytch_session_token",
          "company_name"
        ],
        "example": {
          "stytch_session_token": "1rjpyoFiYLucsV-nuoi7dZ_VOkMUkcZLw6rICEYBzAy0",
          "name": "First Last",
          "company_name": "ACME Corp"
        }
      },
      "MagicLinksToken": {
        "type": "object",
        "properties": {
          "token_type": {
            "type": "string",
            "enum": [
              "magiclinks"
            ]
          },
          "token": {
            "type": "string"
          }
        }
      },
      "OAuthToken": {
        "type": "object",
        "properties": {
          "token_type": {
            "type": "string",
            "enum": [
              "magiclinks"
            ]
          },
          "token": {
            "type": "string"
          }
        }
      },
      "StytchToken": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/MagicLinksToken"
          },
          {
            "$ref": "#/components/schemas/OAuthToken"
          }
        ],
        "description": "The Stytch Magic Links or OAuth token"
      },
      "RegistrationStatusRequest": {
        "type": "object",
        "properties": {
          "stytch_token": {
            "$ref": "#/components/schemas/StytchToken"
          },
          "session_duration_minutes": {
            "type": "integer",
            "description": "The duration in minutes of the Stytch session to create"
          }
        },
        "required": [
          "stytch_token"
        ],
        "example": {
          "stytch_token": {
            "token_type": "magiclinks",
            "token": "cykuz7f22h7rx5SPomBZUB359jj6GA-4NUBkuZDiduun"
          },
          "session_duration_minutes": 5
        }
      },
      "ConnectionStatus": {
        "type": "string",
        "enum": [
          "active",
          "archived"
        ]
      },
      "Connection": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/UUID"
          },
          "dataset_id": {
            "type": "number"
          },
          "profile_id": {
            "$ref": "#/components/schemas/UUID"
          },
          "quick_settings": {
            "type": "object"
          },
          "status": {
            "$ref": "#/components/schemas/ConnectionStatus"
          }
        },
        "example": {
          "id": "21691f26-f308-4e98-896c-579db27da04b",
          "dataset_id": 42,
          "profile_id": "d555f07f-f140-40d2-91af-e6aa54f7488b",
          "quick_settings": {
            "bucket_suffix": "/my-subscription",
            "number_of_files": "5"
          },
          "status": "active"
        }
      },
      "PaginatedConnections": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Connection"
            }
          }
        }
      },
      "CreateConnection": {
        "type": "object",
        "properties": {
          "dataset_id": {
            "type": "number"
          },
          "profile_id": {
            "$ref": "#/components/schemas/UUID"
          },
          "quick_settings": {
            "type": "object"
          }
        },
        "example": {
          "dataset_id": 42,
          "profile_id": "d555f07f-f140-40d2-91af-e6aa54f7488b",
          "quick_settings": {
            "bucket_suffix": "/my-subscription",
            "number_of_files": "5"
          }
        }
      },
      "DatasetId": {
        "type": "integer",
        "description": "Unique identifier for the dataset."
      },
      "DatasetName": {
        "type": "string",
        "description": "The Dataset's name. Should be unique, contain only alpanum chars and underscores. Max length is 256."
      },
      "DatasetDisplayName": {
        "type": "string",
        "description": "The Dataset's name to display at UI."
      },
      "DatasetDescription": {
        "type": "string",
        "description": "A description of the data contained with the dataset."
      },
      "ExpireEverything": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "expire_everything"
            ]
          }
        },
        "example": {
          "type": "expire_everything"
        }
      },
      "RetainEverything": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "retain_everything"
            ]
          }
        },
        "example": {
          "type": "retain_everything"
        }
      },
      "SnapshotAge": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "snapshot_age"
            ]
          },
          "operator": {
            "type": "string",
            "enum": [
              ">",
              "<",
              ">=",
              "<="
            ]
          },
          "period": {
            "type": "string",
            "description": "An ISO 8601 period format"
          }
        },
        "example": {
          "type": "snapshot_age",
          "operator": ">",
          "period": "P30D"
        }
      },
      "ExpireWhen": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "expire_when"
            ]
          },
          "expression": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/SnapshotAge"
              }
            ]
          }
        }
      },
      "RetainWhen": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "retain_when"
            ]
          },
          "expression": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/SnapshotAge"
              }
            ]
          }
        }
      },
      "SnapshotRetentionPolicy": {
        "type": "object",
        "additionalProperties": false,
        "description": "Backwards-compatible legacy payloads. Interpreted as snapshot-level retention on Iceberg. Returned response will be unified v1 shape with compat.mode=legacy.\n",
        "oneOf": [
          {
            "$ref": "#/components/schemas/ExpireEverything"
          },
          {
            "$ref": "#/components/schemas/RetainEverything"
          },
          {
            "$ref": "#/components/schemas/ExpireWhen"
          },
          {
            "$ref": "#/components/schemas/RetainWhen"
          }
        ]
      },
      "FlatFileConfig": {
        "type": "object",
        "required": [
          "type",
          "header",
          "delimiter",
          "quote",
          "escape"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Describes input files where each row is a set of fields separated by some delimiter. Common examples include comma-separated (CSV) and tab-separated (TSV) files. Files can be compressed using gzip or bzip2 as long as they include the appropriate suffix to indicate what kind of compression has been applied. E.g. bzip2 files must end in \".bz2\" and gzipped files must end in \".gz\".",
            "enum": [
              "flat"
            ]
          },
          "header": {
            "type": "boolean",
            "description": "Whether or not files include a header."
          },
          "delimiter": {
            "type": "string",
            "description": "Character separating values within a row in a file."
          },
          "quote": {
            "type": "string",
            "description": "Character used for escaping quoted values where the separator can be part of the value."
          },
          "escape": {
            "type": "string",
            "description": "Character used for escaping quotes inside an already quoted value."
          }
        }
      },
      "JsonFileConfig": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Describes input files in the [JSON Lines](https://jsonlines.org/) file format.",
            "enum": [
              "json"
            ]
          }
        }
      },
      "ParquetFileConfig": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Describes input files in the [Parquet](https://parquet.apache.org/) file format.",
            "enum": [
              "parquet"
            ]
          }
        }
      },
      "FileConfig": {
        "description": "Defines the input file format. Files provided to Narrative for ingestion into a Dataset must match the file configuration.",
        "oneOf": [
          {
            "$ref": "#/components/schemas/FlatFileConfig"
          },
          {
            "$ref": "#/components/schemas/JsonFileConfig"
          },
          {
            "$ref": "#/components/schemas/ParquetFileConfig"
          }
        ]
      },
      "PrimaryField": {
        "description": "An optional RFC-6901 JSON pointer to a Dataset field to indicate that the field is \"primary\" -- i.e. it is of particular interest to buyers. Narrative uses this information to optimize buyer experience when purchasing your Dataset.\nThe primary key, if specified, must refer to a _required_ field that has a type of `boolean`, `long`, `string`, or `timestamptz`.",
        "type": "string"
      },
      "Dataset_ObjectType": {
        "type": "object",
        "required": [
          "type",
          "properties"
        ],
        "properties": {
          "type": {
            "description": "A record consisting of named fields of any type.",
            "enum": [
              "object"
            ]
          },
          "properties": {
            "type": "object",
            "description": "A map from field names to field types.\n\nField names must consist of only alphanumeric characters or underscores and be < 255 characters long."
          },
          "required": {
            "description": "An optional array of properties whose values are never missing or null.",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "unsellable": {
            "description": "An optional array of properties that cannot be sold to buyers.",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "sensitive": {
            "description": "An optional array of properties that are sensitive. Data in sensitive fields are redacted when showed to Narrative users via the UI or API but can still be bought and sold.",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "DatasetSchema": {
        "description": "Schema describing a dataset's input file type and the kind of data the file contains.\nNote: when the file type is \"flat\" then the order of the properties describing the must be given in the order they appear in the input file.\n",
        "allOf": [
          {
            "type": "object",
            "required": [
              "file_config"
            ],
            "properties": {
              "file_config": {
                "$ref": "#/components/schemas/FileConfig"
              },
              "primary": {
                "$ref": "#/components/schemas/PrimaryField"
              }
            }
          },
          {
            "$ref": "#/components/schemas/Dataset_ObjectType"
          }
        ]
      },
      "DatasetStatus": {
        "description": "The dataset status.\n\n- `active` means that data can be added to the dataset but the schema is locked in place\n- `pending` means the dataset has been created, but the schema can still be altered and no data can be added to the dataset",
        "type": "string",
        "enum": [
          "active",
          "pending"
        ]
      },
      "DatasetTags": {
        "description": "Tags that describe the dataset.",
        "type": "array",
        "items": {
          "type": "string"
        }
      },
      "DatasetWriteMode": {
        "description": "How Narrative will treat new data uploaded for the dataset.\n- `append` means data will be added to the dataset, this is what to choose if you incrementally update your dataset over time.\n- `overwrite` means that all existing data will be overwritten with new data.",
        "type": "string",
        "enum": [
          "append",
          "overwrite"
        ]
      },
      "EstTotalDatasetStoredFiles": {
        "description": "The total estimated number of files across this dataset snapshot and all unexpired snapshots that precede it.",
        "type": "integer"
      },
      "EstTotalDatasetStoredRecords": {
        "description": "The total estimated number of records across this dataset snapshot and all unexpired snapshots that precede it.",
        "type": "integer"
      },
      "EstTotalDatasetStoredBytes": {
        "description": "The total estimated storage size in bytes used by this dataset snapshot and all unexpired snapshots that precede it.",
        "type": "integer"
      },
      "ActiveDatasetStoredFiles": {
        "description": "The number of files in this dataset snapshot.",
        "type": "integer"
      },
      "ActiveDatasetStoredRecords": {
        "description": "The number of records in this dataset snapshot.",
        "type": "integer"
      },
      "ActiveDatasetStoredBytes": {
        "description": "The total storage size in bytes used by this dataset snapshot.",
        "type": "integer"
      },
      "SnapshotAddedFiles": {
        "description": "The number of files added when generating this snapshot.",
        "type": "integer"
      },
      "SnapshotAddedRecords": {
        "description": "The number of records added when generating this snapshot.",
        "type": "integer"
      },
      "SnapshotDeletedRecords": {
        "description": "The number of records deleted when generating this snapshot.",
        "type": "integer"
      },
      "SnapshotAddedBytes": {
        "description": "The amount of storage in bytes added when generating this snapshot.",
        "type": "integer"
      },
      "SnapshotDeletedFiles": {
        "description": "The number of files deleted when generating this snapshot.",
        "type": "integer"
      },
      "SnapshotAddedDeleteFiles": {
        "description": "The number of delete tracking files added when generating this snapshot.",
        "type": "integer"
      },
      "SnapshotRemovedDeleteFiles": {
        "description": "The number of delete tracking files removed when generating this snapshot.",
        "type": "integer"
      },
      "SnapshotRemovedBytes": {
        "description": "The amount of storage in bytes removed when generating this snapshot.",
        "type": "integer"
      },
      "DatasetResponseStats": {
        "type": "object",
        "required": [
          "est_total_dataset_stored_files",
          "est_total_dataset_stored_records",
          "est_total_dataset_stored_bytes",
          "active_dataset_stored_files",
          "active_dataset_stored_records",
          "active_dataset_stored_bytes",
          "snapshot_added_files",
          "snapshot_added_records",
          "snapshot_deleted_records",
          "snapshot_added_bytes",
          "snapshot_deleted_files",
          "snapshot_added_delete_files",
          "snapshot_removed_delete_files",
          "snapshot_removed_bytes"
        ],
        "properties": {
          "est_total_dataset_stored_files": {
            "$ref": "#/components/schemas/EstTotalDatasetStoredFiles"
          },
          "est_total_dataset_stored_records": {
            "$ref": "#/components/schemas/EstTotalDatasetStoredRecords"
          },
          "est_total_dataset_stored_bytes": {
            "$ref": "#/components/schemas/EstTotalDatasetStoredBytes"
          },
          "active_dataset_stored_files": {
            "$ref": "#/components/schemas/ActiveDatasetStoredFiles"
          },
          "active_dataset_stored_records": {
            "$ref": "#/components/schemas/ActiveDatasetStoredRecords"
          },
          "active_dataset_stored_bytes": {
            "$ref": "#/components/schemas/ActiveDatasetStoredBytes"
          },
          "snapshot_added_files": {
            "$ref": "#/components/schemas/SnapshotAddedFiles"
          },
          "snapshot_added_records": {
            "$ref": "#/components/schemas/SnapshotAddedRecords"
          },
          "snapshot_deleted_records": {
            "$ref": "#/components/schemas/SnapshotDeletedRecords"
          },
          "snapshot_added_bytes": {
            "$ref": "#/components/schemas/SnapshotAddedBytes"
          },
          "snapshot_deleted_files": {
            "$ref": "#/components/schemas/SnapshotDeletedFiles"
          },
          "snapshot_added_delete_files": {
            "$ref": "#/components/schemas/SnapshotAddedDeleteFiles"
          },
          "snapshot_removed_delete_files": {
            "$ref": "#/components/schemas/SnapshotRemovedDeleteFiles"
          },
          "snapshot_removed_bytes": {
            "$ref": "#/components/schemas/SnapshotRemovedBytes"
          }
        }
      },
      "DatasetResponse": {
        "type": "object",
        "required": [
          "id",
          "company_id",
          "created_at",
          "name",
          "display_name",
          "retention_policy",
          "schema",
          "status",
          "tags",
          "write_mode",
          "updated_at"
        ],
        "properties": {
          "id": {
            "$ref": "#/components/schemas/DatasetId"
          },
          "company_id": {
            "description": "The ID of the company owning the dataset.",
            "type": "integer"
          },
          "created_at": {
            "description": "ISO-8601 timestamp indicating when the dataset was created",
            "type": "string"
          },
          "name": {
            "$ref": "#/components/schemas/DatasetName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DatasetDisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/DatasetDescription"
          },
          "retention_policy": {
            "$ref": "#/components/schemas/SnapshotRetentionPolicy"
          },
          "schema": {
            "$ref": "#/components/schemas/DatasetSchema"
          },
          "status": {
            "$ref": "#/components/schemas/DatasetStatus"
          },
          "tags": {
            "$ref": "#/components/schemas/DatasetTags"
          },
          "write_mode": {
            "$ref": "#/components/schemas/DatasetWriteMode"
          },
          "subscription_id": {
            "description": "Id of a subscription which writes output to the dataset",
            "type": "string"
          },
          "updated_at": {
            "description": "ISO-8601 timestamp indicating when the dataset was last updated.",
            "type": "string"
          },
          "last_snapshot_created_at": {
            "description": "ISO-8601 timestamp indicating when the last snapshot was created.",
            "type": "string"
          },
          "stats": {
            "$ref": "#/components/schemas/DatasetResponseStats"
          }
        },
        "example": {
          "id": 18923,
          "company_id": 382,
          "created_at": "2021-06-24T00:54:40.029056Z",
          "description": "Mobile identifiers tied to birth information provided as part of app registration.",
          "name": "declared_age",
          "display_name": "Declared Age",
          "schema": {
            "file_config": {
              "type": "flat",
              "delimiter": ",",
              "escape": "\"",
              "header": true,
              "quote": "\""
            },
            "type": "object",
            "properties": {
              "idValue": {
                "display_name": "id value",
                "order": 0,
                "approximate_cardinality": 100000,
                "description": "ID values",
                "type": "string"
              },
              "idType": {
                "display_name": "id type",
                "order": 1,
                "approximate_cardinality": 1,
                "type": "string",
                "enum": [
                  "md5_email",
                  "sha256_email"
                ]
              },
              "eventTimestamp": {
                "display_name": "event timestamp",
                "order": 2,
                "description": "When the observation was collected",
                "type": "timestamptz",
                "validations": [
                  "eventTimestamp < current_timestamp()"
                ]
              },
              "countryCode": {
                "display_name": "country code",
                "order": 3,
                "approximate_cardinality": 6,
                "description": "The country of residence of the individual",
                "type": "string"
              },
              "age": {
                "display_name": "age",
                "order": 4,
                "approximate_cardinality": 90,
                "description": "How old this individual is in years",
                "type": "long"
              },
              "birthInfo": {
                "display_name": "birth info",
                "order": 5,
                "description": "The year this individual was born",
                "type": "double"
              }
            },
            "required": [
              "idValue",
              "idType",
              "eventTimestamp",
              "countryCode",
              "age"
            ],
            "primary": "/age"
          },
          "status": "active",
          "tags": [
            "age",
            "demo",
            "demographic",
            "demographics"
          ],
          "updated_at": "2021-06-24T00:54:40.029056Z",
          "write_mode": "append",
          "subscription_id": "123e4567-e89b-12d3-a456-426614174000",
          "last_snapshot_created_at": "2023-06-09T16:51:34.215Z",
          "stats": {
            "est_total_dataset_stored_files": 10,
            "est_total_dataset_stored_records": 500059,
            "est_total_dataset_stored_bytes": 4206454,
            "active_dataset_stored_files": 10,
            "active_dataset_stored_records": 500059,
            "active_dataset_stored_bytes": 4206454,
            "last_snapshot_added_files": 2,
            "last_snapshot_added_records": 499999,
            "last_snapshot_deleted_records": 0,
            "last_snapshot_added_bytes": 4193500,
            "last_snapshot_deleted_files": 0,
            "last_snapshot_added_delete_files": 0,
            "last_snapshot_removed_delete_files": 0,
            "last_snapshot_removed_bytes": 0
          }
        }
      },
      "DatasetsResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DatasetResponse"
            }
          }
        },
        "example": {
          "records": [
            {
              "id": 18923,
              "company_id": 382,
              "created_at": "2021-06-24T00:54:40.029056Z",
              "description": "Mobile identifiers tied to birth information provided as part of app registration.",
              "name": "Declared Age",
              "retention_policy": {
                "type": "retain_everything"
              },
              "schema": {
                "file_config": {
                  "type": "flat",
                  "delimiter": ",",
                  "escape": "\"",
                  "header": true,
                  "quote": "\""
                },
                "type": "object",
                "properties": {
                  "idValue": {
                    "display_name": "Id Value",
                    "order": 0,
                    "approximate_cardinality": 100000,
                    "description": "ID values",
                    "type": "string"
                  },
                  "idType": {
                    "display_name": "Id Type",
                    "order": 1,
                    "approximate_cardinality": 1,
                    "type": "string",
                    "enum": [
                      "md5_email",
                      "sha256_email"
                    ]
                  },
                  "eventTimestamp": {
                    "display_name": "Event TS",
                    "order": 2,
                    "description": "When the observation was collected",
                    "type": "timestamptz",
                    "validations": [
                      "eventTimestamp < current_timestamp()"
                    ]
                  },
                  "countryCode": {
                    "display_name": "countryCode",
                    "order": 3,
                    "approximate_cardinality": 6,
                    "description": "The country of residence of the individual",
                    "type": "string"
                  },
                  "age": {
                    "display_name": "Age",
                    "order": 4,
                    "approximate_cardinality": 90,
                    "description": "How old this individual is in years",
                    "type": "long"
                  },
                  "birthInfo": {
                    "display_name": "birth info",
                    "order": 5,
                    "description": "The year this individual was born",
                    "type": "double"
                  }
                },
                "required": [
                  "idValue",
                  "idType",
                  "eventTimestamp",
                  "countryCode",
                  "age"
                ],
                "primary": "/age"
              },
              "status": "active",
              "tags": [
                "age",
                "demo",
                "demographic",
                "demographics"
              ],
              "updated_at": "2021-06-24T00:54:40.029056Z",
              "write_mode": "append",
              "subscription_id": "123e4567-e89b-12d3-a456-426614174000"
            }
          ]
        }
      },
      "DeriveMetricsConfig": {
        "type": "boolean",
        "description": "A flag to enable derivation of the config."
      },
      "DatasetCreateRequest": {
        "type": "object",
        "required": [
          "name",
          "schema"
        ],
        "properties": {
          "name": {
            "$ref": "#/components/schemas/DatasetName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DatasetDisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/DatasetDescription"
          },
          "data_plane_id": {
            "type": "string",
            "format": "uuid",
            "description": "Optional data plane identifier, must be provided when registering dataset in external dataplane."
          },
          "external_id": {
            "type": "string",
            "description": "Optional external identifier, must be excluded when registering dataset in external dataplane"
          },
          "is_narrative_managed": {
            "type": "boolean",
            "description": "Whether the dataset is managed by Narrative"
          },
          "schema": {
            "$ref": "#/components/schemas/DatasetSchema"
          },
          "tags": {
            "$ref": "#/components/schemas/DatasetTags"
          },
          "write_mode": {
            "$ref": "#/components/schemas/DatasetWriteMode"
          },
          "derive_metrics_config": {
            "$ref": "#/components/schemas/DeriveMetricsConfig"
          }
        },
        "example": {
          "name": "sample_data",
          "display_name": "sample data",
          "description": "sample description",
          "data_plane_id": "123e4567-e89b-12d3-a456-426614174000",
          "external_id": "ext-dataset-001",
          "is_narrative_managed": false,
          "schema": {
            "file_config": {
              "type": "flat",
              "delimiter": ",",
              "escape": "\"",
              "header": true,
              "quote": "\""
            },
            "type": "object",
            "properties": {
              "idValue": {
                "approximate_cardinality": 100000,
                "description": "ID values",
                "type": "string"
              },
              "idType": {
                "approximate_cardinality": 1,
                "type": "string",
                "enum": [
                  "md5_email",
                  "sha256_email"
                ]
              },
              "eventTimestamp": {
                "description": "When the observation was collected",
                "type": "timestamptz",
                "validations": [
                  "eventTimestamp < current_timestamp()"
                ]
              },
              "countryCode": {
                "approximate_cardinality": 6,
                "description": "The country of residence of the individual",
                "type": "string"
              },
              "age": {
                "approximate_cardinality": 90,
                "description": "How old this individual is in years",
                "type": "long"
              },
              "birthInfo": {
                "description": "The year this individual was born",
                "type": "double"
              }
            },
            "required": [
              "idValue",
              "idType",
              "eventTimestamp",
              "countryCode",
              "age"
            ],
            "primary": "/age"
          },
          "tags": [
            "age",
            "demo",
            "demographic",
            "demographics"
          ],
          "write_mode": "append",
          "derive_metrics_config": true
        }
      },
      "DatasetUpdateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/DatasetName"
          },
          "display_name": {
            "$ref": "#/components/schemas/DatasetDisplayName"
          },
          "description": {
            "$ref": "#/components/schemas/DatasetDescription"
          },
          "schema": {
            "$ref": "#/components/schemas/DatasetSchema"
          },
          "tags": {
            "$ref": "#/components/schemas/DatasetTags"
          },
          "write_mode": {
            "$ref": "#/components/schemas/DatasetWriteMode"
          }
        },
        "example": {
          "description": "Mobile identifiers tied to birth information provided as part of app registration.",
          "name": "declared_age",
          "display_name": "Declared Age",
          "schema": {
            "file_config": {
              "type": "flat",
              "delimiter": ",",
              "escape": "\"",
              "header": true,
              "quote": "\""
            },
            "type": "object",
            "properties": {
              "idValue": {
                "approximate_cardinality": 100000,
                "description": "ID values",
                "type": "string"
              },
              "idType": {
                "approximate_cardinality": 1,
                "type": "string",
                "enum": [
                  "md5_email",
                  "sha256_email"
                ]
              },
              "eventTimestamp": {
                "description": "When the observation was collected",
                "type": "timestamptz",
                "validations": [
                  "eventTimestamp < current_timestamp()"
                ]
              },
              "countryCode": {
                "approximate_cardinality": 6,
                "description": "The country of residence of the individual",
                "type": "string"
              },
              "age": {
                "approximate_cardinality": 90,
                "description": "How old this individual is in years",
                "type": "long"
              },
              "birthInfo": {
                "description": "The year this individual was born",
                "type": "double"
              }
            },
            "required": [
              "idValue",
              "idType",
              "eventTimestamp",
              "countryCode",
              "age"
            ],
            "primary": "/age"
          },
          "tags": [
            "age",
            "demo",
            "demographic",
            "demographics"
          ]
        }
      },
      "DataStream_Error": {
        "type": "object",
        "properties": {
          "error": {
            "description": "error code of the error",
            "type": "string"
          },
          "error_description": {
            "description": "human friendly error text",
            "type": "string"
          }
        },
        "required": [
          "error",
          "error_description"
        ]
      },
      "DatasetAdminResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DatasetResponse"
          },
          {
            "type": "object",
            "properties": {
              "table": {
                "type": "object",
                "description": "Metadata of Iceberg table backing the given Dataset encoded in spec-compliant JSON.\n\nSee:\n  - [Table Metadata](http://iceberg.apache.org/spec/#table-metadata)\n  - [Appendix C: JSON Serialization](http://iceberg.apache.org/spec/#appendix-c-json-serialization)"
              }
            }
          }
        ]
      },
      "PartitionSpecAddField": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "description": "Discriminator indicating that the field is being added to the partition spec.",
            "enum": [
              "add"
            ]
          },
          "field": {
            "type": "string",
            "description": "A string indicating which field in the schema is being used a source for the partition value.\n\nThe field reference must be a _primitive_ type.\n\nE.g. given a dataset with the following Iceberg table schema:\n\n```\n{\n  \"type\": \"struct\",\n  \"schema-id\": 0,\n  \"fields\": [\n    {\n      \"id\": 1,\n      \"name\": \"id\",\n      \"required\": true,\n      \"type\": {\n        \"type\": \"struct\",\n        \"fields\": [\n          {\n            \"id\": 3,\n            \"name\": \"value\",\n            \"required\": true,\n            \"type\": \"string\"\n          },\n          {\n            \"id\": 4,\n            \"name\": \"type\",\n            \"required\": false,\n            \"type\": \"string\"\n          }\n        ]\n      }\n    },\n    {\n      \"id\": 2,\n      \"name\": \"__NARRATIVE_DEFAULT_PARTITION__\",\n      \"required\": true,\n      \"type\": \"string\"\n    }\n  ]\n}\n```\n\nThe possible paths are:\n\n  - `__NARRATIVE_DEFAULT_PARTITION__`\n  - `id.value`\n  - `id.type`"
          },
          "transform": {
            "type": "string",
            "description": "A function applied to the source field to produce a partition value.\n\nSee: http://iceberg.apache.org/spec/#partition-transforms\n\nSupported transforms are:\n\n- `bucket`: bucket transforms must be provided in the form `bucket[N]` where `N` is a positive integer indicating the number of buckets.\n- `truncate`: truncation transforms must be provided in the form `truncate[W]` where `W` a positive integer indicating the truncation width.\n- `identity`\n- `hour`\n- `day`\n- `month`\n- `year`"
          }
        }
      },
      "PartitionSpecRemoveField": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "description": "Discriminator indicating that the field is being removed from the partition spec."
          },
          "field": {
            "type": "string",
            "description": "The _partition spec_ field to be removed.\n\nE.g. given the following partition spec:\n\n```\n{\n    \"spec-id\": 1,\n    \"fields\": [\n      {\n        \"name\": \"__NARRATIVE_DEFAULT_PARTITION___bucket\",\n        \"transform\": \"bucket[256]\",\n        \"source-id\": 2,\n        \"field-id\": 1000\n      },\n      {\n        \"name\": \"id.value_bucket_128\",\n        \"transform\": \"bucket[128]\",\n        \"source-id\": 3,\n        \"field-id\": 1001\n      }\n    ]\n  }\n```\n\nThe following are valid values for `field:\n\n- `__NARRATIVE_DEFAULT_PARTITION___bucket`: passing this as `field` will remove the `bucket[256]` partition derived from the `__NARRATIVE_DEFAULT_PARTITION__` schema field.\n- `id.value_bucket_128`: passing this as `field` will remove the `bucket[128]` partition derived from the `id.value` schema field."
          }
        }
      },
      "PartitionSpecUpdate": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/PartitionSpecAddField"
          },
          {
            "$ref": "#/components/schemas/PartitionSpecRemoveField"
          }
        ]
      },
      "UpdatePartitionSpecRequest": {
        "type": "object",
        "required": [
          "updates"
        ],
        "properties": {
          "updates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PartitionSpecUpdate"
            }
          }
        },
        "example": {
          "updates": [
            {
              "type": "add",
              "field": "id.value",
              "transform": "bucket[128]"
            },
            {
              "type": "remove",
              "field": "__NARRATIVE_DEFAULT_PARTITION___bucket"
            }
          ]
        }
      },
      "SnapshotExpirationsResponse": {
        "type": "object",
        "properties": {
          "snapshots_to_expire": {
            "type": "array",
            "description": "A list of the existing snapshots for the dataset",
            "items": {
              "type": "object",
              "properties": {
                "snapshot_id": {
                  "type": "number",
                  "description": "The id of the snapshot"
                },
                "created_at": {
                  "type": "string",
                  "description": "ISO-8601 timestamp indicating when the snapshot was created"
                }
              }
            }
          }
        },
        "example": {
          "snapshots_to_expire": [
            {
              "snapshot_id": 8840810861846963000,
              "created_at": "2022-01-28T16:25:47.987Z"
            },
            {
              "snapshot_id": 6511121635994506000,
              "created_at": "2022-01-28T16:58:59.264Z"
            },
            {
              "snapshot_id": 4359653450296158700,
              "created_at": "2022-01-28T17:33:25.560Z"
            },
            {
              "snapshot_id": 7422070807769186000,
              "created_at": "2022-01-28T18:58:45.856Z"
            }
          ]
        }
      },
      "RowClock": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "kind": {
            "type": "string",
            "enum": [
              "event_time"
            ]
          },
          "attribute": {
            "type": "string",
            "description": "Rosetta Stone attribute name for timestamp evaluation."
          }
        },
        "required": [
          "kind"
        ]
      },
      "RowTTLPolicy": {
        "type": "object",
        "additionalProperties": false,
        "description": "Row-level deletion policy. Action is always HARD_DELETE. Clock must be EVENT_TIME. If `clock` is omitted, server uses configured Rosetta Stone attribute (defaults to nio_last_modified); if mapping doesn't exist, returns HTTP 400.\n",
        "properties": {
          "type": {
            "const": "row_ttl"
          },
          "clock": {
            "$ref": "#/components/schemas/RowClock"
          }
        },
        "required": [
          "type",
          "enabled"
        ]
      },
      "TableClock": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "kind": {
            "type": "string",
            "enum": [
              "created_at",
              "max_event_time",
              "static_time"
            ]
          },
          "column": {
            "type": "string",
            "description": "Required when kind={max_event_time, static_time}."
          }
        },
        "required": [
          "kind"
        ]
      },
      "TableTTLPolicy": {
        "type": "object",
        "additionalProperties": false,
        "description": "Drop the dataset object when the table age exceeds the interval. Action is always DROP_TABLE.\n",
        "properties": {
          "type": {
            "const": "table_ttl"
          },
          "clock": {
            "$ref": "#/components/schemas/TableClock"
          }
        },
        "required": [
          "type",
          "enabled"
        ]
      },
      "SnapshotTTLPolicy": {
        "type": "object",
        "additionalProperties": false,
        "description": "Iceberg only: delete snapshots older than the interval.\n",
        "properties": {
          "type": {
            "const": "snapshot_ttl"
          },
          "snapshot_retention_policy": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/ExpireEverything"
              },
              {
                "$ref": "#/components/schemas/RetainEverything"
              },
              {
                "$ref": "#/components/schemas/ExpireWhen"
              },
              {
                "$ref": "#/components/schemas/RetainWhen"
              }
            ]
          }
        },
        "required": [
          "type",
          "enabled"
        ]
      },
      "RetentionPolicy": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "type": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/RowTTLPolicy"
              },
              {
                "$ref": "#/components/schemas/TableTTLPolicy"
              },
              {
                "$ref": "#/components/schemas/SnapshotTTLPolicy"
              }
            ]
          },
          "enabled": {
            "type": "boolean",
            "default": false
          },
          "interval": {
            "type": "string",
            "description": "ISO-8601 duration, e.g., P30D, PT12H."
          }
        }
      },
      "RefreshSchedule": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "schedule": {
            "type": "string",
            "description": "cron expression"
          },
          "schedule_zone_id": {
            "type": "string",
            "default": "UTC",
            "description": "Timezone for schedule execution"
          },
          "status": {
            "enum": [
              "active",
              "pending",
              "archived"
            ],
            "description": "The status"
          }
        }
      },
      "UnifiedV1Request": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "policies": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/RetentionPolicy"
            }
          },
          "schedule_config": {
            "$ref": "#/components/schemas/RefreshSchedule"
          }
        },
        "required": [
          "policies"
        ],
        "example": {
          "policies": [
            {
              "type": {
                "kind": "table_ttl",
                "clock": {
                  "kind": "created_at"
                }
              },
              "enabled": true,
              "interval": "P1D"
            }
          ],
          "schedule_config": {
            "schedule": "@hourly",
            "schedule_zone_id": "UTC",
            "status": "active"
          }
        }
      },
      "RequestSampleResponse": {
        "type": "object",
        "required": [
          "job_id"
        ],
        "properties": {
          "job_id": {
            "description": "The id of the job that has been enqueued.",
            "type": "string",
            "format": "uuid"
          }
        },
        "example": {
          "job_id": "a81e1460-fbdc-4204-bd76-a9e496bf760d"
        }
      },
      "SuggestMappingsResponse": {
        "type": "object",
        "properties": {
          "job_id": {
            "description": "the id of the job that has been triggered.",
            "type": "string",
            "format": "uuid"
          }
        },
        "example": {
          "job_id": "a81e1460-fbdc-4204-bd76-a9e496bf760d"
        }
      },
      "DatasetSummaryResponse": {
        "type": "object",
        "required": [
          "snapshot_id",
          "est_total_dataset_stored_files",
          "est_total_dataset_stored_records",
          "est_total_dataset_stored_bytes",
          "active_dataset_stored_files",
          "active_dataset_stored_records",
          "active_dataset_stored_bytes",
          "snapshot_added_files",
          "snapshot_added_records",
          "snapshot_deleted_records",
          "snapshot_added_bytes",
          "snapshot_deleted_files",
          "snapshot_added_delete_files",
          "snapshot_removed_delete_files",
          "snapshot_removed_bytes"
        ],
        "properties": {
          "snapshot_id": {
            "description": "The ID of a snapshot of the dataset. A new snapshot is generated whenever data is uploaded to the dataset. The most recent snapshot represents the state of the dataset that is used in data shops transactions.",
            "type": "integer"
          },
          "est_total_dataset_stored_files": {
            "$ref": "#/components/schemas/EstTotalDatasetStoredFiles"
          },
          "est_total_dataset_stored_records": {
            "$ref": "#/components/schemas/EstTotalDatasetStoredRecords"
          },
          "est_total_dataset_stored_bytes": {
            "$ref": "#/components/schemas/EstTotalDatasetStoredBytes"
          },
          "active_dataset_stored_files": {
            "$ref": "#/components/schemas/ActiveDatasetStoredFiles"
          },
          "active_dataset_stored_records": {
            "$ref": "#/components/schemas/ActiveDatasetStoredRecords"
          },
          "active_dataset_stored_bytes": {
            "$ref": "#/components/schemas/ActiveDatasetStoredBytes"
          },
          "snapshot_added_files": {
            "$ref": "#/components/schemas/SnapshotAddedFiles"
          },
          "snapshot_added_records": {
            "$ref": "#/components/schemas/SnapshotAddedRecords"
          },
          "snapshot_deleted_records": {
            "$ref": "#/components/schemas/SnapshotDeletedRecords"
          },
          "snapshot_added_bytes": {
            "$ref": "#/components/schemas/SnapshotAddedBytes"
          },
          "snapshot_deleted_files": {
            "$ref": "#/components/schemas/SnapshotDeletedFiles"
          },
          "snapshot_added_delete_files": {
            "$ref": "#/components/schemas/SnapshotAddedDeleteFiles"
          },
          "snapshot_removed_delete_files": {
            "$ref": "#/components/schemas/SnapshotRemovedDeleteFiles"
          },
          "snapshot_removed_bytes": {
            "$ref": "#/components/schemas/SnapshotRemovedBytes"
          }
        },
        "example": {
          "snapshot_id": 1111111111111111200,
          "est_total_dataset_stored_files": 999,
          "est_total_dataset_stored_records": 9999,
          "est_total_dataset_stored_bytes": 999999,
          "active_dataset_stored_files": 999,
          "active_dataset_stored_records": 9999,
          "active_dataset_stored_bytes": 999999,
          "snapshot_added_files": 9,
          "snapshot_added_records": 999,
          "snapshot_deleted_records": 9,
          "snapshot_added_bytes": 9999,
          "snapshot_deleted_files": 9,
          "snapshot_added_delete_files": 9,
          "snapshot_removed_delete_files": 9,
          "snapshot_removed_bytes": 9
        }
      },
      "DatasetSummariesResponse": {
        "type": "object",
        "required": [
          "dataset_id",
          "records"
        ],
        "properties": {
          "dataset_id": {
            "description": "A valid existing active dataset id",
            "type": "integer"
          },
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DatasetSummaryResponse"
            }
          }
        },
        "example": {
          "dataset_id": 1,
          "records": [
            {
              "snapshot_id": 1111111111111111200,
              "est_total_dataset_stored_files": 999,
              "est_total_dataset_stored_records": 9999,
              "est_total_dataset_stored_bytes": 999999,
              "active_dataset_stored_files": 999,
              "active_dataset_stored_records": 9999,
              "active_dataset_stored_bytes": 999999,
              "snapshot_added_files": 9,
              "snapshot_added_records": 999,
              "snapshot_deleted_records": 9,
              "snapshot_added_bytes": 9999,
              "snapshot_deleted_files": 9,
              "snapshot_added_delete_files": 9,
              "snapshot_removed_delete_files": 9,
              "snapshot_removed_bytes": 9
            }
          ]
        }
      },
      "Columns": {
        "type": "object",
        "properties": {
          "columns": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "Configuration": {
        "type": "object",
        "properties": {
          "value_histogram": {
            "$ref": "#/components/schemas/Columns"
          },
          "completeness": {
            "$ref": "#/components/schemas/Columns"
          },
          "approx_count_distinct": {
            "$ref": "#/components/schemas/Columns"
          },
          "count_distinct": {
            "$ref": "#/components/schemas/Columns"
          },
          "observed_types_histogram": {
            "$ref": "#/components/schemas/Columns"
          },
          "mean": {
            "$ref": "#/components/schemas/Columns"
          },
          "deviation": {
            "$ref": "#/components/schemas/Columns"
          }
        },
        "example": {
          "value_histogram": {
            "columns": [
              "firstName",
              "secondName",
              "firstChars",
              "age"
            ]
          },
          "completeness": {
            "columns": [
              "firstName",
              "secondName",
              "firstChars",
              "age"
            ]
          },
          "approx_count_distinct": {
            "columns": [
              "firstChars",
              "age"
            ]
          },
          "count_distinct": {
            "columns": [
              "firstName",
              "secondName"
            ]
          },
          "observed_types_histogram": {
            "columns": [
              "firstName"
            ]
          },
          "mean": {
            "columns": [
              "age"
            ]
          },
          "deviation": {
            "columns": [
              "age"
            ]
          }
        }
      },
      "SnapshotRange": {
        "type": "object",
        "required": [
          "from_snapshot",
          "until_snapshot",
          "from_snapshot_timestamp",
          "until_snapshot_timestamp"
        ],
        "properties": {
          "from_snapshot": {
            "type": "string",
            "description": "The first snapshot from calculation range."
          },
          "until_snapshot": {
            "type": "string",
            "description": "The last snapshot from calculation range."
          },
          "from_snapshot_timestamp": {
            "type": "string",
            "description": "ISO-8601 timestamp of from_snapshot."
          },
          "until_snapshot_timestamp": {
            "type": "string",
            "description": "ISO-8601 timestamp of until_snapshot."
          }
        }
      },
      "AdvancedStatisticsMetadata": {
        "type": "object",
        "properties": {
          "configuration": {
            "type": "object",
            "additionalProperties": {
              "$ref": "#/components/schemas/Configuration"
            }
          },
          "snapshot_range": {
            "type": "object",
            "additionalProperties": {
              "$ref": "#/components/schemas/SnapshotRange"
            }
          }
        },
        "example": {
          "snapshot_range": {
            "from_snapshot": null,
            "until_snapshot": null,
            "from_snapshot_timestamp": null,
            "until_snapshot_timestamp": null
          },
          "configuration": {
            "value_histogram": {
              "columns": [
                "firstName",
                "secondName",
                "firstChars",
                "age"
              ]
            },
            "completeness": {
              "columns": [
                "firstName",
                "secondName",
                "firstChars",
                "age"
              ]
            },
            "approx_count_distinct": {
              "columns": [
                "firstChars",
                "age"
              ]
            },
            "count_distinct": {
              "columns": [
                "firstName",
                "secondName"
              ]
            },
            "observed_types_histogram": {
              "columns": [
                "firstName"
              ]
            },
            "mean": {
              "columns": [
                "age"
              ]
            },
            "deviation": {
              "columns": [
                "age"
              ]
            }
          }
        }
      },
      "BasicStatistics": {
        "type": "object",
        "properties": {
          "nan_value_count": {
            "description": "The number of not-a-number values in the column.",
            "type": "integer"
          },
          "null_value_count": {
            "description": "The number of null values in the column.",
            "type": "integer"
          },
          "value_count": {
            "description": "The total number of values in the column including null and not-a-number values.",
            "type": "integer"
          },
          "lower_bound": {
            "description": "Lower bound of values in the column.",
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "number"
              },
              {
                "type": "array",
                "items": {
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    }
                  ]
                }
              },
              {
                "type": "boolean"
              },
              {
                "type": "object"
              }
            ]
          },
          "upper_bound": {
            "description": "Upper bound of values in the column.",
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "number"
              },
              {
                "type": "array",
                "items": {
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    }
                  ]
                }
              },
              {
                "type": "boolean"
              },
              {
                "type": "object"
              }
            ]
          },
          "column_stored_bytes": {
            "description": "The storage size in bytes used by this column.",
            "type": "integer"
          }
        },
        "example": {
          "nan_value_count": 0,
          "null_value_count": 0,
          "lower_bound": 0.10002140801691319,
          "upper_bound": 3.73687073431858,
          "value_count": 9876,
          "column_store_bytes": 12345
        }
      },
      "DistributionValue": {
        "type": "object",
        "properties": {
          "absolute": {
            "type": "integer",
            "format": "int64"
          },
          "ratio": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "Distribution": {
        "type": "object",
        "properties": {
          "values": {
            "type": "object",
            "additionalProperties": {
              "$ref": "#/components/schemas/DistributionValue"
            }
          },
          "number_of_bins": {
            "type": "integer",
            "format": "int64"
          }
        }
      },
      "AdvancedStatistics": {
        "type": "object",
        "properties": {
          "approx_count_distinct": {
            "type": "integer",
            "format": "int32"
          },
          "count_distinct": {
            "type": "integer",
            "format": "int32"
          },
          "histogram": {
            "$ref": "#/components/schemas/Distribution"
          },
          "mean": {
            "type": "number",
            "format": "double"
          },
          "standard_deviation": {
            "type": "number",
            "format": "double"
          },
          "completeness": {
            "type": "number",
            "format": "double"
          },
          "observed_types": {
            "$ref": "#/components/schemas/Distribution"
          }
        }
      },
      "SingleColumnSummary": {
        "type": "object",
        "required": [
          "name",
          "type"
        ],
        "properties": {
          "name": {
            "description": "The name of the column.",
            "type": "string"
          },
          "type": {
            "description": "The declared type of data in the column. Can be boolean, int, long, float, double, decimal, date, time, timestamp, timestamptz, string, uuid, fixed, binary, struct, list, and map.",
            "type": "string"
          },
          "basic_statistics": {
            "$ref": "#/components/schemas/BasicStatistics"
          },
          "advanced_statistics": {
            "$ref": "#/components/schemas/AdvancedStatistics"
          }
        },
        "example": {
          "name": "age",
          "type": "LONG",
          "basic_statistics": {
            "nan_value_count": null,
            "null_value_count": 0,
            "lower_bound": 22,
            "upper_bound": 52,
            "value_count": 60,
            "column_store_bytes": 655
          },
          "advanced_statistics": {
            "approx_count_distinct": 13,
            "count_distinct": null,
            "histogram": {
              "values": {
                "22": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "25": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "28": {
                  "absolute": 9,
                  "ratio": 0.2
                },
                "31": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "32": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "34": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "36": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "39": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "40": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "45": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "47": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "50": {
                  "absolute": 3,
                  "ratio": 0.0667
                },
                "52": {
                  "absolute": 3,
                  "ratio": 0.0667
                }
              },
              "number_of_bins": 13
            },
            "mean": 35.8,
            "standard_deviation": 9.064215354899726,
            "completeness": 1,
            "observed_types": null
          }
        }
      },
      "GetColumnStatsResponse": {
        "type": "object",
        "properties": {
          "advanced_statistics_metadata": {
            "$ref": "#/components/schemas/AdvancedStatisticsMetadata"
          },
          "columns_summary": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SingleColumnSummary"
            }
          }
        }
      },
      "UpsertColumnStatsRequest": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "column_name"
              ],
              "properties": {
                "column_name": {
                  "type": "string"
                },
                "approx_count_distinct": {
                  "type": "integer",
                  "format": "int32"
                },
                "count_distinct": {
                  "type": "integer",
                  "format": "int32"
                },
                "histogram": {
                  "$ref": "#/components/schemas/Distribution"
                },
                "mean": {
                  "type": "number",
                  "format": "double"
                },
                "standard_deviation": {
                  "type": "number",
                  "format": "double"
                },
                "completeness": {
                  "type": "number",
                  "format": "double"
                },
                "observed_types": {
                  "$ref": "#/components/schemas/Distribution"
                }
              }
            }
          }
        },
        "example": {
          "records": [
            {
              "column_name": "idType",
              "approx_count_distinct": 2,
              "count_distinct": null,
              "histogram": {
                "values": {
                  "adid": {
                    "absolute": 2,
                    "ratio": 0.5
                  },
                  "idfa": {
                    "absolute": 2,
                    "ratio": 0.5
                  }
                },
                "number_of_bins": 2
              },
              "mean": null,
              "standard_deviation": null,
              "completeness": null,
              "observed_types": null
            },
            {
              "column_name": "idValue",
              "approx_count_distinct": 20000,
              "count_distinct": null,
              "histogram": null,
              "mean": null,
              "standard_deviation": null,
              "completeness": null,
              "observed_types": null
            }
          ]
        }
      },
      "RecalculationResponse": {
        "type": "object",
        "required": [
          "snapshots"
        ],
        "properties": {
          "recalculation_id": {
            "description": "Unique recalculation id.",
            "type": "string",
            "format": "uuid"
          },
          "snapshots": {
            "description": "List of snapshots that should be included into statistics.",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "from_snapshot_timestamp": {
            "type": "string",
            "description": "ISO-8601 timestamp of the first snapshot from the range."
          },
          "until_snapshot_timestamp": {
            "type": "string",
            "description": "ISO-8601 timestamp of the last snapshot from the range."
          }
        },
        "example": {
          "recalculation_id": "a81e1460-fbdc-4204-bd76-a9e496bf760d",
          "snapshots": [
            "4396758588236543"
          ],
          "from_snapshot_timestamp": "2023-06-28T19:47:36.604706Z",
          "until_snapshot_timestamp": "2023-06-28T19:47:36.604709Z"
        }
      },
      "FileIngestionRequest": {
        "type": "object",
        "required": [
          "source_file"
        ],
        "properties": {
          "source_file": {
            "type": "string",
            "description": "The file to be ingested.\n\nThis must be equal to the `upload_path` passed to the `upload` API when the file was submitted to Narrative."
          }
        },
        "example": {
          "source_file": "/2021-12-01/example.csv"
        }
      },
      "FileAdded": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          }
        },
        "example": {
          "name": "00000-357-27b8ca02-1c02-4761-85e5-5df9694015da-00001.parquet"
        }
      },
      "FilesAdded": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/FileAdded"
        },
        "example": [
          {
            "name": "00000-357-27b8ca02-1c02-4761-85e5-5df9694015da-00001.parquet"
          },
          {
            "name": "00000-357-27b8ca02-1c02-4761-85e5-5df9694015da-00002.parquet"
          }
        ]
      },
      "AddedPaths": {
        "type": "object",
        "required": [
          "added"
        ],
        "properties": {
          "added": {
            "description": "A list of added files.",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "AppendSnapshotMetadata": {
        "type": "object",
        "required": [
          "snapshot_id",
          "timestamp",
          "files",
          "is_downloadable"
        ],
        "properties": {
          "snapshot_id": {
            "description": "Unique identifier for a snapshot.",
            "type": "integer"
          },
          "timestamp": {
            "description": "ISO-8601 timestamp of Snapshot",
            "type": "string"
          },
          "files": {
            "$ref": "#/components/schemas/AddedPaths"
          },
          "operation": {
            "type": "string",
            "enum": [
              "append"
            ]
          },
          "is_downloadable": {
            "type": "boolean",
            "description": "Whether the files in the snapshot are downloadable. Files older than 30 days are not downloadable."
          }
        },
        "example": {
          "snapshot_id": 1,
          "timestamp": "2023-02-02T14:11:43.324",
          "is_downloadable": true,
          "files": {
            "added": [
              "s3://some-bucket/file1.parquet"
            ]
          },
          "operation": "append"
        }
      },
      "DeletedPaths": {
        "type": "object",
        "required": [
          "deleted"
        ],
        "properties": {
          "deleted": {
            "description": "A list of deleted files.",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "DeleteSnapshotMetadata": {
        "type": "object",
        "required": [
          "snapshot_id",
          "timestamp",
          "files",
          "is_downloadable"
        ],
        "properties": {
          "snapshot_id": {
            "description": "Unique identifier for a snapshot.",
            "type": "integer"
          },
          "timestamp": {
            "description": "ISO-8601 timestamp of Snapshot",
            "type": "string"
          },
          "files": {
            "$ref": "#/components/schemas/DeletedPaths"
          },
          "operation": {
            "type": "string",
            "enum": [
              "append"
            ]
          },
          "is_downloadable": {
            "type": "boolean",
            "description": "Whether the files in the snapshot are downloadable. Files belonging to snapshots that are older than 30 days are not downloadable"
          }
        },
        "example": {
          "snapshot_id": 1,
          "timestamp": "2023-02-02T14:11:43.324",
          "is_downloadable": true,
          "files": {
            "deleted": [
              "s3://some-bucket/file1.parquet"
            ]
          },
          "operation": "delete"
        }
      },
      "AddedAndDeletedPaths": {
        "type": "object",
        "required": [
          "added",
          "deleted"
        ],
        "properties": {
          "added": {
            "description": "A list of added files.",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "deleted": {
            "description": "A list of deleted files.",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "RewriteSnapshotMetadata": {
        "type": "object",
        "required": [
          "snapshot_id",
          "timestamp",
          "files",
          "is_downloadable"
        ],
        "properties": {
          "snapshot_id": {
            "description": "Unique identifier for a snapshot.",
            "type": "integer"
          },
          "timestamp": {
            "description": "ISO-8601 timestamp of Snapshot",
            "type": "string"
          },
          "files": {
            "$ref": "#/components/schemas/AddedAndDeletedPaths"
          },
          "operation": {
            "type": "string",
            "enum": [
              "overwrite"
            ]
          },
          "is_downloadable": {
            "type": "boolean",
            "description": "Whether the files in the snapshot are downloadable. Files belonging to snapshots that are older than 30 days are not downloadable"
          }
        },
        "example": {
          "snapshot_id": 1,
          "timestamp": "2023-02-02T14:11:43.324",
          "is_downloadable": true,
          "files": {
            "added": [
              "s3://some-bucket/file3.parquet"
            ],
            "deleted": [
              "s3://some-bucket/file4.parquet"
            ]
          },
          "operation": "overwrite"
        }
      },
      "ReplaceSnapshotMetadata": {
        "type": "object",
        "required": [
          "snapshot_id",
          "timestamp",
          "files",
          "is_downloadable"
        ],
        "properties": {
          "snapshot_id": {
            "description": "Unique identifier for a snapshot.",
            "type": "integer"
          },
          "timestamp": {
            "description": "ISO-8601 timestamp of Snapshot",
            "type": "string"
          },
          "files": {
            "$ref": "#/components/schemas/AddedAndDeletedPaths"
          },
          "operation": {
            "type": "string",
            "enum": [
              "replace"
            ]
          },
          "is_downloadable": {
            "type": "boolean",
            "description": "Whether the files in the snapshot are downloadable. Files belonging to snapshots that are older than 30 days are not downloadable"
          }
        },
        "example": {
          "snapshot_id": 1,
          "timestamp": "2023-02-02T14:11:43.324",
          "is_downloadable": true,
          "files": {
            "added": [
              "s3://some-bucket/file2.parquet"
            ],
            "deleted": [
              "s3://some-bucket/file1.parquet"
            ]
          },
          "operation": "replace"
        }
      },
      "SnapshotMetadata": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/AppendSnapshotMetadata"
          },
          {
            "$ref": "#/components/schemas/DeleteSnapshotMetadata"
          },
          {
            "$ref": "#/components/schemas/RewriteSnapshotMetadata"
          },
          {
            "$ref": "#/components/schemas/ReplaceSnapshotMetadata"
          }
        ]
      },
      "DetailedSnapshotListResponse": {
        "type": "object",
        "required": [
          "snapshots",
          "has_next"
        ],
        "properties": {
          "snapshots": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SnapshotMetadata"
            }
          },
          "has_next": {
            "description": "Pagination-related flag that shows if there are more snapshots to query.",
            "type": "boolean"
          },
          "next_snapshot": {
            "type": "number",
            "description": "The id of the snapshot that could be used as search parameter to get next page. Unlike 'offset', guarantees no 'floating pages' issues"
          }
        }
      },
      "SingleColumnStatistics": {
        "type": "object",
        "required": [
          "column_name"
        ],
        "properties": {
          "column_name": {
            "type": "string"
          },
          "approx_count_distinct": {
            "type": "integer",
            "format": "int32"
          },
          "count_distinct": {
            "type": "integer",
            "format": "int32"
          },
          "histogram": {
            "$ref": "#/components/schemas/Distribution"
          },
          "mean": {
            "type": "number",
            "format": "double"
          },
          "standard_deviation": {
            "type": "number",
            "format": "double"
          },
          "completeness": {
            "type": "number",
            "format": "double"
          },
          "observed_types": {
            "$ref": "#/components/schemas/Distribution"
          }
        }
      },
      "AllColumnsStatistics": {
        "type": "object",
        "properties": {
          "value": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SingleColumnStatistics"
            }
          }
        }
      },
      "DatasetStatistics": {
        "type": "object",
        "properties": {
          "value": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AllColumnsStatistics"
            }
          }
        }
      },
      "GetMetricConfigResponse": {
        "type": "object",
        "properties": {
          "value_histogram": {
            "$ref": "#/components/schemas/Columns"
          },
          "completeness": {
            "$ref": "#/components/schemas/Columns"
          },
          "approx_count_distinct": {
            "$ref": "#/components/schemas/Columns"
          },
          "count_distinct": {
            "$ref": "#/components/schemas/Columns"
          },
          "observed_types_histogram": {
            "$ref": "#/components/schemas/Columns"
          },
          "mean": {
            "$ref": "#/components/schemas/Columns"
          },
          "deviation": {
            "$ref": "#/components/schemas/Columns"
          },
          "version": {
            "type": "number",
            "format": "int32"
          },
          "disabled": {
            "type": "boolean"
          }
        }
      },
      "PutMetricConfigRequest": {
        "type": "object",
        "properties": {
          "value_histogram": {
            "$ref": "#/components/schemas/Columns"
          },
          "completeness": {
            "$ref": "#/components/schemas/Columns"
          },
          "approx_count_distinct": {
            "$ref": "#/components/schemas/Columns"
          },
          "count_distinct": {
            "$ref": "#/components/schemas/Columns"
          },
          "observed_types_histogram": {
            "$ref": "#/components/schemas/Columns"
          },
          "mean": {
            "$ref": "#/components/schemas/Columns"
          },
          "deviation": {
            "$ref": "#/components/schemas/Columns"
          }
        }
      },
      "PutMetricConfigResponse": {
        "type": "object",
        "properties": {
          "stream_id": {
            "type": "string",
            "format": "uuid"
          },
          "version_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "DisableMetricConfigResponse": {
        "type": "object",
        "properties": {
          "stream_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "EnableMetricConfigResponse": {
        "type": "object",
        "properties": {
          "stream_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "SnapshotFile": {
        "type": "object",
        "properties": {
          "path": {
            "description": "Appended file.",
            "type": "string"
          },
          "size": {
            "description": "Size of a file (in bytes).",
            "type": "number"
          }
        },
        "required": [
          "path",
          "size"
        ]
      },
      "SnapshotFiles": {
        "type": "object",
        "required": [
          "files",
          "snapshot_id",
          "timestamp",
          "is_downloadable"
        ],
        "properties": {
          "files": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SnapshotFile"
            }
          },
          "snapshot_id": {
            "description": "Unique identifier for a snapshot.",
            "type": "number"
          },
          "timestamp": {
            "type": "string",
            "description": "ISO-8601 timestamp of Snapshot"
          },
          "is_downloadable": {
            "type": "boolean",
            "description": "Whether the files in the snapshot are downloadable. Files belonging to snapshots that are older than 30 days are not downloadable"
          }
        }
      },
      "DatasetFileListResponse": {
        "type": "object",
        "required": [
          "files_per_snapshot",
          "has_next",
          "next_snapshot"
        ],
        "properties": {
          "files_per_snapshot": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SnapshotFiles"
            }
          },
          "has_next": {
            "description": "Pagination-related flag that shows if there are more snapshots to query.",
            "type": "boolean"
          },
          "next_snapshot": {
            "type": "number",
            "description": "The id of the snapshot that could be used as search parameter to get next page. Unlike 'offset', guarantees no 'floating pages' issues"
          }
        }
      },
      "DownloadUrl": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          }
        }
      },
      "FileExpired": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "enum": [
              "expired"
            ]
          },
          "error_description": {
            "type": "string"
          }
        },
        "example": {
          "error": "expired",
          "error_description": "File has expired"
        }
      },
      "ExecutionClusterType": {
        "description": "The type of the execution cluster to run the job on.\n\n- `dedicated` runs job on a dedicated cluster.\n- `shared` runs job on a shared cluster.",
        "type": "string",
        "enum": [
          "dedicated",
          "shared"
        ]
      },
      "ExecutionCluster": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/ExecutionClusterType"
          }
        }
      },
      "UpdateMaterializedViewRefreshRequest": {
        "type": "object",
        "properties": {
          "cron": {
            "type": "string",
            "description": "cron expression \"for example: @hourly, 0 12 * * 1-5\""
          },
          "cron_zone_id": {
            "type": "string",
            "description": "zone id where the cron should take place \"for example: EST, GMT+2\""
          },
          "execution_cluster": {
            "$ref": "#/components/schemas/ExecutionCluster"
          },
          "stats_enabled": {
            "type": "boolean",
            "description": "if we need to enable advanced statistics calculation"
          },
          "status": {
            "type": "string",
            "description": "active will be ran on cron schedule, pending and archived won't be run",
            "enum": [
              "active",
              "pending",
              "archived"
            ]
          }
        },
        "example": {
          "cron": "@hourly",
          "cron_zone_id": "EST",
          "stats_enabled": false,
          "status": "active"
        }
      },
      "CreateMaterializedViewRefreshRequest": {
        "type": "object",
        "required": [
          "cron",
          "cron_zone_id"
        ],
        "properties": {
          "cron": {
            "type": "string",
            "description": "cron expression \"for example: @hourly, 0 12 * * 1-5\""
          },
          "cron_zone_id": {
            "type": "string",
            "description": "zone id where the cron should take place \"for example: EST, GMT+2\""
          },
          "execution_cluster": {
            "$ref": "#/components/schemas/ExecutionCluster"
          },
          "stats_enabled": {
            "type": "boolean",
            "description": "if we need to enable advanced statistics calculation"
          },
          "status": {
            "type": "string",
            "description": "active will be ran on cron schedule, pending and archived won't be run",
            "enum": [
              "active",
              "pending",
              "archived"
            ]
          }
        },
        "example": {
          "cron": "@hourly",
          "cron_zone_id": "EST",
          "stats_enabled": false,
          "status": "active"
        }
      },
      "TriggerMaterializedViewRefresh": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "full",
              "incremental"
            ],
            "description": "full will skip progress tracking and run the materialized view from scratch, incremental\nwill use the progress tracking."
          },
          "execution_cluster": {
            "$ref": "#/components/schemas/ExecutionCluster"
          }
        },
        "example": {
          "type": "full",
          "execution_cluster": {
            "type": "dedicated"
          }
        }
      },
      "Budget": {
        "type": "object",
        "required": [
          "amount",
          "period"
        ],
        "description": "The maximum amount that can be spent as part of a subscription in a given time period. Once the budget has been exhausted in a given time period no more data is transacted until the start of the next one.\n\nE.g. with a budget of $100 USD and a period of `calendar_monthly` you're guaranteed that you will not be charged more than $100 for your subscription in a given month.",
        "properties": {
          "amount": {
            "type": "object",
            "required": [
              "currency",
              "value"
            ],
            "properties": {
              "currency": {
                "type": "string",
                "description": "The currency .\nCurrently only USD is supported.",
                "enum": [
                  "USD"
                ]
              },
              "value": {
                "type": "number",
                "description": "The value of the budget in the base denomination of the currency.\n\nFor USD the value is in **dollars**."
              }
            }
          },
          "period": {
            "type": "object",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "description": "Indicates when the budget for the subscription is \"reset\".\n\nCurrently only `calendar_daily` and `calendar_monthly` budgets are supported, which means the subscription budget resets at the\nstart of every day, month.",
                "enum": [
                  "calendar_daily",
                  "calendar_monthly",
                  "calendar_weekly"
                ]
              }
            }
          }
        }
      },
      "Subscription_Description": {
        "type": "string",
        "description": "A human-friendly description of the subscription."
      },
      "LongId": {
        "type": "integer",
        "format": "int64"
      },
      "FieldPath": {
        "description": "A RFC-6901 JSON pointer to a Dataset field.",
        "type": "string",
        "example": "/id/value"
      },
      "IncludeAllValuesIncludingNullsFilter": {
        "type": "string",
        "enum": [
          "include_all_values_including_nulls_filter"
        ],
        "description": "This filter enforces inclusion of all values including nulls, i.e. it acts as if no filter is applied at all."
      },
      "IncludeOnlyIfNotNullFilter": {
        "type": "string",
        "enum": [
          "include_only_if_not_null_filter"
        ],
        "description": "This filter excludes null values, i.e. if this filter applies to a given column in a row then the entire row\nis excluded from the stream."
      },
      "InclusionType": {
        "type": "string",
        "enum": [
          "include",
          "exclude"
        ],
        "description": "Include or exclude values in an enum filter."
      },
      "EnumFilter": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/InclusionType"
          },
          "list": {
            "type": "array",
            "minLength": 1,
            "items": {
              "type": "string"
            }
          }
        },
        "example": {
          "type": "include",
          "list": [
            "this",
            "that",
            "that too",
            "some more"
          ]
        }
      },
      "IntervalType": {
        "type": "string",
        "enum": [
          "inclusive",
          "exclusive"
        ],
        "description": "Whether an interval end includes or excludes the end itself."
      },
      "IntervalEnd": {
        "type": "object",
        "properties": {
          "type": {
            "$ref": "#/components/schemas/IntervalType"
          },
          "value": {
            "type": "string",
            "description": "An interval bounds, captured as a string value. For example, numbers (ints, longs and doubles) and boolean would\nbe captured as \"-1\", \"0.0\", \"true\""
          }
        },
        "required": [
          "type",
          "value"
        ]
      },
      "IntervalFilter": {
        "type": "object",
        "properties": {
          "min": {
            "$ref": "#/components/schemas/IntervalEnd"
          },
          "max": {
            "$ref": "#/components/schemas/IntervalEnd"
          }
        },
        "description": "One of the two 'min' or 'max' should be defined.",
        "example": {
          "min": {
            "type": "exclusive",
            "value": "timestamp01"
          },
          "max": {
            "type": "exclusive",
            "value": "timestamp02"
          }
        }
      },
      "Period": {
        "type": "string",
        "format": "java.time.Period",
        "description": "A date-based amount of time in the ISO-8601 calendar system, such as '2 years, 3 months and 4 days'.",
        "minLength": 1
      },
      "TimestampFilter": {
        "type": "object",
        "properties": {
          "recency": {
            "$ref": "#/components/schemas/Period"
          },
          "from": {
            "$ref": "#/components/schemas/IntervalEnd"
          },
          "to": {
            "$ref": "#/components/schemas/IntervalEnd"
          }
        },
        "example": {
          "recency": "P30D",
          "from": {
            "type": "exclusive",
            "value": "timestamp01"
          },
          "to": {
            "type": "exclusive",
            "value": "timestamp02"
          }
        }
      },
      "Expression": {
        "type": "string",
        "description": "A raw Spark SQL expression\npotentially containing a placeholder token, $this, that needs to be resolved prior to execution."
      },
      "SparkSqlConstraintFilter": {
        "type": "object",
        "properties": {
          "expressions": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/Expression"
            }
          }
        },
        "required": [
          "expressions"
        ]
      },
      "ColumnWithFilterAndExport": {
        "type": "object",
        "properties": {
          "field": {
            "$ref": "#/components/schemas/FieldPath"
          },
          "filter": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/IncludeAllValuesIncludingNullsFilter"
              },
              {
                "$ref": "#/components/schemas/IncludeOnlyIfNotNullFilter"
              },
              {
                "$ref": "#/components/schemas/EnumFilter"
              },
              {
                "$ref": "#/components/schemas/IntervalFilter"
              },
              {
                "$ref": "#/components/schemas/TimestampFilter"
              },
              {
                "$ref": "#/components/schemas/SparkSqlConstraintFilter"
              }
            ]
          },
          "exported": {
            "type": "boolean",
            "description": "Is this column exported in the data-stream? A column/field might be needed for filtering purposes\nand not always a part of the exposed data-stream."
          }
        },
        "required": [
          "field",
          "exported"
        ]
      },
      "ColumnSet": {
        "type": "object",
        "properties": {
          "dataset_id": {
            "$ref": "#/components/schemas/LongId",
            "description": "A valid existing active dataset id."
          },
          "fields": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/ColumnWithFilterAndExport"
            }
          }
        },
        "required": [
          "dataset_id",
          "fields"
        ]
      },
      "Attributes": {
        "type": "object",
        "properties": {
          "attribute_id": {
            "$ref": "#/components/schemas/LongId"
          },
          "fields": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/ColumnWithFilterAndExport"
            }
          },
          "optional": {
            "type": "boolean"
          }
        },
        "required": [
          "attribute_id",
          "fields",
          "optional"
        ]
      },
      "ColumnReference": {
        "type": "object",
        "properties": {
          "dataset_id": {
            "$ref": "#/components/schemas/LongId",
            "description": "A valid existing active dataset id."
          },
          "column_names": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/FieldPath"
            }
          }
        },
        "required": [
          "dataset_id",
          "column_names"
        ]
      },
      "AttributeReference": {
        "type": "object",
        "properties": {
          "attribute_id": {
            "$ref": "#/components/schemas/LongId"
          },
          "column_names": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/FieldPath"
            }
          }
        },
        "required": [
          "attribute_id",
          "column_names"
        ]
      },
      "Deduplication": {
        "type": "object",
        "properties": {
          "period": {
            "$ref": "#/components/schemas/Period"
          },
          "column_references": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/ColumnReference"
            }
          },
          "attribute_references": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/AttributeReference"
            }
          }
        },
        "required": [
          "period"
        ]
      },
      "FrequencyFilter": {
        "type": "object",
        "properties": {
          "column_references": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/ColumnReference"
            }
          },
          "attribute_references": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/AttributeReference"
            }
          },
          "min_inclusive": {
            "type": "integer",
            "format": "int32"
          },
          "max_inclusive": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "DatasetFilter": {
        "description": "`DatasetFilter` allows the use of an uploaded Dataset to filter data that is purchased as part of a `Subscription`.",
        "type": "object",
        "properties": {
          "dataset_id": {
            "$ref": "#/components/schemas/LongId",
            "description": "Id for an existing active dataset that is owned by the calling user."
          },
          "attribute": {
            "type": "object",
            "properties": {
              "attribute_id": {
                "$ref": "#/components/schemas/LongId"
              },
              "field": {
                "$ref": "#/components/schemas/FieldPath"
              }
            }
          },
          "inclusion": {
            "$ref": "#/components/schemas/InclusionType"
          }
        }
      },
      "DataRules": {
        "description": "Data rules capture the rules around how the data is handled within a data stream. The starting point might\nbe an already predefined and active dataset(s) or the global data attributes on the platform.\n\nData rules might apply further filtering on the data being ingested and exported through the stream.",
        "type": "object",
        "properties": {
          "column_sets": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/ColumnSet"
            }
          },
          "attributes": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/Attributes"
            }
          },
          "deduplication": {
            "$ref": "#/components/schemas/Deduplication"
          },
          "frequency_filter": {
            "$ref": "#/components/schemas/FrequencyFilter"
          },
          "dataset_filter": {
            "$ref": "#/components/schemas/DatasetFilter"
          }
        }
      },
      "Hostname": {
        "type": "string",
        "format": "trimmed-non-empty",
        "description": "A shops hostname.",
        "minLength": 1
      },
      "HostnameOrDataShopId": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/Hostname"
          },
          {
            "$ref": "#/components/schemas/UUID"
          }
        ]
      },
      "DataStream_Description": {
        "type": "string",
        "format": "trimmed-non-empty",
        "description": "The DataStream's name.",
        "minLength": 1
      },
      "Icon": {
        "type": "string",
        "format": "trimmed-non-empty",
        "description": "The icon link.",
        "minLength": 1
      },
      "Content": {
        "type": "object",
        "properties": {
          "description": {
            "$ref": "#/components/schemas/DataStream_Description"
          },
          "icon": {
            "$ref": "#/components/schemas/Icon"
          },
          "sections": {
            "type": "array",
            "items": {
              "type": "object"
            }
          }
        },
        "required": [
          "description"
        ]
      },
      "Name": {
        "type": "string",
        "format": "trimmed-non-empty",
        "description": "A name.",
        "minLength": 1
      },
      "Slug": {
        "type": "string",
        "pattern": "^[a-zA-Z0-9-_.:]+$",
        "description": "The DataStream's slug. Used for SEO/URLs.",
        "minLength": 1
      },
      "SalesChannel": {
        "type": "string",
        "enum": [
          "data_streams_market",
          "data_shop"
        ]
      },
      "Licensing": {
        "type": "object",
        "properties": {
          "period": {
            "$ref": "#/components/schemas/Period"
          },
          "license": {
            "type": "object",
            "properties": {
              "name": {
                "$ref": "#/components/schemas/Name"
              }
            },
            "required": [
              "name"
            ]
          }
        },
        "required": [
          "period",
          "license"
        ]
      },
      "PriceInMicroCent": {
        "type": "integer",
        "format": "int64"
      },
      "Pricing": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "per_record",
              "max_price_per_record"
            ]
          },
          "micro_cents_usd": {
            "$ref": "#/components/schemas/PriceInMicroCent"
          }
        },
        "required": [
          "type",
          "micro_cents_usd"
        ]
      },
      "Offer": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/UUID"
          },
          "channel": {
            "$ref": "#/components/schemas/SalesChannel"
          },
          "licensing": {
            "$ref": "#/components/schemas/Licensing"
          },
          "pricing": {
            "$ref": "#/components/schemas/Pricing"
          },
          "shops": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/HostnameOrDataShopId"
            }
          }
        },
        "required": [
          "id",
          "channel",
          "licensing",
          "pricing"
        ]
      },
      "DataStreamDetails": {
        "type": "object",
        "required": [
          "type",
          "data_rules",
          "data_shop_id",
          "data_stream_company_id",
          "data_stream_content",
          "data_stream_id",
          "data_stream_name",
          "data_stream_slug"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Details of a purchase of a data stream.",
            "enum": [
              "data_stream"
            ]
          },
          "data_rules": {
            "$ref": "#/components/schemas/DataRules"
          },
          "data_shop_id": {
            "$ref": "#/components/schemas/HostnameOrDataShopId",
            "description": "The hostname or uuid of the data shop on which the data stream was purchased."
          },
          "data_stream_company_id": {
            "type": "integer",
            "description": "The unique identifier of the company from which the data stream was purchased."
          },
          "data_stream_content": {
            "$ref": "#/components/schemas/Content"
          },
          "data_stream_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the data stream being purchased."
          },
          "data_stream_name": {
            "$ref": "#/components/schemas/Name"
          },
          "data_stream_slug": {
            "$ref": "#/components/schemas/Slug"
          },
          "offer": {
            "$ref": "#/components/schemas/Offer"
          }
        }
      },
      "CompanyConstraint": {
        "type": "object",
        "description": "A constraint describing which companies the subscription should or should not purchase from.",
        "properties": {
          "type": {
            "type": "string",
            "description": "- `inclusion`: means this subscription should purchase from datasets provided by only the companies specified in `company_ids`.\n- `exclusion`: means this subscription should from datasets provided by any company _except_ those specified in `company_ids`.",
            "enum": [
              "inclusion",
              "exclusion"
            ]
          },
          "company_ids": {
            "type": "array",
            "description": "The companies to which the constraint applies.",
            "items": {
              "type": "integer"
            }
          }
        },
        "required": [
          "type",
          "company_ids"
        ]
      },
      "DatasetConstraint": {
        "type": "object",
        "description": "A constraint describing which datasets the subscription should or should not purchase from.",
        "properties": {
          "type": {
            "type": "string",
            "description": "- `inclusion`: means this subscription should purchase from datasets provided by only the datasets specified in `dataset_ids`.\n- `exclusion`: means this subscription should purchase from datasets provided by any dataset _except_ those specified in `dataset_ids`.\n- `all`:       means this subscription should purchase from datasets from any dataset, including your own datasets.\n               This option was added for backward compatibility to allow targeting your own datasets. ",
            "enum": [
              "inclusion",
              "exclusion",
              "all"
            ]
          },
          "dataset_ids": {
            "type": "array",
            "description": "The datasets to which the constraint applies. Required when type is `inclusion` or `exclusion`.",
            "items": {
              "type": "integer"
            }
          }
        },
        "required": [
          "type"
        ]
      },
      "Subscription_Pricing": {
        "type": "object",
        "properties": {
          "micro_cents_usd": {
            "type": "integer",
            "description": "The maximum price you are willing to pay per row in microcents USD.\n\nData from providers that costs more than your specified price will not be purchased as part of the subscription.\n\nSome useful conversions:\n\n- 1 cent = 1000000 microcents\n- 1 dollar = 100000000 microcents\n\nIf you wanted to spend a max of $1 USD per 1000 rows, then you'd set `micro_cents_usd` to `100000`."
          }
        }
      },
      "MarketplaceDetails": {
        "type": "object",
        "required": [
          "type",
          "data_rules",
          "pricing"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Details of a purchase of a data stream.",
            "enum": [
              "marketplace"
            ]
          },
          "company_constraint": {
            "$ref": "#/components/schemas/CompanyConstraint"
          },
          "dataset_constraint": {
            "$ref": "#/components/schemas/DatasetConstraint"
          },
          "data_rules": {
            "$ref": "#/components/schemas/DataRules"
          },
          "pricing": {
            "$ref": "#/components/schemas/Subscription_Pricing"
          }
        }
      },
      "Details": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/DataStreamDetails"
          },
          {
            "$ref": "#/components/schemas/MarketplaceDetails"
          }
        ]
      },
      "Subscription_Name": {
        "type": "string",
        "description": "A human-friendly name for the subscription."
      },
      "Output": {
        "type": "object",
        "required": [
          "dataset_id"
        ],
        "properties": {
          "dataset_id": {
            "description": "Unique identifier for the delivery dataset.",
            "type": "integer"
          }
        }
      },
      "Cadence": {
        "type": "string",
        "description": "The cadence at which the subscription will be executed.\n\n- `once`: the subscription will run only once.\n- `hourly`: the subscription run every hour.\n- `daily`: the subscription run once per day.\n- `weekly`: the subscription run once per week.\n- `monthly`: the subscription run once per month.",
        "enum": [
          "once",
          "hourly",
          "daily",
          "weekly",
          "monthly"
        ]
      },
      "Status": {
        "type": "string",
        "description": "The current state of the subscription.\n\n- `active`: the subscription is active, data is being purchased regularly.\n- `cancelled`: the subscription has been cancelled, but not deleted.\n- `pending`: the subscription has been created but is not yet active, not data is being purchased as part of the subscription.\n- `kickoff`: the subscription is kicking off (immediate run) prior to activation.\n- `completed`: the subscription as run once as requested and is completed.",
        "enum": [
          "active",
          "cancelled",
          "pending",
          "archived",
          "kickoff",
          "completed"
        ]
      },
      "SubscriptionResponse": {
        "type": "object",
        "required": [
          "id",
          "budget",
          "company_id",
          "created_at",
          "name",
          "status",
          "updated_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "UUID",
            "description": "Unique identifier for the subscription."
          },
          "budget": {
            "$ref": "#/components/schemas/Budget"
          },
          "cancelled_at": {
            "description": "ISO-8601 timestamp indicating when the subscription was cancelled.",
            "type": "string"
          },
          "company_id": {
            "type": "integer",
            "description": "Unique identifier for the company to which the subscription belongs."
          },
          "created_at": {
            "description": "ISO-8601 timestamp indicating when the subscription rule was created.",
            "type": "string"
          },
          "description": {
            "$ref": "#/components/schemas/Subscription_Description"
          },
          "details": {
            "$ref": "#/components/schemas/Details"
          },
          "name": {
            "$ref": "#/components/schemas/Subscription_Name"
          },
          "output": {
            "$ref": "#/components/schemas/Output"
          },
          "cadence": {
            "$ref": "#/components/schemas/Cadence"
          },
          "status": {
            "$ref": "#/components/schemas/Status"
          },
          "updated_at": {
            "description": "ISO-8601 timestamp indicating when the subscription rule was created.",
            "type": "string"
          }
        }
      },
      "SubscriptionsResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SubscriptionResponse"
            }
          }
        },
        "example": {
          "records": [
            [
              {
                "id": "f82ac0d3-9391-45f5-b524-4905c383fec7",
                "cancelled_at": "2022-08-10T12:00:00Z",
                "company_id": 123,
                "created_at": "2021-12-10T00:12:23Z",
                "budget": {
                  "amount": {
                    "value": 100.23,
                    "currency": "USD"
                  },
                  "period": {
                    "type": "calendar_monthly"
                  }
                },
                "details": {
                  "type": "marketplace",
                  "company_constraint": {
                    "type": "inclusion",
                    "company_ids": [
                      1,
                      2,
                      3
                    ]
                  },
                  "data_rules": {
                    "attributes": [
                      {
                        "attribute_id": 321,
                        "fields": [
                          {
                            "field": "foo",
                            "filter": {
                              "recency": "P30D",
                              "from": {
                                "type": "inclusive",
                                "value": "2021-12-10 12:00:00"
                              }
                            },
                            "exported": false
                          },
                          {
                            "field": "bar",
                            "exported": true
                          }
                        ],
                        "optional": true
                      },
                      {
                        "attribute_id": 123,
                        "fields": [
                          {
                            "field": "baz",
                            "exported": false
                          },
                          {
                            "field": "qux",
                            "exported": true
                          }
                        ],
                        "optional": false
                      }
                    ],
                    "deduplication": {
                      "period": "P180D",
                      "attribute_references": [
                        {
                          "attribute_id": 321,
                          "column_names": [
                            "baz"
                          ]
                        }
                      ]
                    },
                    "frequency_filter": {
                      "attribute_references": [
                        {
                          "attribute_id": 321,
                          "column_names": [
                            "baz"
                          ]
                        }
                      ],
                      "min_inclusive": 2,
                      "max_inclusive": 5
                    }
                  },
                  "pricing": {
                    "micro_cents_usd": 123321
                  }
                },
                "description": "subscriptiondescription",
                "name": "subscription name",
                "output": {
                  "dataset_id": 42
                },
                "cadence": "daily",
                "status": "cancelled",
                "updated_at": "2021-12-20T00:00:00Z"
              },
              {
                "id": "9b3fd441-9add-41d8-b58a-a6ce6b0c9972",
                "company_id": 123,
                "created_at": "2021-12-10T00:12:23Z",
                "budget": {
                  "amount": {
                    "value": 100.23,
                    "currency": "USD"
                  },
                  "period": {
                    "type": "calendar_monthly"
                  }
                },
                "details": {
                  "type": "data_stream",
                  "data_rules": {
                    "column_sets": [
                      {
                        "dataset_id": 123,
                        "fields": [
                          {
                            "field": "col1",
                            "exported": true
                          },
                          {
                            "field": "col2",
                            "filter": "include_all_values_including_nulls_filter",
                            "exported": true
                          },
                          {
                            "field": "col3",
                            "filter": "include_only_if_not_null_filter",
                            "exported": true
                          },
                          {
                            "field": "col4",
                            "filter": {
                              "type": "include",
                              "list": [
                                "this",
                                "that",
                                "that too",
                                "some more"
                              ]
                            },
                            "exported": true
                          },
                          {
                            "field": "col5",
                            "filter": {
                              "type": "exclude",
                              "list": [
                                "this",
                                "that",
                                "that too",
                                "some more"
                              ]
                            },
                            "exported": true
                          },
                          {
                            "field": "col6",
                            "filter": {
                              "min": {
                                "type": "inclusive",
                                "value": "-100"
                              },
                              "max": {
                                "type": "inclusive",
                                "value": "100"
                              }
                            },
                            "exported": true
                          },
                          {
                            "field": "col6",
                            "filter": {
                              "max": {
                                "type": "exclusive",
                                "value": "timestamp01"
                              }
                            },
                            "exported": false
                          },
                          {
                            "field": "col7",
                            "filter": {
                              "recency": "P30D",
                              "from": {
                                "type": "inclusive",
                                "value": "2021-12-10 12:00:00"
                              }
                            },
                            "exported": false
                          },
                          {
                            "field": "col8",
                            "filter": {
                              "expressions": [
                                "col8 > 10"
                              ]
                            },
                            "exported": true
                          }
                        ]
                      }
                    ],
                    "deduplication": {
                      "period": "P90D",
                      "column_references": [
                        {
                          "dataset_id": 123,
                          "column_names": [
                            "col2",
                            "col4"
                          ]
                        }
                      ]
                    },
                    "frequency_filter": {
                      "column_references": [
                        {
                          "dataset_id": 123,
                          "column_names": [
                            "col2"
                          ]
                        }
                      ],
                      "min_inclusive": 2,
                      "max_inclusive": 5
                    }
                  },
                  "data_stream_company_id": 3742,
                  "data_stream_content": {
                    "description": "description is required"
                  },
                  "data_stream_id": "d00b2d0d-6d42-4e56-9116-c7dd8ccf638f",
                  "data_stream_name": "the data stream name",
                  "data_stream_slug": "a_data_product",
                  "offer": {
                    "id": "3f7c2ef3-17cc-4d37-ba1c-74bb2a287e13",
                    "channel": "data_streams_market",
                    "licensing": {
                      "period": "P90D",
                      "license": {
                        "name": "narrative opendata license"
                      }
                    },
                    "pricing": {
                      "type": "per_record",
                      "micro_cents_usd": 70000
                    }
                  }
                },
                "description": "subscription description",
                "name": "subscription name",
                "cadence": "weekly",
                "status": "active",
                "updated_at": "2021-12-20T00:00:00Z"
              }
            ]
          ]
        }
      },
      "DataStreamPurchaseDetails": {
        "type": "object",
        "required": [
          "type",
          "data_stream_id",
          "offer_id"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Details for the purchase of a data stream.",
            "enum": [
              "data_stream"
            ]
          },
          "data_shop_id": {
            "$ref": "#/components/schemas/HostnameOrDataShopId",
            "description": "The hostname of the data shop from which the data stream is being purchased."
          },
          "data_stream_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the data stream being purchased."
          },
          "offer_id": {
            "type": "string",
            "format": "uuid",
            "description": "The provider offer being accepted as part of the purchase."
          }
        }
      },
      "SubscriptionCreateRequestDetails": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/DataStreamPurchaseDetails"
          },
          {
            "$ref": "#/components/schemas/MarketplaceDetails"
          }
        ]
      },
      "SubscriptionCreateRequest": {
        "type": "object",
        "required": [
          "budget",
          "details",
          "name"
        ],
        "properties": {
          "budget": {
            "$ref": "#/components/schemas/Budget"
          },
          "description": {
            "$ref": "#/components/schemas/Subscription_Description"
          },
          "details": {
            "$ref": "#/components/schemas/SubscriptionCreateRequestDetails"
          },
          "name": {
            "$ref": "#/components/schemas/Subscription_Name"
          },
          "cadence": {
            "$ref": "#/components/schemas/Cadence"
          }
        },
        "example": {
          "budget": {
            "amount": {
              "value": 100.23,
              "currency": "USD"
            },
            "period": {
              "type": "calendar_monthly"
            }
          },
          "description": "the subscription description",
          "details": {
            "type": "data_stream",
            "data_shop_id": "www.exampledatashop.com",
            "data_stream_id": "402c7f6e-4304-407f-9369-c7e8b787e6e9",
            "offer_id": "545494d8-74b1-4508-a634-d329555f03f8"
          },
          "name": "subscription name",
          "cadence": "daily"
        }
      },
      "ScanCostEstimate": {
        "type": "object",
        "description": "An estimate of the \"cost\" of servicing a set of subscription constraints.\n\nCost has two components:\n\n- The number of rows which must be read in order to find data which matches the subscription constraints.\n- An estimate of the \"size\" of those rows in bytes.\n\nNote: the number of rows reported in the cost is **not** an estimate of the number of rows which will be purchased as part of a subscription using the given constraints.",
        "required": [
          "rows",
          "size",
          "sources"
        ],
        "properties": {
          "rows": {
            "type": "integer",
            "description": "The number of rows which must be read in order to find data which matches the constraints."
          },
          "size": {
            "type": "number",
            "description": "An approximation of the number of bytes of data which much be read to find data which matches the constraints."
          },
          "sources": {
            "type": "array",
            "description": "The data sources which must be read along with associated costs.",
            "items": {
              "type": "object",
              "required": [
                "source",
                "rows",
                "size"
              ],
              "properties": {
                "source": {
                  "oneOf": [
                    {
                      "type": "object",
                      "description": "A dataset source.",
                      "required": [
                        "type",
                        "dataset_id"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "Discriminator indicating that the source is a dataset.",
                          "enum": [
                            "dataset"
                          ]
                        },
                        "dataset_id": {
                          "type": "integer",
                          "description": "Unique identifier for the dataset."
                        }
                      }
                    },
                    {
                      "type": "object",
                      "description": "A non-dataset source.",
                      "required": [
                        "type",
                        "name"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "Discriminator indicating that the source is a non-dataset table storing information relevant to the fulfillment of the constraints.",
                          "enum": [
                            "table"
                          ]
                        },
                        "name": {
                          "type": "string",
                          "description": "The data source's name."
                        }
                      }
                    }
                  ]
                },
                "rows": {
                  "type": "integer",
                  "description": "The number of rows which must be read from the data source."
                },
                "size": {
                  "type": "number",
                  "description": "An approximation of the number of bytes which must be read from the data source."
                }
              }
            }
          }
        }
      },
      "CostForecastResponse": {
        "type": "object",
        "required": [
          "company_id",
          "cst",
          "created_at",
          "details"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "UUID",
            "description": "Unique identifier for the cost forecast. Empty if no cost forecast was created due to the subscriptions constraints resulting in no matches."
          },
          "cost": {
            "$ref": "#/components/schemas/ScanCostEstimate"
          },
          "company_id": {
            "type": "integer",
            "description": "Unique identifier for the company to which the cost forecast belongs."
          },
          "created_at": {
            "description": "ISO-8601 timestamp indicating when the cost forecast was created",
            "type": "string"
          },
          "details": {
            "description": "The set of constraints to which the cost forecast applies.",
            "allOf": [
              {
                "$ref": "#/components/schemas/Details"
              }
            ]
          },
          "subscription_id": {
            "type": "string",
            "format": "UUID",
            "description": "Unique identifier of the subscription for which the cost forecast was created. Empty if the cost forecast is not associated with a subscription."
          }
        },
        "example": {
          "id": "9cdd4b69-82cb-4454-aedf-197bc3930b44",
          "company_id": 1,
          "cost": {
            "rows": 26565354859246,
            "size": 1299135691639572,
            "sources": [
              {
                "source": {
                  "type": "dataset",
                  "dataset_id": 192
                },
                "rows": 26565354859246,
                "size": 1299135691639572
              }
            ]
          },
          "created_at": "2021-11-26T20:20:13.909581Z",
          "details": {
            "type": "marketplace",
            "company_constraint": {
              "type": "exclusion",
              "company_ids": [
                56
              ]
            },
            "data_rules": {
              "attributes": [
                {
                  "attribute_id": 2,
                  "fields": [
                    {
                      "field": "event_timestamp",
                      "filter": {
                        "recency": "P30D"
                      },
                      "exported": true
                    }
                  ],
                  "optional": false
                },
                {
                  "attribute_id": 1,
                  "fields": [
                    {
                      "field": "unique_id.type",
                      "filter": {
                        "type": "include",
                        "list": [
                          "idfa",
                          "adid"
                        ]
                      },
                      "exported": true
                    },
                    {
                      "field": "unique_id.value",
                      "filter": "include_only_if_not_null_filter",
                      "exported": true
                    }
                  ],
                  "optional": false
                },
                {
                  "attribute_id": 11,
                  "fields": [
                    {
                      "field": "ip_address",
                      "filter": "include_only_if_not_null_filter",
                      "exported": true
                    }
                  ],
                  "optional": false
                }
              ],
              "frequency_filter": {
                "attribute_references": [
                  {
                    "attribute_id": 1,
                    "column_names": [
                      "unique_id.type",
                      "unique_id.value"
                    ]
                  }
                ],
                "min_inclusive": 2
              }
            },
            "pricing": {
              "micro_cents_usd": 10000000
            }
          },
          "request_source": {
            "type": "api_user",
            "company_id": 1,
            "user_id": 1
          },
          "subscription_id": null
        }
      },
      "CostForecastsResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CostForecastResponse"
            }
          }
        }
      },
      "MatchesRequest": {
        "description": "A set of subscription constraints for which matches will be generated.",
        "allOf": [
          {
            "$ref": "#/components/schemas/SubscriptionCreateRequestDetails"
          }
        ],
        "example": {
          "details": {
            "type": "marketplace",
            "company_constraint": {
              "type": "inclusion",
              "company_ids": [
                1,
                2,
                3
              ]
            },
            "data_rules": {
              "attributes": [
                {
                  "attribute_id": 123,
                  "fields": [
                    {
                      "field": "example.timestamp",
                      "filter": {
                        "recency": "P30D",
                        "from": {
                          "type": "inclusive",
                          "value": "2021-12-10 12:00:00"
                        },
                        "to": null
                      },
                      "exported": false
                    },
                    {
                      "field": "example.string_field",
                      "filter": null,
                      "exported": true
                    }
                  ],
                  "optional": true
                }
              ]
            },
            "pricing": {
              "micro_cents_usd": 1000000000
            }
          }
        }
      },
      "Match_DatasetResponse": {
        "type": "object",
        "required": [
          "id",
          "company_id",
          "name"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "description": "Unique identifier for the dataset."
          },
          "company_id": {
            "type": "integer",
            "description": "Unique identifier for the company owning the dataset."
          },
          "name": {
            "type": "string",
            "description": "The dataset's name."
          },
          "description": {
            "type": "string",
            "description": "A description of the dataset."
          }
        }
      },
      "AccessRuleResponse": {
        "type": "object",
        "required": [
          "id",
          "constaints",
          "pricing"
        ],
        "properties": {
          "id": {
            "type": "integer",
            "description": "Unique identifier for the access rule."
          },
          "constraints": {
            "type": "array",
            "description": "The set of boolean SQL expressions used to determine whether the access rule applies to a row from the dataset.",
            "items": {
              "type": "string"
            }
          },
          "pricing": {
            "type": "integer",
            "description": "How much is charged for a row matching this access rule.\n\nPrices are specified in microcents USD. Some useful conversions:\n\n- 1 cent = 1000000 microcents\n- 1 dollar = 100000000 microcents"
          }
        }
      },
      "AttributesMatch": {
        "type": "object",
        "required": [
          "attributes",
          "dataset",
          "matching_access_rules",
          "non_matching_access_rules"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Discriminator indicating that the type of match being returned is in terms of attributes mapped from a dataset.",
            "enum": [
              "attributes"
            ]
          },
          "attributes": {
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "id",
                "name"
              ],
              "properties": {
                "id": {
                  "type": "integer",
                  "description": "Unique identifier for the matched attribute."
                },
                "name": {
                  "type": "string",
                  "description": "The name of the matched attribute."
                }
              }
            }
          },
          "dataset": {
            "description": "The dataset providing the matching attributes.",
            "allOf": [
              {
                "$ref": "#/components/schemas/Match_DatasetResponse"
              }
            ]
          },
          "matching_access_rules": {
            "description": "The access rules describing which rows will be purchased from the dataset at what price.",
            "allOf": [
              {
                "$ref": "#/components/schemas/AccessRuleResponse"
              }
            ]
          },
          "non_matching_access_rules": {
            "description": "The access rules which will potentially limit which rows are received when purchasing from the matching dataset given your constraints.\n\nE.g. if a provider is charging more than your max bid price for rows with a particular set of attributes then the access rules pricing those rows would be \"non-matching\" as your max bid price is too low.",
            "allOf": [
              {
                "$ref": "#/components/schemas/AccessRuleResponse"
              }
            ]
          }
        }
      },
      "DatasetMatch": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "description": "Discriminator indicating that the type of match being returned is in terms of a single dataset."
              }
            }
          },
          {
            "$ref": "#/components/schemas/Match_DatasetResponse"
          }
        ]
      },
      "MatchResponse": {
        "type": "object",
        "oneOf": [
          {
            "$ref": "#/components/schemas/AttributesMatch"
          },
          {
            "$ref": "#/components/schemas/DatasetMatch"
          }
        ]
      },
      "MatchesResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MatchResponse"
            }
          }
        }
      },
      "SubscriptionUpdateRequest": {
        "type": "object",
        "required": [
          "budget",
          "details",
          "name"
        ],
        "properties": {
          "budget": {
            "$ref": "#/components/schemas/Budget"
          },
          "description": {
            "$ref": "#/components/schemas/Subscription_Description"
          },
          "details": {
            "$ref": "#/components/schemas/MarketplaceDetails"
          },
          "name": {
            "$ref": "#/components/schemas/Subscription_Name"
          },
          "cadence": {
            "$ref": "#/components/schemas/Cadence"
          }
        },
        "example": {
          "budget": {
            "amount": {
              "value": 250,
              "currency": "USD"
            },
            "period": {
              "type": "calendar_monthly"
            }
          },
          "description": "subscription description",
          "details": {
            "type": "marketplace",
            "data_rules": {
              "attributes": [
                {
                  "attribute_id": 32,
                  "fields": [
                    {
                      "field": "customer_v1.id.type",
                      "filter": {
                        "type": "include",
                        "list": [
                          "idfa"
                        ]
                      },
                      "exported": true
                    },
                    {
                      "field": "customer_v1.id.value",
                      "exported": true
                    },
                    {
                      "field": "customer_v1.name.full_name",
                      "exported": true
                    }
                  ],
                  "optional": false
                },
                {
                  "attribute_id": 45,
                  "fields": [
                    {
                      "field": "event_timestamp_v2",
                      "filter": {
                        "recency": "P180D"
                      },
                      "exported": true
                    }
                  ],
                  "optional": true
                },
                {
                  "attribute_id": 30,
                  "fields": [
                    {
                      "field": "product_v2.name",
                      "exported": true
                    }
                  ],
                  "optional": true
                }
              ],
              "deduplication": {
                "period": "P90D",
                "attribute_references": [
                  {
                    "attribute_id": 123,
                    "column_names": [
                      "event_timestamp_v2"
                    ]
                  }
                ]
              },
              "frequency_filter": {
                "attribute_references": [
                  {
                    "attribute_id": 123,
                    "column_names": [
                      "event_timestamp_v2"
                    ]
                  }
                ],
                "min_inclusive": 2,
                "max_inclusive": 5
              }
            },
            "pricing": {
              "micro_cents_usd": 1000000000
            }
          },
          "name": "subscription name",
          "cadence": "monthly"
        }
      },
      "TransactionBatchId": {
        "type": "string",
        "format": "uuid",
        "description": "Unique identifier for the subscription fulfillment event which produced the file."
      },
      "DeliveryFile": {
        "type": "object",
        "required": [
          "company_id",
          "file",
          "size",
          "subscription_id",
          "transaction_batch_id",
          "timestamp"
        ],
        "properties": {
          "company_id": {
            "type": "integer",
            "description": "Unique identifier for the company to which the subscription belongs."
          },
          "file": {
            "type": "string",
            "description": "The name of the delivered file."
          },
          "size": {
            "type": "integer",
            "description": "The file size in bytes."
          },
          "subscription_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the subscription with which the file is associated."
          },
          "transaction_batch_id": {
            "$ref": "#/components/schemas/TransactionBatchId"
          },
          "timestamp": {
            "type": "string",
            "description": "ISO-8601 timestamp indicating when the file was created."
          }
        },
        "example": {
          "company_id": 123,
          "file": "part-000001-dbba05a2-2924-424a-80ab-2a8af07ddd19.json",
          "size": 1231231231,
          "subscription_id": "7c39a38d-a23a-4c48-9dcf-681400e0c552",
          "transaction_batch_id": "2ed2ecdd-5f17-4e08-8f13-948cecdd4c38",
          "timestamp": "2021-12-31T00:00:01Z"
        }
      },
      "DeliveryFilesResponse": {
        "type": "object",
        "required": [
          "records"
        ],
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DeliveryFile"
            }
          }
        },
        "example": {
          "records": [
            {
              "company_id": 123,
              "file": "part-000001-dbba05a2-2924-424a-80ab-2a8af07ddd19.json",
              "size": 1231231231,
              "subscription_id": "7c39a38d-a23a-4c48-9dcf-681400e0c552",
              "transaction_batch_id": "2ed2ecdd-5f17-4e08-8f13-948cecdd4c38",
              "timestamp": "2021-12-31T00:00:01Z"
            }
          ]
        }
      },
      "DownloadFileRequest": {
        "type": "object",
        "required": [
          "transaction_batch_id",
          "file"
        ],
        "properties": {
          "transaction_batch_id": {
            "$ref": "#/components/schemas/TransactionBatchId"
          },
          "file": {
            "type": "string",
            "description": "The name of the delivered file to be downloaded."
          },
          "file_name_override": {
            "type": "string",
            "description": "If specified, when the delivery file is download it will have the name specified by `file_name_override` instead of the default name given by the `file` parameter."
          }
        }
      },
      "DownloadFileResponse": {
        "type": "object",
        "required": [
          "download_url"
        ],
        "properties": {
          "download_url": {
            "type": "string",
            "description": "An AWS S3 presigned URL that can be used to download the file.\n\nThe presigned URL is valid for _one hour_ meaning that the link must be used within an hour of receipt."
          }
        }
      },
      "Boolean": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "True/false values. Input values must be one of `true` or `false`.",
            "enum": [
              "boolean"
            ]
          }
        }
      },
      "Double": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "64-bit IEEE 754 floating point values.",
            "enum": [
              "double"
            ]
          }
        }
      },
      "Long": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "64-bit signed integer values.",
            "enum": [
              "long"
            ]
          }
        }
      },
      "String": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Abitrary-length character sequences encoded with UTF-8.",
            "enum": [
              "string"
            ]
          }
        }
      },
      "TimestampTz": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Timestamp with timezone, stored as microseconds. Input values are expected to be valid [ISO-8601](https://en.wikipedia.org/wiki/ISO_8601) strings.",
            "enum": [
              "timestamptz"
            ]
          }
        }
      },
      "DataSchema_ObjectProperty": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "description": {
                "type": "string",
                "description": "A description of the named field."
              }
            },
            "oneOf": [
              {
                "$ref": "#/components/schemas/Boolean"
              },
              {
                "$ref": "#/components/schemas/Double"
              },
              {
                "$ref": "#/components/schemas/Long"
              },
              {
                "$ref": "#/components/schemas/String"
              },
              {
                "$ref": "#/components/schemas/TimestampTz"
              }
            ]
          }
        ]
      },
      "Object": {
        "type": "object",
        "required": [
          "type",
          "properties"
        ],
        "properties": {
          "type": {
            "description": "A record consisting of named fields of any type.",
            "enum": [
              "object"
            ]
          },
          "properties": {
            "type": "object",
            "description": "A map from field names to field types.\n\nField names must consist of only alphanumeric characters or underscores and be < 255 characters long.",
            "additionalProperties": {
              "$ref": "#/components/schemas/DataSchema_ObjectProperty"
            }
          }
        }
      },
      "Array": {
        "type": "object",
        "required": [
          "type",
          "items"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "An array with elements of any data type.",
            "enum": [
              "array"
            ]
          },
          "items": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/Boolean"
              },
              {
                "$ref": "#/components/schemas/Double"
              },
              {
                "$ref": "#/components/schemas/Long"
              },
              {
                "$ref": "#/components/schemas/Object"
              },
              {
                "$ref": "#/components/schemas/String"
              },
              {
                "$ref": "#/components/schemas/TimestampTz"
              }
            ]
          }
        }
      },
      "Type": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/Array"
          },
          {
            "$ref": "#/components/schemas/Boolean"
          },
          {
            "$ref": "#/components/schemas/Double"
          },
          {
            "$ref": "#/components/schemas/Long"
          },
          {
            "$ref": "#/components/schemas/Object"
          },
          {
            "$ref": "#/components/schemas/String"
          },
          {
            "$ref": "#/components/schemas/TimestampTz"
          }
        ]
      },
      "Property": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "description": {
                "type": "string"
              }
            }
          },
          {
            "$ref": "#/components/schemas/Type"
          }
        ]
      },
      "DataSchema": {
        "type": "object",
        "example": {
          "value": {
            "type": "double"
          },
          "iso_4217_currency": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "additionalProperties": {
          "$ref": "#/components/schemas/Property"
        }
      },
      "CreateDataShopRequest": {
        "type": "object",
        "properties": {
          "hostname": {
            "$ref": "#/components/schemas/Hostname"
          },
          "fe_manifest": {
            "type": "object",
            "description": "Any valid json object is accepted. This allows FE/UI to decide the shape of this."
          }
        },
        "required": [
          "hostname"
        ]
      },
      "Instant": {
        "description": "ISO-8601 instant.",
        "type": "string",
        "example": "2021-06-24T00:54:40.029056Z"
      },
      "DataShop": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/UUID"
          },
          "hostname": {
            "$ref": "#/components/schemas/Hostname"
          },
          "compan_id": {
            "$ref": "#/components/schemas/CompanyId"
          },
          "manifest": {
            "type": "object",
            "description": "A valid json object. This is partially governed by the passed `fe_manifest`."
          },
          "created_by": {
            "$ref": "#/components/schemas/LongId"
          },
          "created_at": {
            "$ref": "#/components/schemas/Instant"
          },
          "updated_by": {
            "$ref": "#/components/schemas/LongId"
          },
          "updated_at": {
            "$ref": "#/components/schemas/Instant"
          }
        },
        "required": [
          "id",
          "hostname",
          "company_id",
          "created_by",
          "created_at",
          "updated_by",
          "updated_at"
        ]
      },
      "UpdateDataShopRequest": {
        "type": "object",
        "properties": {
          "hostname": {
            "$ref": "#/components/schemas/Hostname"
          },
          "fe_manifest": {
            "type": "object",
            "description": "Any valid json object is accepted. This allows FE/UI to decide the shape of this."
          }
        },
        "required": [
          "hostname"
        ]
      },
      "DataShopIds": {
        "type": "object",
        "properties": {
          "ids": {
            "type": "array",
            "maxLength": 200,
            "items": {
              "$ref": "#/components/schemas/UUID"
            }
          }
        },
        "required": [
          "ids"
        ],
        "example": {
          "ids": [
            "cddfface-beda-4f84-ab22-a9933fad3992",
            "6460aa19-ddb2-424c-a54e-0f80b82b1698"
          ]
        }
      },
      "PaginatedDataShops": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DataShop"
            }
          }
        },
        "required": [
          "records"
        ]
      },
      "Tag": {
        "type": "string",
        "format": "trimmed-non-empty",
        "description": "A tag. Useful for searching and cataloging",
        "minLength": 1
      },
      "Category": {
        "type": "string",
        "format": "trimmed-non-empty",
        "description": "The DataStream's category. Useful for searches and cataloging.",
        "minLength": 1
      },
      "DataStream_CompanyConstraint": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "inclusion",
              "exclusion"
            ]
          },
          "company_ids": {
            "type": "array",
            "minLength": 1,
            "items": {
              "$ref": "#/components/schemas/CompanyId"
            }
          }
        },
        "required": [
          "type",
          "company_ids"
        ]
      },
      "AuthRules": {
        "type": "object",
        "properties": {
          "company-constraint": {
            "$ref": "#/components/schemas/DataStream_CompanyConstraint"
          }
        }
      },
      "DataStreamCreateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "$ref": "#/components/schemas/Name"
          },
          "slug": {
            "$ref": "#/components/schemas/Slug"
          },
          "content": {
            "$ref": "#/components/schemas/Content"
          },
          "tags": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Tag"
            }
          },
          "category": {
            "$ref": "#/components/schemas/Category"
          },
          "offers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Offer"
            }
          },
          "data_rules": {
            "$ref": "#/components/schemas/DataRules"
          },
          "auth_rules": {
            "$ref": "#/components/schemas/AuthRules"
          }
        },
        "required": [
          "name",
          "slug"
        ],
        "example": {
          "name": "Greg Test Datastream",
          "slug": "greg-test-1",
          "content": {
            "description": "Greg created this datastream to test changes for attributes and is not going to upload any data for it.",
            "icon": null,
            "sections": []
          },
          "tags": [
            "Testing",
            "greg",
            "data",
            "datastream",
            "test"
          ],
          "category": "Test",
          "offers": [
            {
              "id": "0488d937-b716-4df2-841c-8a63026c268d",
              "channel": "data_streams_market",
              "licensing": {
                "period": "P30D",
                "license": {
                  "name": "Narrative Marketplace Data Purchase Agreement"
                }
              },
              "pricing": {
                "type": "per_record",
                "micro_cents_usd": 500000
              },
              "shops": null
            },
            {
              "id": "2ff93ef0-eb92-44ae-965e-dafbb6725fb9",
              "channel": "data_shop",
              "licensing": {
                "period": "P30D",
                "license": {
                  "name": "https://app.narrative.io/legal/data-purchase-agreement"
                }
              },
              "pricing": {
                "type": "per_record",
                "micro_cents_usd": 100000
              },
              "shops": [
                "fanaticsdatashop.com"
              ]
            }
          ],
          "data_rules": {
            "column_sets": [
              {
                "dataset_id": 91,
                "fields": [
                  {
                    "field": "id",
                    "filter": null,
                    "exported": true
                  },
                  {
                    "field": "audience",
                    "filter": null,
                    "exported": true
                  }
                ]
              }
            ],
            "attributes": null,
            "deduplication": null,
            "frequency_filter": null
          },
          "auth_rules": null
        }
      },
      "schemas_UserId": {
        "type": "integer",
        "format": "int64",
        "example": 20
      },
      "DataStream": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/UUID"
          },
          "company_id": {
            "$ref": "#/components/schemas/CompanyId"
          },
          "name": {
            "$ref": "#/components/schemas/Name"
          },
          "slug": {
            "$ref": "#/components/schemas/Slug"
          },
          "content": {
            "$ref": "#/components/schemas/Content"
          },
          "tags": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Tag"
            }
          },
          "category": {
            "$ref": "#/components/schemas/Category"
          },
          "offers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Offer"
            }
          },
          "data_rules": {
            "$ref": "#/components/schemas/DataRules"
          },
          "auth_rules": {
            "$ref": "#/components/schemas/AuthRules"
          },
          "created_by": {
            "allOf": [
              {
                "$ref": "#/components/schemas/schemas_UserId"
              },
              {
                "description": "Unique id from a user who created it."
              }
            ]
          },
          "created_at": {
            "description": "The instant this data-stream came into existence.",
            "$ref": "#/components/schemas/Instant"
          },
          "updated_at": {
            "description": "The instant this data-stream was last updated.",
            "$ref": "#/components/schemas/Instant"
          }
        },
        "example": {
          "id": "f94e8803-fc03-4c3e-a3fc-c3ffe3993788",
          "company_id": 100,
          "name": "best data stream name",
          "slug": "this-is-a-slug",
          "content": {
            "description": "Fabulous Data Stream even better than anything out there!",
            "icon": "https://some.icon.png",
            "sections": [
              {
                "title": "some title",
                "description": "some description",
                "image": "some-image"
              },
              {
                "whatever": "whatever json structure FE would like to have here.",
                "free_form": "json here"
              }
            ]
          },
          "tags": [
            "tag1",
            "tag2"
          ],
          "category": "categoryA",
          "offers": [
            {
              "id": "16310512-a8fb-4ce8-aec3-573693067df9",
              "channel": "data_streams_market",
              "licensing": {
                "period": "P90D",
                "license": {
                  "name": "narrative opendata license"
                }
              },
              "pricing": {
                "type": "per_record",
                "micro_cents_usd": 70000
              },
              "shops": null
            },
            {
              "id": "d7542ec5-558f-4e98-9ff6-e049b24798fa",
              "channel": "data_shop",
              "licensing": {
                "period": "P90D",
                "license": {
                  "name": "narrative opendata license"
                }
              },
              "pricing": {
                "type": "per_record",
                "micro_cents_usd": 50000
              },
              "shops": null
            },
            {
              "id": "5d52d8d8-b683-4ef4-9220-31347dc2237f",
              "channel": "data_shop",
              "licensing": {
                "period": "P90D",
                "license": {
                  "name": "narrative opendata license"
                }
              },
              "pricing": {
                "type": "max_price_per_record",
                "micro_cents_usd": 30000
              },
              "shops": [
                "only.on.tld.com"
              ]
            }
          ],
          "data_rules": {
            "column_sets": [
              {
                "dataset_id": 99999,
                "fields": [
                  {
                    "field": "col1",
                    "filter": null,
                    "exported": true
                  },
                  {
                    "field": "col2",
                    "filter": "include_all_values_including_nulls_filter",
                    "exported": true
                  },
                  {
                    "field": "col3",
                    "filter": "include_only_if_not_null_filter",
                    "exported": true
                  },
                  {
                    "field": "col4",
                    "filter": {
                      "type": "include",
                      "list": [
                        "this",
                        "that",
                        "that too",
                        "some more"
                      ]
                    },
                    "exported": true
                  },
                  {
                    "field": "col5",
                    "filter": {
                      "type": "exclude",
                      "list": [
                        "this",
                        "that",
                        "that too",
                        "some more"
                      ]
                    },
                    "exported": true
                  },
                  {
                    "field": "col6",
                    "filter": {
                      "min": {
                        "type": "inclusive",
                        "value": "-100"
                      },
                      "max": {
                        "type": "inclusive",
                        "value": "100"
                      }
                    },
                    "exported": true
                  },
                  {
                    "field": "col6",
                    "filter": {
                      "min": null,
                      "max": {
                        "type": "exclusive",
                        "value": "timestamp01"
                      }
                    },
                    "exported": false
                  },
                  {
                    "field": "col7",
                    "filter": {
                      "type": "include",
                      "list": [
                        "true"
                      ]
                    },
                    "exported": true
                  },
                  {
                    "field": "col8",
                    "filter": {
                      "recency": "P30D",
                      "from": null,
                      "to": {
                        "type": "exclusive",
                        "value": "timestamp01"
                      }
                    },
                    "exported": true
                  }
                ]
              }
            ],
            "attributes": [
              {
                "attribute_id": 123,
                "fields": [
                  {
                    "field": "col1",
                    "filter": null,
                    "exported": true
                  },
                  {
                    "field": "col2",
                    "filter": "include_all_values_including_nulls_filter",
                    "exported": true
                  },
                  {
                    "field": "col3",
                    "filter": "include_only_if_not_null_filter",
                    "exported": true
                  },
                  {
                    "field": "col4",
                    "filter": {
                      "type": "include",
                      "list": [
                        "this",
                        "that",
                        "that too",
                        "some more"
                      ]
                    },
                    "exported": true
                  },
                  {
                    "field": "col5",
                    "filter": {
                      "type": "exclude",
                      "list": [
                        "this",
                        "that",
                        "that too",
                        "some more"
                      ]
                    },
                    "exported": true
                  },
                  {
                    "field": "col6",
                    "filter": {
                      "min": {
                        "type": "inclusive",
                        "value": "-100"
                      },
                      "max": {
                        "type": "inclusive",
                        "value": "100"
                      }
                    },
                    "exported": true
                  },
                  {
                    "field": "col6",
                    "filter": {
                      "min": null,
                      "max": {
                        "type": "exclusive",
                        "value": "timestamp01"
                      }
                    },
                    "exported": false
                  },
                  {
                    "field": "col7",
                    "filter": {
                      "type": "include",
                      "list": [
                        "true"
                      ]
                    },
                    "exported": true
                  },
                  {
                    "field": "col8",
                    "filter": {
                      "recency": "P30D",
                      "from": null,
                      "to": {
                        "type": "exclusive",
                        "value": "timestamp01"
                      }
                    },
                    "exported": true
                  },
                  {
                    "field": "col9",
                    "filter": {
                      "expressions": [
                        "col9 > -90",
                        "col9 < 90"
                      ]
                    },
                    "exported": true
                  }
                ],
                "optional": true
              },
              {
                "attribute_id": 321,
                "fields": [
                  {
                    "field": "col9",
                    "filter": {
                      "expressions": [
                        "col9 > -90",
                        "col9 < 90"
                      ]
                    },
                    "exported": false
                  }
                ],
                "optional": false
              }
            ],
            "deduplication": {
              "period": "P60D",
              "column_references": null,
              "attribute_references": [
                {
                  "attribute_id": 123,
                  "column_names": [
                    "col9",
                    "col9.foo.bar"
                  ]
                }
              ]
            },
            "frequency_filter": {
              "column_references": null,
              "attribute_references": [
                {
                  "attribute_id": 123,
                  "column_names": [
                    "col9.foo.bar"
                  ]
                }
              ],
              "min_inclusive": 2,
              "max_inclusive": 5
            }
          },
          "auth_rules": {
            "company_constraint": {
              "type": "inclusion",
              "company_ids": [
                160,
                1701
              ]
            }
          },
          "created_by": 5000,
          "created_at": "2021-06-29T10:58:36.726Z",
          "updated_at": "2021-06-29T10:58:36.726Z",
          "datasets": null
        }
      },
      "DataStreamIds": {
        "type": "object",
        "properties": {
          "ids": {
            "type": "array",
            "maxLength": 50,
            "items": {
              "$ref": "#/components/schemas/UUID"
            }
          }
        },
        "required": [
          "ids"
        ],
        "example": {
          "ids": [
            "cddfface-beda-4f84-ab22-a9933fad3992",
            "6460aa19-ddb2-424c-a54e-0f80b82b1698"
          ]
        }
      },
      "PaginatedDataStreams": {
        "type": "object",
        "required": [
          "records"
        ],
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DataStream"
            }
          }
        }
      },
      "EncryptionMaterial": {
        "type": "object",
        "required": [
          "id",
          "company_id",
          "key",
          "salt"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "The id of the encryption material"
          },
          "company_id": {
            "type": "integer",
            "description": "the company_id the encryption material belongs to"
          },
          "key": {
            "type": "string",
            "description": "The decrypted encryption key"
          },
          "salt": {
            "type": "string",
            "description": "The encryption salt"
          }
        },
        "example": {
          "id": "tmh-9w",
          "company_id": 1,
          "key": "42qM49JKw+ssWntvUKez25ku9xxge6P+h/X3bVlZe5M=",
          "salt": "eROwh/ni8r6pbjRNXj3cOZJPMK348NG+zpy6mzuLISk="
        }
      },
      "list_response": {
        "type": "object",
        "required": [
          "records"
        ],
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EncryptionMaterial"
            }
          }
        },
        "example": {
          "records": [
            {
              "id": "tmh-9w",
              "company_id": 1,
              "key": "42qM49JKw+ssWntvUKez25ku9xxge6P+h/X3bVlZe5M=",
              "salt": "eROwh/ni8r6pbjRNXj3cOZJPMK348NG+zpy6mzuLISk="
            },
            {
              "id": "U-oztw",
              "company_id": 1,
              "key": "0gudo94Bsf92/FLjT5uUI8arx2r7N0LB6/bop5RDqR8=",
              "salt": "KnF5F+VeG9xIYhFY9XTyeQTPYk6Wba/SEvSDzq0lHNA="
            }
          ]
        }
      },
      "create_request": {
        "type": "object",
        "required": [
          "display_name"
        ],
        "properties": {
          "display_name": {
            "type": "string",
            "description": "The name of the encryption material"
          },
          "description": {
            "type": "string",
            "description": "The description of the encryption material. Optional."
          },
          "Tags": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Each tag must be less than 256 chars. Optional."
          }
        },
        "example": {
          "display_name": "My encryption material",
          "description": "Some kind of description",
          "tags": [
            "use-case-1"
          ]
        }
      },
      "create_response": {
        "type": "object",
        "required": [
          "id"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "The id of the encryption material"
          }
        },
        "example": {
          "id": "tmh-9w"
        }
      },
      "MultipartFile": {
        "type": "object",
        "properties": {
          "file": {
            "type": "string",
            "format": "binary"
          }
        }
      },
      "AppProfileResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "enabled",
              "disabled",
              "archived"
            ]
          },
          "app_id": {
            "type": "string",
            "description": "The unique identifier of the app"
          },
          "app_name": {
            "type": "string",
            "description": "The name of the app"
          },
          "tags": {
            "type": "array",
            "description": "List of tags associated with the profile",
            "items": {
              "type": "string"
            }
          }
        },
        "example": {
          "id": "7bc22af4-fb6e-431e-92bc-e366e4f960ff",
          "name": "My profile name",
          "description": "My profile description",
          "status": "disabled",
          "app_id": "123e4567-e89b-12d3-a456-426614174000",
          "app_name": "My App",
          "tags": [
            "production",
            "analytics"
          ]
        }
      },
      "AppProfilesResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/AppProfileResponse"
        }
      },
      "AppProfileRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "description": "Optional list of tags to associate with the profile",
            "items": {
              "type": "string"
            }
          }
        },
        "example": {
          "name": "My profile name",
          "description": "My profile description",
          "tags": [
            "production",
            "analytics"
          ]
        }
      },
      "AppProfileUpdateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "description": "Optional list of tags to update on the profile",
            "items": {
              "type": "string"
            }
          }
        },
        "example": {
          "description": "My profile description",
          "tags": [
            "staging",
            "test"
          ]
        }
      },
      "JobId": {
        "type": "string",
        "format": "uuid",
        "description": "Unique identifier for the job."
      },
      "RequestSource": {
        "type": "object",
        "properties": {
          "type": {
            "description": "The job request type.",
            "type": "string"
          },
          "company_id": {
            "description": "The company associated with the job.",
            "type": "integer"
          },
          "user_id": {
            "description": "The user associated with the job.",
            "type": "integer"
          }
        },
        "example": {
          "type": "api_user",
          "company_id": 1,
          "user_id": 1248
        }
      },
      "State": {
        "type": "string",
        "default": "pending",
        "enum": [
          "failed",
          "cancelled",
          "completed",
          "pending",
          "running"
        ]
      },
      "MaterializedViewInput": {
        "type": "object",
        "properties": {
          "nql": {
            "description": "The NQL associated with the job.",
            "type": "string"
          },
          "compiled_sql": {
            "description": "The compiled SQL associated with the job.",
            "type": "string"
          },
          "dataset_id": {
            "description": "The output dataset associated with a job that creates a materialized view.",
            "type": "integer"
          },
          "stats_enabled": {
            "description": "A flag to indicate whether there are extended dataset statistics turned on for a materialized view. No flag passed in the api request will default to true."
          }
        },
        "example": {
          "nql": "CREATE MATERIALIZED VIEW \"sampleNQL\" as WITH OrderedData AS (\n  SELECT\n    \"mobile_id_unique_identifier\".\"value\" AS mobile_id,\n    \"timestamp_object\".\"day\",\n    \"timestamp_object\".\"hour\",\n    \"geographic_location\".\"latitude\",\n    \"geographic_location\".\"longitude\",\n    \"event_timestamp\",\n    LAG(\"event_timestamp\", 1) OVER (PARTITION BY \"mobile_id_unique_identifier\".\"value\", \"geographic_location\".\"latitude\", \"geographic_location\".\"longitude\" ORDER BY \"event_timestamp\") AS prev_timestamp\n  FROM\n    \"company_data\".\"6402\"\n  WHERE\n    \"mobile_id_unique_identifier\".\"value\" IS NOT NULL \n), \nContinuousPresence AS (\n  SELECT\n    mobile_id,\n    \"day\",\n    \"hour\",\n    latitude,\n    longitude,\n    event_timestamp,\n    prev_timestamp,\n    CASE\n      WHEN extract(minute FROM event_timestamp) - extract(minute FROM prev_timestamp) BETWEEN 40 AND 120 THEN 1\n      ELSE 0\n    END AS is_continuous\n  FROM\n    OrderedData\n)\nSELECT\n  mobile_id,\n  \"day\",\n  \"hour\",\n  latitude,\n  longitude\nFROM\n  ContinuousPresence\nWHERE\n  is_continuous = 1\nGROUP BY\n  mobile_id,\n  \"day\",\n  \"hour\",\n  latitude,\n  longitude\n",
          "dataset_id": 6404,
          "stats_enabled": true,
          "compiled_sql": "SELECT\n  `t`.`mobile_id`,\n  `t`.`day`,\n  `t`.`hour`,\n  `t`.`latitude`,\n  `t`.`longitude`\nFROM\n  (SELECT\n      `ds_6402`.`mobile_id_unique_identifier`['value'] `mobile_id`,\n      `ds_6402`.`timestamp_object`['day'] `day`,\n      `ds_6402`.`timestamp_object`['hour'] `hour`,\n      `ds_6402`.`geographic_location`['latitude'] `latitude`,\n      `ds_6402`.`geographic_location`['longitude'] `longitude`,\n        CASE\n        WHEN EXTRACT(MINUTE FROM `ds_6402`.`event_timestamp`) - EXTRACT(MINUTE FROM LAG(`ds_6402`.`event_timestamp`, 1) OVER (\n                    PARTITION BY `ds_6402`.`mobile_id_unique_identifier`.`value`, `ds_6402`.`geographic_location`.`latitude`, `ds_6402`.`geographic_location`.`longitude`\n                    ORDER BY `ds_6402`.`event_timestamp` NULLS LAST)) >= 40 AND EXTRACT(MINUTE FROM `ds_6402`.`event_timestamp`) - EXTRACT(MINUTE FROM LAG(`ds_6402`.`event_timestamp`, 1) OVER (\n                    PARTITION BY `ds_6402`.`mobile_id_unique_identifier`.`value`, `ds_6402`.`geographic_location`.`latitude`, `ds_6402`.`geographic_location`.`longitude`\n                    ORDER BY `ds_6402`.`event_timestamp` NULLS LAST)) <= 120\n        THEN 1\n        ELSE 0\n        END `is_continuous`\n    FROM\n      narrative.datasets.ds_6402 `ds_6402`) `t`\nWHERE\n  `t`.`is_continuous` = 1\nGROUP BY\n  `t`.`mobile_id`,\n  `t`.`day`,\n  `t`.`hour`,\n  `t`.`latitude`,\n  `t`.`longitude`"
        }
      },
      "ExplainInput": {
        "type": "object",
        "properties": {
          "nql": {
            "description": "The NQL associated with the job.",
            "type": "string"
          },
          "compiled_sql": {
            "description": "The compiled SQL associated with the job.",
            "type": "string"
          }
        },
        "example": {
          "nql": "EXPLAIN SELECT narrative.rosetta_stone.\"age\", narrative.rosetta_stone.\"unique_id\".\"value\" FROM narrative.rosetta_stone WHERE narrative.rosetta_stone._price_cpm_usd <= 10.00 AND narrative.rosetta_stone.\"age\" > 50",
          "compiled_sql": "SELECT\n  SUM(CASE\n      WHEN `t17`.`_dataset_id` IN (192, 544)\n      THEN `t17`.`_access_rule`['price_micro_cents_usd'] * 128\n      WHEN `t17`.`_dataset_id` IN (63, 73, 280)\n      THEN `t17`.`_access_rule`['price_micro_cents_usd'] * 1024\n      WHEN `t17`.`_dataset_id` = 477\n      THEN `t17`.`_access_rule`['price_micro_cents_usd'] * 8192\n      ELSE `t17`.`_access_rule`['price_micro_cents_usd']\n      END) `totalCost`,\n  SUM(CASE\n      WHEN `t17`.`_dataset_id` IN (192, 544)\n      THEN 128\n      WHEN `t17`.`_dataset_id` IN (63, 73, 280)\n      THEN 1024\n      WHEN `t17`.`_dataset_id` = 477\n      THEN 8192\n      ELSE 1\n      END) `totalRows`\nFROM\n  (SELECT\n        `t`.`age`,\n        NAMED_STRUCT('id', 623, 'price_micro_cents_usd', 100000) `_access_rule`,\n        63 `_dataset_id`\n      FROM\n        (SELECT\n            `ds_63`.`_nio_sample_1024`,\n            `ds_63`.`age`\n          FROM\n            narrative.datasets.ds_63 `ds_63`) `t`\n      WHERE\n        `t`.`_nio_sample_1024`\n      UNION ALL\n      SELECT\n        `t2`.`age`,\n        NAMED_STRUCT('id', 105, 'price_micro_cents_usd', 0) `_access_rule`,\n        73 `_dataset_id`\n      FROM\n        (SELECT\n            `ds_73`.`_nio_sample_1024`,\n            `ds_73`.`age`\n          FROM\n            narrative.datasets.ds_73 `ds_73`) `t2`\n      WHERE\n        `t2`.`_nio_sample_1024`\n      UNION ALL\n      SELECT\n        NULL `age`,\n        NAMED_STRUCT('id', 4, 'price_micro_cents_usd', 1000) `_access_rule`,\n        192 `_dataset_id`\n      FROM\n        (SELECT\n            `ds_192`.`_nio_sample_128`\n          FROM\n            narrative.datasets.ds_192 `ds_192`) `t5`\n      WHERE\n        `t5`.`_nio_sample_128`\n      UNION ALL\n      SELECT\n        `t8`.`age`,\n        NAMED_STRUCT('id', 58, 'price_micro_cents_usd', 200000) `_access_rule`,\n        280 `_dataset_id`\n      FROM\n        (SELECT\n            `ds_280`.`_nio_sample_1024`,\n            `ds_280`.`age`\n          FROM\n            narrative.datasets.ds_280 `ds_280`) `t8`\n      WHERE\n        `t8`.`_nio_sample_1024`\n      UNION ALL\n      SELECT\n        FLOOR(DATEDIFF(CURRENT_DATE, CAST(TO_TIMESTAMP(`t11`.`yob`) AS DATE)) / 365) `age`,\n        NAMED_STRUCT('id', 108, 'price_micro_cents_usd', 0) `_access_rule`,\n        477 `_dataset_id`\n      FROM\n        (SELECT\n            `ds_477`.`_nio_sample_8192`,\n            `ds_477`.`yob`\n          FROM\n            narrative.datasets.ds_477 `ds_477`) `t11`\n      WHERE\n        `t11`.`_nio_sample_8192`\n      UNION ALL\n      SELECT\n        `t14`.`age_in_2_year_ranges_enhanced` `age`,\n        NAMED_STRUCT('id', 463, 'price_micro_cents_usd', 0) `_access_rule`,\n        544 `_dataset_id`\n      FROM\n        (SELECT\n            `ds_544`.`_nio_sample_128`,\n            `ds_544`.`age_in_2_year_ranges_enhanced`\n          FROM\n            narrative.datasets.ds_544 `ds_544`) `t14`\n      WHERE\n        `t14`.`_nio_sample_128`) `t17`\nWHERE\n  `t17`.`_access_rule`['price_micro_cents_usd'] <= 1000000\n  AND `t17`.`age` > 50"
        }
      },
      "Input": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/MaterializedViewInput"
          },
          {
            "$ref": "#/components/schemas/ExplainInput"
          }
        ]
      },
      "Failure": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "value": {
            "description": "useful information to diagnostic a failure such as a Apache Spark stacktrace",
            "type": "object"
          }
        }
      },
      "MaterializedViewOutput": {
        "type": "object",
        "description": "The output of a materialized view.",
        "properties": {
          "dataset_id": {
            "description": "The output dataset associated with a job that creates a materialized view.",
            "type": "integer"
          },
          "snapshot_id": {
            "description": "The snapshot ID associated with the job.",
            "type": "integer"
          },
          "recalculation_id": {
            "description": "The recalculation ID associated with the job.",
            "type": "string"
          }
        },
        "example": {
          "dataset_id": 6404,
          "snapshot_id": 739881302291276700,
          "recalculation_id": "abf9a2ec-426b-4751-bd16-fcb435061925"
        }
      },
      "ExplainOutput": {
        "type": "object",
        "description": "The output of a forecast.",
        "properties": {
          "success": {
            "type": "object",
            "properties": {
              "result": {
                "type": "object",
                "properties": {
                  "Forecast": {
                    "type": "object",
                    "properties": {
                      "cost": {
                        "type": "integer",
                        "description": "The cost to buy every row of data available in the forecast on a CPM basis."
                      },
                      "rows": {
                        "type": "integer",
                        "description": "The amount of rows returned from a forecast."
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "example": {
          "success": {
            "result": {
              "Forecast": {
                "cost": 136130662400000,
                "rows": 1643721216
              }
            }
          }
        }
      },
      "Result": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/MaterializedViewOutput"
          },
          {
            "$ref": "#/components/schemas/ExplainOutput"
          }
        ]
      },
      "JobResponse": {
        "type": "object",
        "required": [
          "job_id",
          "request_source",
          "state",
          "type",
          "input",
          "executor",
          "executionCluster",
          "failures",
          "idempotency_key",
          "result",
          "created_at",
          "updated_at",
          "ended_at"
        ],
        "properties": {
          "job_id": {
            "$ref": "#/components/schemas/JobId"
          },
          "request_source": {
            "$ref": "#/components/schemas/RequestSource"
          },
          "state": {
            "$ref": "#/components/schemas/State"
          },
          "type": {
            "description": "The type associated with the job. Jobs can have a type of nql-forecast or materialize-view.",
            "type": "string"
          },
          "input": {
            "$ref": "#/components/schemas/Input"
          },
          "executor": {
            "description": "The internal job executor tied to the job.",
            "type": "string"
          },
          "execution_cluster": {
            "$ref": "#/components/schemas/ExecutionClusterType"
          },
          "failures": {
            "description": "causes of job failure",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Failure"
            }
          },
          "idempotency_key": {
            "description": "The unique ID associated with the job.",
            "type": "string"
          },
          "result": {
            "$ref": "#/components/schemas/Result"
          },
          "created_at": {
            "description": "The timestamp representing when the job was created.",
            "type": "string",
            "format": "date-time"
          },
          "updated_at": {
            "description": "The timestamp representing when the job was updated.",
            "type": "string",
            "format": "date-time"
          },
          "ended_at": {
            "description": "The timestamp representing when the job finished.",
            "type": "string",
            "format": "date-time"
          }
        },
        "example": {
          "job_id": "2a5b9ad7-dc8f-47bb-8e62-843a38f8054c",
          "request_source": {
            "type": "api_user",
            "company_id": 1,
            "user_id": 407
          },
          "state": "completed",
          "type": "materialize-view",
          "input": {
            "nql": "CREATE MATERIALIZED VIEW \"test_stats\" AS SELECT \"value\" FROM \"company_data\".\"10674\"",
            "dataset_id": 10736,
            "stats_enabled": true,
            "compiled_select": "SELECT\n  `ds_10674`.`value`\nFROM\n  narrative.datasets.ds_10674 `ds_10674`"
          },
          "executor": "job-executor-98e1f48e-bf54-4f11-bbd1-73c445120266",
          "idempotency_key": "10736:29329c64e7b8a4eda86aaabe04872b832ab456b5543d0c259c812525391f158c:669a5f8e4f373c2f907700decde47511aac6470f5698e2b856fb07f09160e5f2",
          "result": {
            "dataset_id": 10736,
            "snapshot_id": 1724919539450264600,
            "recalculation_id": "abf9a2ec-426b-4751-bd16-fcb435061925"
          },
          "created_at": "2023-10-31T11:19:13.400498",
          "updated_at": "2023-10-31T11:25:08.327209",
          "ended_at": "2023-10-31T11:25:08.327194"
        }
      },
      "JobsResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JobResponse"
            }
          }
        },
        "example": {
          "records": [
            {
              "job_id": "2a5b9ad7-dc8f-47bb-8e62-843a38f8054c",
              "request_source": {
                "type": "api_user",
                "company_id": 1,
                "user_id": 407
              },
              "state": "completed",
              "type": "materialize-view",
              "input": {
                "nql": "CREATE MATERIALIZED VIEW \"test_stats\" AS SELECT \"value\" FROM \"company_data\".\"10674\"",
                "dataset_id": 10736,
                "stats_enabled": true,
                "compiled_select": "SELECT\n  `ds_10674`.`value`\nFROM\n  narrative.datasets.ds_10674 `ds_10674`"
              },
              "executor": "job-executor-98e1f48e-bf54-4f11-bbd1-73c445120266",
              "idempotency_key": "10736:29329c64e7b8a4eda86aaabe04872b832ab456b5543d0c259c812525391f158c:669a5f8e4f373c2f907700decde47511aac6470f5698e2b856fb07f09160e5f2",
              "result": {
                "dataset_id": 10736,
                "snapshot_id": 1724919539450264600,
                "recalculation_id": "abf9a2ec-426b-4751-bd16-fcb435061925"
              },
              "created_at": "2023-10-31T11:19:13.400498",
              "updated_at": "2023-10-31T11:25:08.327209",
              "ended_at": "2023-10-31T11:25:08.327194"
            }
          ]
        }
      },
      "DomainsResponse": {
        "type": "object",
        "description": "Lists company's domains",
        "properties": {
          "domains": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "company-info_CompanyId": {
        "type": "integer",
        "description": "Unique identifier of an existing company.",
        "example": 7
      },
      "PublicCompanyResponse": {
        "type": "object",
        "properties": {
          "company_id": {
            "$ref": "#/components/schemas/company-info_CompanyId"
          },
          "slug": {
            "description": "Unique id for the company",
            "type": "string"
          },
          "name": {
            "description": "Name of the company",
            "type": "string"
          },
          "short_description": {
            "description": "A short description of the company",
            "type": "string"
          },
          "long_description": {
            "description": "The complete description of the company",
            "type": "string"
          },
          "contact_email": {
            "description": "Email contact",
            "type": "string"
          },
          "website": {
            "description": "The url of the website of the company",
            "type": "string"
          },
          "data_shop_url": {
            "description": "The url of the data shop of the company",
            "type": "string"
          },
          "twitter_link": {
            "description": "Twitter account",
            "type": "string"
          },
          "linkedin_link": {
            "description": "LinkedIn account",
            "type": "string"
          },
          "image_url": {
            "description": "The url of the logo of the company",
            "type": "string"
          },
          "location": {
            "description": "The geographical location of the company",
            "type": "string"
          },
          "size": {
            "description": "The number of employees",
            "type": "string"
          },
          "visibility": {
            "type": "string",
            "enum": [
              "invisible",
              "visible",
              "invisible_in_discover"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "active",
              "deleted",
              "pending"
            ]
          }
        },
        "example": {
          "company_id": 42,
          "slug": "acm",
          "name": "ACM",
          "long_description": "The Acme Corporation is an ironic name for the fictional corporation, appearing in the Road Runner/Wile E. Coyote animated shorts, where it was used as a running gag.",
          "short_description": "American Company that Manufactures Everything",
          "contact_email": "info@acm.io",
          "data_shop_url": "https://shop.acm.io",
          "twitter_link": "https://twitter.com/acm_company",
          "linkedin_link": "https://www.linkedin.com/company/acm_company",
          "image_url": null,
          "visibility": "visible",
          "status": "active",
          "website": null
        }
      },
      "CompanyInfo": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/company-info_CompanyId"
          },
          "name": {
            "description": "Name of the company",
            "type": "string"
          },
          "short_description": {
            "description": "A short description of the company",
            "type": "string"
          },
          "long_description": {
            "description": "The complete description of the company",
            "type": "string"
          },
          "company_type": {
            "description": "The type of company",
            "type": "string"
          },
          "image_url": {
            "description": "The url of the logo of the company",
            "type": "string"
          },
          "location": {
            "description": "The geographical location of the company",
            "type": "string"
          },
          "size": {
            "description": "The number of employees",
            "type": "string"
          },
          "website": {
            "description": "The url of the website of the company",
            "type": "string"
          },
          "contact": {
            "description": "Email contact",
            "type": "string"
          },
          "created_at": {
            "description": "The instant this company was created.",
            "$ref": "#/components/schemas/Instant"
          }
        },
        "example": {
          "id": 28,
          "name": "ACM",
          "short_description": "American Company that Manufactures Everything",
          "long_description": "The Acme Corporation is an ironic name for the fictional corporation, appearing in the Road Runner/Wile E. Coyote animated shorts, where it was used as a running gag.",
          "company_type": "Manufactures Everything",
          "image_url": "https://d18qs7yq39787j.cloudfront.net/uploads/company/3862/acme_logo.jpg",
          "location": "USA",
          "size": "200 - 500 Employees",
          "website": "N/A",
          "contact": "info@narrative.io",
          "created_at": "2017-04-23T11:59:33"
        }
      },
      "PaginatedCompanyInfoResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CompanyInfo"
            }
          }
        }
      },
      "WhoAmIResponse": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/company-info_CompanyId"
          },
          "user_id": {
            "description": "The user id",
            "type": "integer"
          },
          "credit_limit_usd": {
            "description": "The company credit limit (USD)",
            "type": "integer"
          },
          "check_datashops_credit_limit": {
            "description": "Whether the buyer's credit limit should be checked for datashops purchases. Relevant to data shop owners only.",
            "type": "boolean"
          }
        },
        "required": [
          "id",
          "credit_limit_usd",
          "check_datashops_credit_limit"
        ],
        "example": {
          "id": 7,
          "user_id": 100,
          "credit_limit_usd": 1000,
          "check_datashops_credit_limit": false
        }
      },
      "CompanyResponse": {
        "type": "object",
        "properties": {
          "company_id": {
            "$ref": "#/components/schemas/company-info_CompanyId"
          },
          "name": {
            "description": "Name of the company",
            "type": "string"
          },
          "slug": {
            "description": "Unique id for the company",
            "type": "string"
          },
          "short_description": {
            "description": "A short description of the company",
            "type": "string"
          },
          "long_description": {
            "description": "The complete description of the company",
            "type": "string"
          },
          "image_url": {
            "description": "The url of the logo of the company",
            "type": "string"
          },
          "location": {
            "description": "The geographical location of the company",
            "type": "string"
          },
          "size": {
            "description": "The number of employees",
            "type": "string"
          },
          "website": {
            "description": "The url of the website of the company",
            "type": "string"
          },
          "contact_email": {
            "description": "Email contact",
            "type": "string"
          },
          "twitter_link": {
            "description": "Twitter account",
            "type": "string"
          },
          "linkedin_link": {
            "description": "LinkedIn account",
            "type": "string"
          },
          "created_at": {
            "description": "The instant this company was created.",
            "$ref": "#/components/schemas/Instant"
          },
          "created_by": {
            "description": "Contact of user who created the company",
            "type": "string"
          },
          "last_updated_at": {
            "description": "The instant this company was created.",
            "$ref": "#/components/schemas/Instant"
          },
          "last_updated_by": {
            "description": "Contact of user who updated the company",
            "type": "string"
          },
          "visibility": {
            "type": "string",
            "enum": [
              "invisible",
              "visible",
              "invisible_in_discover"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "active",
              "deleted",
              "pending"
            ]
          }
        },
        "example": {
          "company_id": 42,
          "name": "ACM",
          "slug": "acm",
          "long_description": "The Acme Corporation is an ironic name for the fictional corporation, appearing in the Road Runner/Wile E. Coyote animated shorts, where it was used as a running gag.",
          "short_description": "American Company that Manufactures Everything",
          "contact_email": "info@acm.io",
          "twitter_link": "https://twitter.com/acm_company",
          "linkedin_link": "https://www.linkedin.com/company/acm_company",
          "image_url": null,
          "visibility": "visible",
          "status": "active",
          "website": null,
          "created_at": "2016-06-09T02:00:47Z",
          "created_by": "admin@acm.io",
          "last_updated_at": "2023-08-17T16:18:10.386058Z",
          "last_updated_by": "admin@acm.io"
        }
      },
      "CompanyUpdateRequest": {
        "type": "object",
        "properties": {
          "company_id": {
            "$ref": "#/components/schemas/company-info_CompanyId"
          },
          "name": {
            "description": "Name of the company",
            "type": "string"
          },
          "slug": {
            "description": "Name of the company",
            "type": "string"
          },
          "short_description": {
            "description": "A short description of the company",
            "type": "string"
          },
          "long_description": {
            "description": "The complete description of the company",
            "type": "string"
          },
          "image_url": {
            "description": "The url of the logo of the company",
            "type": "string"
          },
          "location": {
            "description": "The geographical location of the company",
            "type": "string"
          },
          "size": {
            "description": "The number of employees",
            "type": "string"
          },
          "website": {
            "description": "The url of the website of the company",
            "type": "string"
          },
          "contact_email": {
            "description": "Email contact",
            "type": "string"
          },
          "twitter_link": {
            "description": "Twitter account",
            "type": "string"
          },
          "linkedin_link": {
            "description": "LinkedIn account",
            "type": "string"
          },
          "visibility": {
            "type": "string",
            "enum": [
              "invisible",
              "visible",
              "invisible_in_discover"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "active",
              "deleted",
              "pending"
            ]
          }
        },
        "example": {
          "name": "ACM",
          "slug": "acm",
          "long_description": "The Acme Corporation is an ironic name for the fictional corporation, appearing in the Road Runner/Wile E. Coyote animated shorts, where it was used as a running gag.",
          "short_description": "American Company that Manufactures Everything",
          "contact_email": "info@acm.io",
          "twitter_link": "https://twitter.com/acm_company",
          "linkedin_link": "https://www.linkedin.com/company/acm_company",
          "image_url": null,
          "visibility": "visible",
          "status": "active",
          "website": null
        }
      },
      "MappingId": {
        "description": "Unique identifier for a mapping.",
        "type": "string",
        "format": "uuid",
        "example": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a6f0"
      },
      "MappingExpression": {
        "type": "string",
        "description": "A raw SQL expression which produces a value from the source dataset for the target primitive attribute type.\n\nE.g. for a source dataset with the following type definition:\n\n```\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"firstName\": {\n      \"type\": \"string\"\n    },\n    \"lastName\": {\n      \"type\": \"string\"\n    }\n  },\n  \"required\": [\n    \"lastName\"\n  ]\n}\n```\n\n\nValid expressions include:\n\n- Lower casing the first name:\n\n```sql\nlower(firstName)\n```\n\n- Constructing a \"full name\" from the first and last name:\n\n```sql\nconcat_ws(' ', coalesce(firstName, ''), lastName)\n```\n\n- Taking the first initial of the first name if is not null:\n\n```sql\ncase when firstName is not null and char_length(firstName) > 0 then substr(firstName, 1) else null end\n```"
      },
      "MappingPath": {
        "type": "string",
        "description": "A string indicating which property of the target attribute the expression is producing a value for.\n\nE.g. for an attribute with the following type definition;\n\n```\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"latitude\": {\n      \"type\": \"double\"\n    },\n    \"longitude\": {\n      \"type\": \"double\"\n    },\n    \"location_accuracy\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"horizontal\": {\n          \"type\": \"double\"\n        },\n        \"vertical\": {\n          \"type\": \"double\"\n        }\n      }\n    }\n  },\n  \"required\": [\n    \"latitude\",\n    \"longitude\"\n  ]\n}\n```\n\nThe possible paths are:\n\n- `latitude`\n- `longitude`\n- `location_accuracy.horizontal`\n- `location_accuracy.vertical`"
      },
      "MappingExpressionDependencies": {
        "type": "object",
        "description": "Describes the dataset fields that a mapping expression depends on.",
        "properties": {
          "properties": {
            "type": "array",
            "description": "List of dataset field references that the mapping expression uses.",
            "items": {
              "type": "string"
            },
            "example": [
              "firstName",
              "lastName"
            ]
          }
        },
        "example": {
          "properties": []
        }
      },
      "ObjectMapping": {
        "type": "object",
        "required": [
          "type",
          "property_mappings"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "A mapping from a dataset to an attribute with a type of `object`.",
            "enum": [
              "object_mapping"
            ]
          },
          "property_mappings": {
            "type": "array",
            "description": "`property_mappings` define how a value for each property of the target attribute is constructed from a row of the source dataset.\n\nA mapping must be provided for each of the target attribute's _required_ properties.",
            "items": {
              "type": "object",
              "properties": {
                "expression": {
                  "$ref": "#/components/schemas/MappingExpression"
                },
                "path": {
                  "$ref": "#/components/schemas/MappingPath"
                },
                "dependencies": {
                  "$ref": "#/components/schemas/MappingExpressionDependencies"
                }
              }
            }
          }
        }
      },
      "ValueMapping": {
        "type": "object",
        "required": [
          "type",
          "expression"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "A mapping from a dataset to an attribute with a primitive type, i.e. one of `array`, `boolean`, `double`, `long`, `string`, or `timestamptz`.",
            "enum": [
              "value_mapping"
            ]
          },
          "expression": {
            "$ref": "#/components/schemas/MappingExpression"
          },
          "dependencies": {
            "$ref": "#/components/schemas/MappingExpressionDependencies"
          }
        }
      },
      "MappingDefinition": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/ObjectMapping"
          },
          {
            "$ref": "#/components/schemas/ValueMapping"
          }
        ]
      },
      "MappingStatus": {
        "type": "string",
        "description": "The status of the mapping.\n  * `active` - Active mappings can be used\n  * `archived` - Archived/Deleted mappings - mapping no longer in use\n  * `pending` - Pending mappings need to be accepted before they can be used\n",
        "enum": [
          "active",
          "archived",
          "pending"
        ]
      },
      "MappingScope": {
        "type": "string",
        "description": "The scope of the mapping.\n  * `global` - Mappings available to all\n  * `private` - Company private mappings\n",
        "enum": [
          "global",
          "private"
        ]
      },
      "MappingSource": {
        "type": "string",
        "description": "The source of the mapping.\n  * `company` - Company private mapping\n  * `admin` - Admin created/promoted mapping\n  * `system` - System (Automated/ML) mappings\n",
        "enum": [
          "company",
          "admin",
          "system"
        ]
      },
      "MappingResponse": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/MappingId"
          },
          "attribute_id": {
            "type": "integer",
            "description": "The target attribute's ID."
          },
          "created_at": {
            "type": "string",
            "description": "ISO-8601 timestamp indicating when the mapping was created.",
            "example": "2021-08-26T21:06:07.710357Z"
          },
          "dataset_id": {
            "type": "integer",
            "description": "The source dataset's ID."
          },
          "mapping": {
            "$ref": "#/components/schemas/MappingDefinition"
          },
          "status": {
            "$ref": "#/components/schemas/MappingStatus"
          },
          "updated_at": {
            "type": "string",
            "description": "ISO-8601 timestamp indicating when the mapping was last updated.",
            "example": "2021-08-26T21:06:07.710357Z"
          },
          "created_by": {
            "allOf": [
              {
                "$ref": "#/components/schemas/schemas_UserId"
              },
              {
                "description": "Unique id from a user who created it."
              }
            ]
          },
          "updated_by": {
            "allOf": [
              {
                "$ref": "#/components/schemas/schemas_UserId"
              },
              {
                "description": "Unique id from a user who updated it."
              }
            ]
          },
          "company_id": {
            "$ref": "#/components/schemas/CompanyId"
          },
          "scope": {
            "$ref": "#/components/schemas/MappingScope"
          },
          "source": {
            "$ref": "#/components/schemas/MappingSource"
          },
          "derived_from": {
            "$ref": "#/components/schemas/MappingId"
          }
        },
        "required": [
          "id",
          "attribute_id",
          "created_at",
          "dataset_id",
          "mapping",
          "status",
          "updated_at",
          "created_by",
          "updated_by",
          "scope",
          "source"
        ],
        "example": {
          "id": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a7f0",
          "attribute_id": 1,
          "created_at": "2021-12-10T00:00:00Z",
          "dataset_id": 3,
          "mapping": {
            "type": "object_mapping",
            "property_mappings": [
              {
                "path": "foo",
                "expression": "upper(`US Kennel ID`)",
                "dependencies": {
                  "properties": [
                    "US Kennel ID"
                  ]
                }
              },
              {
                "path": "bar.baz.qux",
                "expression": "weight * 10000",
                "dependencies": {
                  "properties": [
                    "weight"
                  ]
                }
              }
            ]
          },
          "status": "active",
          "updated_at": "2021-12-10T00:00:01Z",
          "created_by": 1,
          "updated_by": 1,
          "company_id": 100,
          "scope": "global",
          "source": "admin",
          "derived_from": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a6f0"
        }
      },
      "MappingsResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MappingResponse"
            }
          }
        },
        "required": [
          "records"
        ],
        "example": {
          "records": [
            {
              "id": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a7f0",
              "attribute_id": 1,
              "created_at": "2021-12-10T00:00:00Z",
              "dataset_id": 3,
              "mapping": {
                "type": "object_mapping",
                "property_mappings": [
                  {
                    "path": "foo",
                    "expression": "upper(`US Kennel ID`)",
                    "dependencies": {
                      "properties": [
                        "US Kennel ID"
                      ]
                    }
                  },
                  {
                    "path": "bar.baz.qux",
                    "expression": "weight * 10000",
                    "dependencies": {
                      "properties": [
                        "weight"
                      ]
                    }
                  }
                ]
              },
              "status": "active",
              "updated_at": "2021-12-10T00:00:01Z",
              "created_by": 1,
              "updated_by": 1,
              "company_id": 100,
              "scope": "global",
              "source": "admin",
              "derived_from": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a6f0"
            },
            {
              "id": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a6f0",
              "attribute_id": 1,
              "created_at": "2021-12-10T00:00:00Z",
              "dataset_id": 3,
              "mapping": {
                "type": "value_mapping",
                "expression": "foo bar baz",
                "dependencies": {
                  "properties": []
                }
              },
              "status": "archived",
              "updated_at": "2021-12-10T00:00:01Z",
              "created_by": 1,
              "updated_by": 2,
              "company_id": 100,
              "scope": "global",
              "source": "admin",
              "derived_from": null
            }
          ]
        }
      },
      "RawObjectMapping": {
        "type": "object",
        "description": "Object mapping definition for create/update requests (without dependencies).",
        "required": [
          "type",
          "property_mappings"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "A mapping from a dataset to an attribute with a type of `object`.",
            "enum": [
              "object_mapping"
            ]
          },
          "property_mappings": {
            "type": "array",
            "description": "`property_mappings` define how a value for each property of the target attribute is constructed from a row of the source dataset.\n\nA mapping must be provided for each of the target attribute's _required_ properties.",
            "items": {
              "type": "object",
              "properties": {
                "expression": {
                  "$ref": "#/components/schemas/MappingExpression"
                },
                "path": {
                  "$ref": "#/components/schemas/MappingPath"
                }
              }
            }
          }
        }
      },
      "RawValueMapping": {
        "type": "object",
        "description": "Value mapping definition for create/update requests (without dependencies).",
        "required": [
          "type",
          "expression"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "A mapping from a dataset to an attribute with a primitive type, i.e. one of `array`, `boolean`, `double`, `long`, `string`, or `timestamptz`.",
            "enum": [
              "value_mapping"
            ]
          },
          "expression": {
            "$ref": "#/components/schemas/MappingExpression"
          }
        }
      },
      "RawMappingDefinition": {
        "description": "Mapping definition for create/update requests. Dependencies are computed server-side and not provided by the client.",
        "oneOf": [
          {
            "$ref": "#/components/schemas/RawObjectMapping"
          },
          {
            "$ref": "#/components/schemas/RawValueMapping"
          }
        ]
      },
      "MappingCreateRequest": {
        "type": "object",
        "properties": {
          "attribute_id": {
            "type": "integer",
            "description": "The target attribute's ID."
          },
          "dataset_id": {
            "type": "integer",
            "description": "The source dataset's ID."
          },
          "mapping": {
            "$ref": "#/components/schemas/RawMappingDefinition"
          }
        },
        "example": {
          "attribute_id": 123,
          "dataset_id": 456,
          "mapping": {
            "type": "object_mapping",
            "property_mappings": [
              {
                "path": "product.brand",
                "expression": "itemBrand"
              },
              {
                "path": "product.category",
                "expression": "itemCategory"
              },
              {
                "path": "product.id.type",
                "expression": "'SKU'"
              },
              {
                "path": "product.id.value",
                "expression": "itemID"
              }
            ]
          }
        }
      },
      "MappingUpdateRequest": {
        "type": "object",
        "properties": {
          "mapping": {
            "$ref": "#/components/schemas/RawMappingDefinition"
          }
        }
      },
      "MappingPreviewResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "type": "object"
            }
          }
        },
        "example": {
          "records": [
            {
              "input": {
                "idType": "idType1",
                "idValue": "idValue1"
              },
              "output": {
                "unique_id_f7635d42_51ce_4535_ae8b_9ac64df85501": {
                  "type": "idType1",
                  "value": "idValue1"
                }
              }
            },
            {
              "input": {
                "idType": "idType2",
                "idValue": "idValue2"
              },
              "output": {
                "unique_id_f7635d42_51ce_4535_ae8b_9ac64df85501": {
                  "type": "idType2",
                  "value": "idValue2"
                }
              }
            }
          ]
        }
      },
      "RunRequest": {
        "type": "object",
        "properties": {
          "data_plane_id": {
            "type": "string",
            "format": "uuid",
            "description": "Data plane identifier, must be provided when registering dataset in external dataplane."
          },
          "model": {
            "type": "string",
            "enum": [
              "anthropic.claude-haiku-4.5",
              "anthropic.claude-sonnet-4.5",
              "anthropic.claude-opus-4.5",
              "openai.gpt-oss-120b",
              "openai.gpt-4.1",
              "openai.o4-mini"
            ]
          },
          "messages": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "role": {
                  "type": "string",
                  "enum": [
                    "system",
                    "user"
                  ]
                },
                "text": {
                  "type": "string"
                }
              },
              "required": [
                "role",
                "text"
              ]
            }
          },
          "inference_config": {
            "type": "object",
            "properties": {
              "output_format_schema": {
                "type": "object",
                "description": "A JSON Schema"
              },
              "max_tokens": {
                "type": "number",
                "format": "double"
              },
              "temperature": {
                "type": "number",
                "format": "double"
              },
              "top_p": {
                "type": "number",
                "format": "double"
              },
              "stop_sequences": {
                "type": "number",
                "format": "double"
              }
            },
            "required": [
              "output_format_schema"
            ]
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "data_plane_id",
          "model",
          "messages",
          "inference_config"
        ],
        "example": {
          "data_plane_id": "fef9904e-d263-4930-85f7-1e28cce40f89",
          "model": "anthropic.claude-sonnet-4.5",
          "messages": [
            {
              "role": "system",
              "text": "Only generate geographical coordinates in the northern hemisphere"
            },
            {
              "role": "user",
              "text": "Generate a geographical coordinate"
            }
          ],
          "inference_config": {
            "output_format_schema": {
              "title": "Longitude and Latitude Values",
              "description": "A geographical coordinate.",
              "required": [
                "latitude",
                "longitude"
              ],
              "type": "object",
              "properties": {
                "latitude": {
                  "type": "number",
                  "minimum": -90,
                  "maximum": 90
                },
                "longitude": {
                  "type": "number",
                  "minimum": -180,
                  "maximum": 180
                }
              },
              "additionalProperties": false
            },
            "max_tokens": 1024,
            "temperature": 0.3
          },
          "tags": [
            "test"
          ]
        }
      },
      "RunResponse": {
        "type": "object",
        "required": [
          "job_id"
        ],
        "properties": {
          "job_id": {
            "description": "The id of the job that has been enqueued.",
            "type": "string",
            "format": "uuid"
          }
        },
        "example": {
          "job_id": "a81e1460-fbdc-4204-bd76-a9e496bf760d"
        }
      },
      "NQL": {
        "type": "string",
        "description": "A NQL query."
      },
      "DataPlaneId": {
        "type": "string",
        "format": "uuid",
        "description": "A dataplane represent where you would run the query. Your query get compiled\nto the SQL dialect that your data engine understands. If you leave it blank,\nyour query will target Narrative's dataplane on AWS using Apache Spark. We\ncurrently support Snowflake and we plan to support other dataplanes in the\nfuture. See https://next.narrative.io/products/narrative-anywhere for more\ndetails."
      },
      "Ast": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/AggFunction"
          },
          {
            "$ref": "#/components/schemas/AstList"
          },
          {
            "$ref": "#/components/schemas/As"
          },
          {
            "$ref": "#/components/schemas/BinaryOp"
          },
          {
            "$ref": "#/components/schemas/Case"
          },
          {
            "$ref": "#/components/schemas/CreateMaterializedView"
          },
          {
            "$ref": "#/components/schemas/Explain"
          },
          {
            "$ref": "#/components/schemas/Function"
          },
          {
            "$ref": "#/components/schemas/Lit"
          },
          {
            "$ref": "#/components/schemas/Ident"
          },
          {
            "$ref": "#/components/schemas/Join"
          },
          {
            "$ref": "#/components/schemas/Select"
          },
          {
            "$ref": "#/components/schemas/Op"
          },
          {
            "$ref": "#/components/schemas/TypeSpec"
          },
          {
            "$ref": "#/components/schemas/Window"
          },
          {
            "$ref": "#/components/schemas/Unknown"
          }
        ]
      },
      "AggFunction": {
        "title": "aggregate",
        "type": "object",
        "required": [
          "type",
          "nql",
          "args"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "agg_function"
          },
          "nql": {
            "type": "string"
          },
          "args": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "quantifier": {
            "type": "string",
            "enum": [
              "all",
              "distinct"
            ]
          }
        }
      },
      "AstList": {
        "title": "list",
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/Ast"
        }
      },
      "Nql": {
        "type": "string"
      },
      "As": {
        "title": "as",
        "type": "object",
        "required": [
          "type",
          "nql",
          "name",
          "value"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "as"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "name": {
            "type": "string"
          },
          "value": {
            "$ref": "#/components/schemas/Ast"
          }
        }
      },
      "BinaryOp": {
        "title": "binary operator",
        "type": "object",
        "required": [
          "type",
          "nql",
          "name",
          "left",
          "right"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "binary_op"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "name": {
            "type": "string"
          },
          "left": {
            "$ref": "#/components/schemas/Ast"
          },
          "right": {
            "$ref": "#/components/schemas/Ast"
          }
        }
      },
      "CaseArgWhen": {
        "type": "object",
        "required": [
          "type",
          "nql",
          "condition",
          "value"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "when"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "condition": {
            "$ref": "#/components/schemas/Ast"
          },
          "value": {
            "$ref": "#/components/schemas/Ast"
          }
        }
      },
      "CaseArgElse": {
        "type": "object",
        "required": [
          "type",
          "nql",
          "value"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "when"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "value": {
            "$ref": "#/components/schemas/Ast"
          }
        }
      },
      "CaseArg": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/CaseArgWhen"
          },
          {
            "$ref": "#/components/schemas/CaseArgElse"
          }
        ]
      },
      "Case": {
        "title": "case",
        "type": "object",
        "required": [
          "type",
          "nql",
          "args"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "case"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "args": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CaseArg"
            }
          }
        }
      },
      "Select": {
        "title": "select",
        "type": "object",
        "required": [
          "type",
          "nql",
          "columns",
          "group_by",
          "is_distinct",
          "order_by",
          "windows",
          "with"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "select"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "columns": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "from": {
            "$ref": "#/components/schemas/Ast"
          },
          "group_by": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "having": {
            "$ref": "#/components/schemas/Ast"
          },
          "isDistinct": {
            "type": "boolean"
          },
          "limit": {
            "$ref": "#/components/schemas/Ast"
          },
          "order_by": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "qualify": {
            "$ref": "#/components/schemas/Ast"
          },
          "where": {
            "$ref": "#/components/schemas/Ast"
          },
          "windows": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "with": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          }
        }
      },
      "CreateMaterializedView": {
        "title": "create materialized view",
        "type": "object",
        "required": [
          "type",
          "nql",
          "name",
          "select"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "create_materialized_view"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "name": {
            "type": "string"
          },
          "select": {
            "$ref": "#/components/schemas/Select"
          }
        }
      },
      "Explain": {
        "title": "explain",
        "type": "object",
        "required": [
          "type",
          "nql",
          "query"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "explain"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "query": {
            "$ref": "#/components/schemas/Ast"
          }
        }
      },
      "Function": {
        "title": "function",
        "type": "object",
        "required": [
          "type",
          "nql",
          "args",
          "name"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "function"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "args": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "name": {
            "type": "string"
          }
        }
      },
      "BinaryType": {
        "title": "binary",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "binary"
          },
          "format": {
            "type": "string",
            "enum": [
              "geometry"
            ]
          }
        }
      },
      "AstTypes_BooleanType": {
        "title": "boolean",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "boolean"
          }
        }
      },
      "AstTypes_DoubleType": {
        "title": "double",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "double"
          }
        }
      },
      "AstTypes_LongType": {
        "title": "long",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "boolean"
          }
        }
      },
      "AstTypes_IntervalType": {
        "title": "interval",
        "type": "object",
        "required": [
          "type",
          "period"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "interval"
          },
          "period": {
            "type": "string",
            "enum": [
              "day",
              "day_hour",
              "day_minute",
              "day_second",
              "hour",
              "hour_minute",
              "hour_second",
              "minute",
              "minute_second",
              "month",
              "second",
              "year",
              "year_month"
            ]
          }
        }
      },
      "SimpleType": {
        "title": "a simple type",
        "type": "object",
        "oneOf": [
          {
            "$ref": "#/components/schemas/BinaryType"
          },
          {
            "$ref": "#/components/schemas/AstTypes_BooleanType"
          },
          {
            "$ref": "#/components/schemas/AstTypes_DoubleType"
          },
          {
            "$ref": "#/components/schemas/AstTypes_LongType"
          },
          {
            "$ref": "#/components/schemas/AstTypes_IntervalType"
          },
          {
            "$ref": "#/components/schemas/AstTypes_ObjectType"
          },
          {
            "$ref": "#/components/schemas/OtherType"
          },
          {
            "$ref": "#/components/schemas/AstTypes_StringType"
          },
          {
            "$ref": "#/components/schemas/TimestampType"
          }
        ]
      },
      "AstTypes_ObjectType": {
        "title": "object",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "object"
          },
          "properties": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SimpleType"
            }
          }
        }
      },
      "OtherType": {
        "title": "other",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "other"
          }
        }
      },
      "AstTypes_StringType": {
        "title": "string",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "string"
          }
        }
      },
      "TimestampType": {
        "title": "timestamp",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "timestamp"
          }
        }
      },
      "Lit": {
        "title": "literal",
        "type": "object",
        "required": [
          "type",
          "nql",
          "value_type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "literal"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "value_type": {
            "$ref": "#/components/schemas/SimpleType"
          },
          "value": {
            "type": "string"
          }
        }
      },
      "IdentAmbiguous": {
        "title": "ambiguous",
        "type": "object",
        "required": [
          "parts"
        ],
        "properties": {
          "type": {
            "const": "ambiguous"
          },
          "parts": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "DatasetTable": {
        "title": "dataset",
        "type": "object",
        "required": [
          "id",
          "name"
        ],
        "properties": {
          "table_type": {
            "const": "dataset"
          },
          "id": {
            "$ref": "#/components/schemas/DatasetId"
          },
          "name": {
            "$ref": "#/components/schemas/DatasetName"
          }
        }
      },
      "AccessRulesTable": {
        "title": "access_rule",
        "type": "object",
        "required": [
          "id"
        ],
        "properties": {
          "table_type": {
            "const": "access_rule"
          },
          "id": {
            "$ref": "#/components/schemas/AccessRuleId"
          },
          "name": {
            "$ref": "#/components/schemas/AccessRuleName"
          }
        }
      },
      "MaterializedViewTable": {
        "title": "materialized_view",
        "type": "object",
        "required": [
          "id",
          "name"
        ],
        "properties": {
          "table_type": {
            "const": "materialized_view"
          },
          "id": {
            "$ref": "#/components/schemas/DatasetId"
          },
          "name": {
            "$ref": "#/components/schemas/DatasetName"
          }
        }
      },
      "RosettaStoneTable": {
        "title": "rosetta_stone",
        "type": "object",
        "properties": {
          "table_type": {
            "const": "rosetta_stone"
          }
        }
      },
      "ReferenceTable": {
        "title": "reference",
        "type": "object",
        "properties": {
          "table_type": {
            "const": "reference"
          }
        }
      },
      "ViewTable": {
        "title": "view",
        "type": "object",
        "required": [
          "id",
          "name"
        ],
        "properties": {
          "table_type": {
            "const": "view"
          },
          "id": {
            "$ref": "#/components/schemas/ViewId"
          },
          "name": {
            "$ref": "#/components/schemas/ViewName"
          }
        }
      },
      "TableMetadata": {
        "type": "object",
        "required": [
          "table_type"
        ],
        "properties": {
          "table_type": {
            "type": "string"
          }
        },
        "oneOf": [
          {
            "$ref": "#/components/schemas/DatasetTable"
          },
          {
            "$ref": "#/components/schemas/AccessRulesTable"
          },
          {
            "$ref": "#/components/schemas/MaterializedViewTable"
          },
          {
            "$ref": "#/components/schemas/RosettaStoneTable"
          },
          {
            "$ref": "#/components/schemas/ReferenceTable"
          },
          {
            "$ref": "#/components/schemas/ViewTable"
          }
        ]
      },
      "IdentTable": {
        "title": "table",
        "type": "object",
        "required": [
          "table",
          "metadata"
        ],
        "properties": {
          "type": {
            "const": "table"
          },
          "db": {
            "type": "string"
          },
          "schema": {
            "type": "string"
          },
          "table": {
            "type": "string"
          },
          "metadata": {
            "$ref": "#/components/schemas/TableMetadata"
          }
        }
      },
      "RegularColumn": {
        "title": "column",
        "type": "object",
        "properties": {
          "column_type": {
            "const": "column"
          }
        }
      },
      "AttributeColumn": {
        "title": "attribute",
        "type": "object",
        "required": [
          "id",
          "name"
        ],
        "properties": {
          "column_type": {
            "const": "attribute"
          },
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "ReferenceColumn": {
        "title": "reference",
        "type": "object",
        "properties": {
          "column_type": {
            "const": "reference"
          }
        }
      },
      "ColumnMetadata": {
        "type": "object",
        "required": [
          "column_type"
        ],
        "properties": {
          "column_type": {
            "type": "string"
          }
        },
        "oneOf": [
          {
            "$ref": "#/components/schemas/RegularColumn"
          },
          {
            "$ref": "#/components/schemas/AttributeColumn"
          },
          {
            "$ref": "#/components/schemas/ReferenceColumn"
          }
        ]
      },
      "IdentColumn": {
        "title": "column",
        "type": "object",
        "required": [
          "table",
          "column",
          "metadata"
        ],
        "properties": {
          "type": {
            "const": "column"
          },
          "db": {
            "type": "string"
          },
          "schema": {
            "type": "string"
          },
          "table": {
            "type": "string"
          },
          "column": {
            "type": "string"
          },
          "metadata": {
            "$ref": "#/components/schemas/ColumnMetadata"
          }
        }
      },
      "Ident": {
        "title": "identifier",
        "type": "object",
        "required": [
          "type",
          "nql"
        ],
        "properties": {
          "type": {
            "type": "string"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          }
        },
        "oneOf": [
          {
            "$ref": "#/components/schemas/IdentAmbiguous"
          },
          {
            "$ref": "#/components/schemas/IdentTable"
          },
          {
            "$ref": "#/components/schemas/IdentColumn"
          }
        ]
      },
      "Join": {
        "title": "join",
        "type": "object",
        "required": [
          "type",
          "condition_type",
          "left",
          "join_type",
          "right"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "join"
          },
          "condition": {
            "$ref": "#/components/schemas/Ast"
          },
          "condition_type": {
            "type": "string",
            "enum": [
              "none",
              "on",
              "using"
            ]
          },
          "left": {
            "$ref": "#/components/schemas/Ast"
          },
          "join_type": {
            "type": "string",
            "enum": [
              "as_of",
              "comma",
              "cross",
              "full",
              "inner",
              "left",
              "left_as_of",
              "left_anti",
              "left_semi",
              "right"
            ]
          },
          "right": {
            "$ref": "#/components/schemas/Ast"
          }
        }
      },
      "Op": {
        "title": "operator",
        "type": "object",
        "required": [
          "type",
          "nql",
          "args",
          "name"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "operator"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "args": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "name": {
            "type": "string"
          }
        }
      },
      "TypeSpec": {
        "title": "type specification",
        "type": "object",
        "required": [
          "type",
          "nql",
          "value"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "type_spec"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "value": {
            "type": "string"
          }
        }
      },
      "Window": {
        "title": "window",
        "type": "object",
        "required": [
          "type",
          "nql",
          "orderBy",
          "partitions"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "window"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          },
          "lower_bound": {
            "$ref": "#/components/schemas/Ast"
          },
          "name": {
            "$ref": "#/components/schemas/Ident"
          },
          "order_by": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "partitions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Ast"
            }
          },
          "upper_bound": {
            "$ref": "#/components/schemas/Ast"
          }
        }
      },
      "Unknown": {
        "title": "unknown",
        "type": "object",
        "required": [
          "type",
          "nql"
        ],
        "properties": {
          "type": {
            "type": "string",
            "const": "unknown"
          },
          "nql": {
            "$ref": "#/components/schemas/Nql"
          }
        }
      },
      "Response": {
        "type": "object",
        "required": [
          "title",
          "status",
          "details",
          "instance",
          "log_id"
        ],
        "properties": {
          "type": {
            "type": "string"
          },
          "title": {
            "type": "string",
            "description": "a summary of the error"
          },
          "status": {
            "type": "number",
            "description": "http status code"
          },
          "detail": {
            "type": "string",
            "description": "a longer description of the error"
          },
          "instance": {
            "type": "string",
            "description": "path of the query"
          },
          "log_id": {
            "type": "string",
            "format": "uuid",
            "description": "an internal logging id, Narrative can use to help debug a problem."
          }
        },
        "example": {
          "type": null,
          "title": "Failed to Parse Query",
          "status": 400,
          "detail": "Invalid query format.",
          "instance": "/nql/validate",
          "log_id": "c06fea02-0950-45c6-aaff-07ab07c0d04c",
          "debug": null
        }
      },
      "ForecastResult": {
        "type": "object",
        "properties": {
          "nql_type": {
            "type": "string",
            "const": "forecast"
          },
          "type": {
            "type": "string",
            "const": "success"
          },
          "rows": {
            "type": "integer"
          },
          "cost": {
            "description": "cost in micro cents USD",
            "type": "integer"
          }
        }
      },
      "RunResponseBase": {
        "type": "object",
        "required": [
          "id",
          "company_id",
          "completed_at",
          "created_at",
          "failures",
          "idempotency_key",
          "request_source",
          "state",
          "updated_at"
        ],
        "properties": {
          "id": {
            "$ref": "#/components/schemas/JobId"
          },
          "company_id": {
            "description": "Company that ran the job.",
            "type": "string",
            "format": "uuid"
          },
          "completed_at": {
            "description": "The timestamp representing when the job finished.",
            "type": "string",
            "format": "date-time"
          },
          "created_at": {
            "description": "The timestamp representing when the job was created.",
            "type": "string",
            "format": "date-time"
          },
          "failures": {
            "description": "causes of job failure",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Failure"
            }
          },
          "idempotency_key": {
            "description": "The unique ID associated with the job.",
            "type": "string"
          },
          "request_source": {
            "$ref": "#/components/schemas/RequestSource"
          },
          "result": {
            "$ref": "#/components/schemas/ForecastResult"
          },
          "state": {
            "$ref": "#/components/schemas/State"
          },
          "updated_at": {
            "description": "The timestamp representing when the job was updated.",
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ForecastInput": {
        "type": "object",
        "required": [
          "nql",
          "compiled_sql"
        ],
        "properties": {
          "nql": {
            "$ref": "#/components/schemas/NQL"
          },
          "compiled_sql": {
            "type": "string"
          }
        }
      },
      "ForecastRunResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/RunResponseBase"
          },
          {
            "type": "object",
            "required": [
              "input"
            ],
            "properties": {
              "input": {
                "description": "The query and it's compiled sql sent to the executor.",
                "$ref": "#/components/schemas/ForecastInput"
              }
            }
          }
        ]
      },
      "CreateMaterialiedViewRunResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/RunResponseBase"
          },
          {
            "type": "object",
            "required": [
              "input"
            ],
            "properties": {
              "input": {
                "description": "The dataset we are creating.",
                "$ref": "#/components/schemas/DatasetResponse"
              }
            }
          }
        ]
      },
      "NQL_RunResponse": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/ForecastRunResponse"
          },
          {
            "$ref": "#/components/schemas/CreateMaterialiedViewRunResponse"
          }
        ]
      },
      "BucketPolicyAccess": {
        "type": "object",
        "required": [
          "account_id"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Providing access for the root user of specified account_id.",
            "enum": [
              "bucket_policy"
            ]
          },
          "account_id": {
            "type": "string",
            "description": "Your company's 12 digit AWS account ID. Root user of that account will be granted to reach the bucket.",
            "example": 12345678901
          }
        }
      },
      "RoleAccess": {
        "type": "object",
        "required": [
          "account_id",
          "resource_id"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Authenticate using an AWS IAM role.",
            "enum": [
              "role"
            ]
          },
          "account_id": {
            "type": "string",
            "description": "Applicable authentication types: `role`\n\nYour company's 12 digit AWS account ID.",
            "example": 12345678901
          },
          "external_id": {
            "type": "string",
            "description": "Applicable authentication types: `role`\n\nAn optional external identifier that, if specified, must be provided when assuming the bucket access role.\n\nAn external identifier will only be associated with the role if one was provided at bucket creation.\n\n[Learn more](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html?icmpid=docs_iam_console)."
          },
          "role": {
            "type": "string",
            "description": "Applicable authentication types: `role`\n\nThe ARN of the role to assume to perform bucket management operations.",
            "example": "arn:aws:iam::704349335716:role/nio-yourcompany-821627dd2931-access"
          }
        }
      },
      "CompanyBucketAuth": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/BucketPolicyAccess"
          },
          {
            "$ref": "#/components/schemas/RoleAccess"
          }
        ]
      },
      "CompanyBucketResponse": {
        "description": "An AWS S3 bucket created inside Narrative's AWS account assigned to a specific company.",
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the bucket.",
            "example": "4d5451ff-5fe6-4db3-9398-4075bbd275b0"
          },
          "auth": {
            "$ref": "#/components/schemas/CompanyBucketAuth"
          },
          "company_id": {
            "type": "integer",
            "description": "The ID of the company owning the bucket."
          },
          "name": {
            "type": "string",
            "description": "The AWS S3 bucket name. The bucket name is of the form `nio-${resource_id}-${suffix}` where `resouce_id` is the resource ID provided at bucket creation and `suffix` is 12 randomly chosen alphanumeric characters.\n\nA random suffix is appended to the bucket name for two reasons:\n- AWS S3 bucket names must be globally unique, i.e. the bucket namespace is shared by all AWS accounts.\n  Appending a random suffix helps ensure that we can create a bucket which includes your preferred resource\n  ID.\n- Another consequence of AWS S3 bucket names needing to be globally unique is that anyone can easily check if\n  a bucket with a given name exists. By appending a random suffix to your bucket we are preventing information\n  leakage by making it impractical for an attacker to determine whether you are a customer of Narrative by\n  simply guessing your resource ID and checking whether a bucket with the name `nio-${resource_id}` exists.",
            "example": "nio-yourcompanyname-50ac58dabfa1"
          },
          "created_at": {
            "type": "string",
            "description": "ISO-8601 timestamp indicating when the bucket was created.",
            "example": "2021-08-26T21:06:07.710357Z"
          },
          "updated_at": {
            "type": "string",
            "description": "ISO-8601 timestamp indicating when the bucket was last updated.",
            "example": "2021-08-26T21:06:07.710357Z"
          },
          "is_access_mutable": {
            "type": "boolean",
            "description": "Is it allowed to change access type. Changes are allowed by default. Restrictions could be applied in case bucket was manually config"
          }
        },
        "example": {
          "id": "45b40bf5-02fc-4f18-bfcd-50ac58dabfa1",
          "company_id": 1,
          "auth": {
            "type": "bucket_policy",
            "account_id": "123456789012"
          },
          "name": "nio-yourcompany-821627dd2931",
          "created_at": "2021-08-31T20:22:02Z",
          "updated_at": "2021-08-31T20:22:02Z"
        }
      },
      "CompanyBucketsResponse": {
        "type": "object",
        "description": "An AWS S3 bucket created inside Narrative's AWS account assigned to a specific company.",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CompanyBucketResponse"
            }
          }
        }
      },
      "CompanyBucketRequest": {
        "type": "object",
        "properties": {
          "account_id": {
            "type": "string",
            "description": "Your 12 digit AWS account ID. That ID will be used:\n - to enable root-based access in case of \"bucket_policy\" access type;\n - to create (or use existing) IAM Role that will be available for specified user.",
            "example": 12345678901
          },
          "resource_id": {
            "type": "string",
            "description": "A short identifier that will be a part of your bucket's name.\n\nA typical choice would be your company's name, lowercased and spaces replaced with `-`.\n\nResource IDs must:\n- consist of only **lowercase** alphanumeric characters or `-`\n- be at least 2 and less than 43 characters long",
            "example": "yourcompany"
          },
          "access": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "description": "Access using:\n  - bucket policy that shares access to the root of AWS account\n  - an AWS IAM role",
                "enum": [
                  "bucket_policy",
                  "role"
                ]
              },
              "external_id": {
                "type": "string",
                "description": "Warning! External ID is used only(!) for \"role\" type of access.\n\nYou can optionally increase the security of your role by requiring an external identifier which prevents \"confused deputy\" attacks.\n\nIf specified, users in your AWS account will have to provide the external identifier when assuming the bucket access role Narrative creates for you to manage your bucket.\n\n[Learn more](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html?icmpid=docs_iam_console).\n\nExternal IDs must:\n- consist of any of the following characters: alphanumeric characters, `=`, `,`, `.`, `@`, `:`, `/`, `-`, `_`\n- be at least 2 and less than 1224 characters long",
                "example": null
              }
            },
            "example": {
              "type": "role",
              "external_id": "22a7553b-9240-4b81-93ae-54ccbcde0a8"
            }
          }
        },
        "required": [
          "account_id",
          "resource_id"
        ]
      },
      "BucketPolicyAccessTypeRequest": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "description": "Access using bucket policy that shares access to the root of AWS account",
            "enum": [
              "bucket_policy"
            ]
          }
        },
        "example": {
          "type": "bucket_policy"
        },
        "required": [
          "type"
        ]
      },
      "RoleAccessTypeRequest": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "description": "Access using an AWS IAM role",
            "enum": [
              "role"
            ]
          },
          "external_id": {
            "type": "string",
            "description": "You can optionally increase the security of your role by requiring an external identifier which prevents \"confused deputy\" attacks.\n\nIf specified, users in your AWS account will have to provide the external identifier when assuming the bucket access role Narrative creates for you to manage your bucket.\n\n[Learn more](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html?icmpid=docs_iam_console).\n\nExternal IDs must:\n- consist of any of the following characters: alphanumeric characters, `=`, `,`, `.`, `@`, `:`, `/`, `-`, `_`\n- be at least 2 and less than 1224 characters long",
            "example": null
          }
        },
        "example": {
          "type": "role",
          "external_id": "22a7553b-9240-4b81-93ae-54ccbcde0a8"
        },
        "required": [
          "type"
        ]
      },
      "UpdateBucketAccessTypeRequest": {
        "type": "object",
        "properties": {
          "bucket_name": {
            "type": "string",
            "description": "Full name of the bucket that should be affected.",
            "example": "nio-yourcompany-iwhhrql8sgvp"
          },
          "new_access": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/BucketPolicyAccessTypeRequest"
              },
              {
                "$ref": "#/components/schemas/RoleAccessTypeRequest"
              }
            ]
          }
        },
        "required": [
          "account_id",
          "resource_id"
        ]
      },
      "SchemaPresetId": {
        "type": "integer",
        "format": "int64",
        "description": "Unique identifier of an existing schema preset.",
        "example": 7
      },
      "schemapreset_CompanyId": {
        "type": "integer",
        "format": "int",
        "description": "The id of an existing company"
      },
      "AttributeId": {
        "type": "integer",
        "format": "int",
        "description": "Unique identifier for an attribute."
      },
      "AttributeField": {
        "type": "object",
        "required": [
          "field",
          "delivered",
          "filterable",
          "required",
          "forecastable"
        ],
        "properties": {
          "field": {
            "type": "string",
            "description": "Name of the field."
          },
          "delivered": {
            "type": "boolean",
            "description": "When true, this field will be delivered to the buyer."
          },
          "filterable": {
            "type": "boolean",
            "description": "Whether or not the buyer can filter the data on this field"
          },
          "required": {
            "type": "boolean",
            "description": "Whether or not this field is mandatory. `Must be true` if this field is set to be `filterable`."
          },
          "forecastable": {
            "type": "boolean",
            "description": "When true, forecasting will be run on this field."
          }
        }
      },
      "Attribute": {
        "type": "object",
        "required": [
          "attribute_id",
          "fields"
        ],
        "properties": {
          "attribute_id": {
            "$ref": "#/components/schemas/AttributeId"
          },
          "fields": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AttributeField"
            }
          }
        }
      },
      "schemapreset_Details": {
        "type": "object",
        "required": [
          "attributes"
        ],
        "properties": {
          "attributes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Attribute"
            }
          }
        }
      },
      "SchemaPreset": {
        "type": "object",
        "required": [
          "id",
          "company_id",
          "created_at",
          "name",
          "scope",
          "status",
          "tags"
        ],
        "properties": {
          "id": {
            "$ref": "#/components/schemas/SchemaPresetId"
          },
          "company_id": {
            "$ref": "#/components/schemas/schemapreset_CompanyId"
          },
          "created_at": {
            "type": "string",
            "description": "UTC ISO date time when the schema preset was created"
          },
          "archived_at": {
            "type": "string",
            "description": "UTC ISO date time when the schema preset was archived"
          },
          "name": {
            "type": "string",
            "description": "Name of the schema preset"
          },
          "description": {
            "type": "string",
            "description": "Long description for the schema preset"
          },
          "scope": {
            "type": "string",
            "description": "Who can see this schema preset. Either `public` for everyone or `private` for only the members of the company who owns it.",
            "enum": [
              "public",
              "private"
            ]
          },
          "based_on_preset_id": {
            "$ref": "#/components/schemas/SchemaPresetId"
          },
          "status": {
            "type": "string",
            "description": "Whether the schema preset is visible (`active`) or not (`archived`)",
            "enum": [
              "active",
              "archived"
            ]
          },
          "icon": {
            "type": "string",
            "description": "URL of an icon shown with the schema preset in the UI to help recognize/personalize it."
          },
          "display_color": {
            "type": "string",
            "description": "Background color to be shown in the UI to personalize the schema preset, in `hex color code` format."
          },
          "banner_image": {
            "type": "string",
            "description": "URL of the banner image shown in the UI to personalize the schema preset."
          },
          "tags": {
            "type": "array",
            "description": "An array (can be empty) of strings representing metadata about the schema preset",
            "items": {
              "type": "string"
            }
          },
          "details": {
            "type": "object",
            "$ref": "#/components/schemas/schemapreset_Details"
          }
        }
      },
      "SchemaPresetResponse": {
        "type": "object",
        "required": [
          "records"
        ],
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SchemaPreset"
            }
          }
        },
        "example": {
          "records": [
            {
              "id": 19,
              "company_id": 1,
              "created_at": "2021-09-29T15:20:56.44361",
              "archived_at": null,
              "name": "Age",
              "description": "A person's age gathered from registrations and surveys.",
              "scope": "public",
              "based_on_preset_id": null,
              "status": "active",
              "icon": "http://icon.com/age.png",
              "display_color": "#FFFFFF",
              "banner_image": "http://banner.com/age.png",
              "tags": [
                "age"
              ],
              "details": {
                "attributes": [
                  {
                    "attribute_id": 1,
                    "fields": [
                      {
                        "field": "age",
                        "delivered": true,
                        "filterable": true,
                        "required": true,
                        "forecastable": false
                      }
                    ]
                  }
                ]
              }
            }
          ]
        }
      },
      "schemapreset_Error": {
        "type": "object",
        "properties": {
          "error": {
            "description": "error code of the error",
            "type": "string"
          },
          "error_description": {
            "description": "human friendly error text",
            "type": "string"
          }
        },
        "required": [
          "error",
          "error_description"
        ]
      },
      "SchemaPresetRequest": {
        "type": "object",
        "required": [
          "name",
          "tags",
          "details"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the schema preset"
          },
          "description": {
            "type": "string",
            "description": "Long description for the schema preset"
          },
          "based_on_preset_id": {
            "$ref": "#/components/schemas/SchemaPresetId"
          },
          "icon": {
            "type": "string",
            "description": "URL of an icon shown with the schema preset in the UI to help recognize/personalize it."
          },
          "display_color": {
            "type": "string",
            "description": "Background color to be shown in the UI to personalize the schema preset, in `hex color code` format."
          },
          "banner_image": {
            "type": "string",
            "description": "URL of the banner image shown in the UI to personalize the schema preset."
          },
          "tags": {
            "type": "array",
            "description": "An array (can be empty) of strings representing metadata about the schema preset",
            "items": {
              "type": "string"
            }
          },
          "details": {
            "type": "object",
            "$ref": "#/components/schemas/schemapreset_Details"
          }
        }
      },
      "UpdateSlugRequest": {
        "type": "object",
        "properties": {
          "slug": {
            "type": "string"
          }
        }
      },
      "UpdateSlugResponse": {
        "type": "object",
        "properties": {
          "app_id": {
            "type": "number"
          },
          "slug": {
            "type": "string"
          }
        }
      },
      "UploadUrl": {
        "type": "object",
        "properties": {
          "path": {
            "type": "string",
            "description": "The path where the file will be uploaded to",
            "example": "/lists/idlist.csv"
          },
          "url": {
            "type": "string",
            "description": "The upload url to be called to actually do the file upload",
            "example": "https://narrative-file-upload-dev.s3.amazonaws.com/companyId%3D1/my-list.csv?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEOf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJGMEQCIB9EYPohJtbK0vb0LUjfcDrYqZ2tiAHfXb5xMcsRFFL7AiAlwUx2GBk3OOUTGWm6ZXZyOdpqugz77%2BT3JhoX3qY3HCrbAQjA%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F8BEAIaDDcwNDM0OTMzNTcxNiIM5AqrwaG45z1X6auTKq8BlknYqJBV04Ss%2BsI61g1OlKX0VuAMIvcmDdUcvz5RyjAwuzxqUDy4f84GOFoqkkyjpWTTdvgfrXDmXVTHkskocn0HqYeUpaWTfI72HySnKPx%2B%2FPoINQG%2FgbD%2Bl2Ds%2FspvpAsDs6fFa9NjLHIcntjrxQ62zr1%2Bb0eAfEAcyTxXhHzAna1%2B5GZ8lxcQlFTdFwTg2iDhXbDJ3lM04ws%2BuLqSGpRnkdP0p3iz9cDbscfH0DDb0quABjrhAQFZ90e7%2FxqPpIPD2j7ai8VRvwn3F8l7VOlSmDvnmjcGiMYZiAvbrHFcRVJa5YMdvGlFSCjCAeGIe7G47R%2Ftpqk27ckcYLfJCEsb38I%2F7TA6bq39S4oKQfaO%2FHubPcHaOZgatrS%2BhH4%2BzjJT87nY06SWJiV8sfZR3Vmqrfg9%2F9gjshRkTHwsGGhhyYYpQ6LdzO00nMXzusaPKWucZ7rBN5hWG2PgtNWObkCwq1OCANmGQYHJyi%2FOZDr2Gr1sRCU%2FUm%2FsmTYpGVPjDJgz3tibv8iPiXa%2FrZpd4hbT%2BocYwFdDYQ%3D%3D&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20210122T151716Z&X-Amz-SignedHeaders=host&X-Amz-Expires=1799&X-Amz-Credential=ASIA2H7T56CSK7QLIP6S%2F20210122%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=3c1e45b6d8827b7158a6157dbc548fdf263c2f23f731117056058f489b26c64b"
          },
          "expiry": {
            "type": "string",
            "description": "The expiry time after which the upload won't be accepted",
            "example": "2021-01-22T15:47:16.036Z"
          }
        }
      },
      "Usage_CompanyId": {
        "type": "integer",
        "description": "The ID of the company to which the usage will be applied.",
        "example": 1
      },
      "CreatedBy": {
        "type": "integer",
        "description": "Optional. The ID of the user that triggered the usage event.",
        "example": 2
      },
      "Dimensions": {
        "type": "object",
        "additionalProperties": {
          "type": "string"
        },
        "description": "An arbitrary collection of key-value pairs that can be used to categorize or tag the event.\n\nThese key-values become aggregable dimensions in usage reports.",
        "example": {
          "dataset_id": "123"
        }
      },
      "EventTimestamp": {
        "type": "string",
        "format": "date-time",
        "description": "ISO-8601 timestamp indicating when the usage event occurred. Cannot be more than 72 hours in the past.",
        "example": "2022-11-10T00:00:00Z"
      },
      "Usage_EventType": {
        "type": "string",
        "description": "The type of usage event. `event_type` works alongside dimensions and measures to describe the details of the\nevent.",
        "example": "processing-dataset-ingestion"
      },
      "Usage_IdempotencyKey": {
        "type": "string",
        "format": "uuid",
        "description": "A UUID that ensures the usage event is processed and stored only once, even if the event is sent multiple times.\n\nThis unique identifier helps to prevent duplicate usage events from being recorded and allows for reliable\nprocessing and storage of the event. If a usage event with a previously used idempotency_key is received, the\noriginal stored event is returned instead of creating a new event.",
        "example": "882e0a91-10a2-47c7-8e70-69344d725a6f"
      },
      "Measures": {
        "type": "object",
        "additionalProperties": {
          "type": "number"
        },
        "description": "A set of additional numerical values associated with the usage event that are beyond what is captured in the\nusage field. These values may be used for reporting purposes and can provide additional context about the event.",
        "example": {
          "rows": 8212837
        }
      },
      "Sku": {
        "type": "string",
        "description": "Unique identifier for the product for .",
        "example": "general-purpose-processing-aws-us-east-1"
      },
      "Usage": {
        "type": "object",
        "description": "The amount of the product referred to by the `sku` that is being used, expressed as a numerical value and\ncorresponding unit of measure.\n\nThe unit field must match the unit of measure for the product, and the value field indicates the amount of the\nproduct used in terms of the given unit.",
        "properties": {
          "unit": {
            "type": "string",
            "example": "gigabytes"
          },
          "value": {
            "type": "number",
            "format": "double",
            "example": 181.281
          }
        },
        "required": [
          "unit",
          "value"
        ]
      },
      "CreateUsageRequest": {
        "type": "object",
        "properties": {
          "company_id": {
            "$ref": "#/components/schemas/Usage_CompanyId"
          },
          "created_by": {
            "$ref": "#/components/schemas/CreatedBy"
          },
          "dimensions": {
            "$ref": "#/components/schemas/Dimensions"
          },
          "event_timestamp": {
            "$ref": "#/components/schemas/EventTimestamp"
          },
          "event_type": {
            "$ref": "#/components/schemas/Usage_EventType"
          },
          "idempotency_key": {
            "$ref": "#/components/schemas/Usage_IdempotencyKey"
          },
          "measures": {
            "$ref": "#/components/schemas/Measures"
          },
          "sku": {
            "$ref": "#/components/schemas/Sku"
          },
          "usage": {
            "$ref": "#/components/schemas/Usage"
          }
        },
        "required": [
          "company_id",
          "dimensions",
          "event_timestamp",
          "event_type",
          "idempotency_key",
          "sku",
          "usage"
        ]
      },
      "CreateUsageResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the usage event.",
            "example": "fe0212f6-3440-44e6-b049-ef6c5ad1f396"
          },
          "app_id": {
            "type": "integer",
            "description": "The id of the application that created the usage event.",
            "example": 5
          },
          "company_id": {
            "$ref": "#/components/schemas/Usage_CompanyId"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "ISO-8601 timestamp indicating when the usage event was persisted.",
            "example": "2022-11-10T00:00:00Z"
          },
          "created_by": {
            "$ref": "#/components/schemas/CreatedBy"
          },
          "dimensions": {
            "$ref": "#/components/schemas/Dimensions"
          },
          "event_timestamp": {
            "$ref": "#/components/schemas/EventTimestamp"
          },
          "event_type": {
            "$ref": "#/components/schemas/Usage_EventType"
          },
          "idempotency_key": {
            "$ref": "#/components/schemas/Usage_IdempotencyKey"
          },
          "measures": {
            "$ref": "#/components/schemas/Measures"
          },
          "sku": {
            "$ref": "#/components/schemas/Sku"
          },
          "usage": {
            "$ref": "#/components/schemas/Usage"
          }
        },
        "required": [
          "id",
          "app_id",
          "company_id",
          "created_at",
          "dimensions",
          "event_timestamp",
          "event_type",
          "idempotency_key",
          "sku",
          "usage"
        ]
      },
      "DestinationRequest": {
        "type": "object",
        "properties": {
          "subscription_id": {
            "$ref": "#/components/schemas/UUID"
          },
          "profile_id": {
            "$ref": "#/components/schemas/UUID"
          },
          "quick_settings": {
            "type": "object"
          }
        },
        "example": {
          "subscription_id": "21691f26-f308-4e98-896c-579db27da04b",
          "profile_id": "d13867f7-a6c0-4f83-b129-f6c6f2de7c15",
          "quick_settings": {
            "bucket_suffix": "/my-subscription",
            "number_of_files": "5"
          }
        }
      },
      "QuickSettings": {
        "type": "object",
        "example": {
          "bucket_suffix": "/my-subscription",
          "number_of_files": "5"
        }
      },
      "Destination": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/UUID"
          },
          "subscription_id": {
            "$ref": "#/components/schemas/UUID"
          },
          "profile_id": {
            "$ref": "#/components/schemas/UUID"
          },
          "quick_settings": {
            "$ref": "#/components/schemas/QuickSettings"
          }
        },
        "example": {
          "id": "8aaa069b-cc15-486f-9cdc-c56c3d831508",
          "subscription_id": "21691f26-f308-4e98-896c-579db27da04b",
          "profile_id": "d13867f7-a6c0-4f83-b129-f6c6f2de7c15",
          "quick_settings": {
            "bucket_suffix": "/my-subscription",
            "number_of_files": "5"
          }
        }
      },
      "PaginatedDestinations": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Destination"
            }
          }
        }
      },
      "Command": {
        "type": "object",
        "properties": {
          "metadata": {
            "type": "object",
            "properties": {
              "revision": {
                "type": "number"
              },
              "timestamp": {
                "type": "string",
                "format": "date-time"
              }
            }
          },
          "payload_type": {
            "type": "string",
            "enum": [
              "PerformDelivery"
            ]
          },
          "payload": {
            "type": "object",
            "properties": {
              "subscriptionId": {
                "type": "string",
                "format": "uuid"
              },
              "transactionBatchId": {
                "type": "string",
                "format": "uuid"
              },
              "profileId": {
                "type": "string",
                "format": "uuid"
              },
              "quickSettings": {
                "$ref": "#/components/schemas/QuickSettings"
              }
            }
          }
        },
        "example": {
          "metadata": {
            "revision": 42,
            "timestamp": "2021-11-23T20:37:32.452Z"
          },
          "payload_type": "PerformDelivery",
          "payload": {
            "subscriptionId": "0889d6d0-d31b-4196-b2fd-66e219f2e5e4",
            "transactionBatchId": "4202d94d-41eb-4e45-9468-fd75d47804ac",
            "profileId": "d13867f7-a6c0-4f83-b129-f6c6f2de7c15",
            "quickSettings": {
              "bucketprefix": "/mydelivery"
            }
          }
        }
      },
      "PaginatedCommands": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Command"
            }
          }
        }
      },
      "DeliveryFiles": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "company_id": {
              "type": "integer"
            },
            "file": {
              "type": "string"
            },
            "size": {
              "type": "integer",
              "description": "File size in bytes"
            },
            "subscription_id": {
              "type": "string",
              "format": "uuid"
            },
            "transaction_batch_id": {
              "type": "string",
              "format": "uuid"
            },
            "timestamp": {
              "type": "string",
              "description": "ISO-8601 timestamp indicating when the file was created"
            }
          }
        },
        "example": [
          {
            "company_id": 1,
            "file": "part-00001-cefc489b-7d3b-4409-8632-19122002bbd3-c000.json",
            "size": 8022466827,
            "subscription_id": "31ebdb17-6799-4447-a99c-6e3aa8da3237",
            "transaction_batch_id": "f6eeafa3-d599-4469-825c-bf0da93f68af",
            "timestamp": "2022-04-20T23:37:39Z"
          },
          {
            "company_id": 1,
            "file": "part-00002-cefc489b-7d3b-4409-8632-19122002bbd3-c000.json",
            "size": 8022349030,
            "subscription_id": "31ebdb17-6799-4447-a99c-6e3aa8da3237",
            "transaction_batch_id": "f6eeafa3-d599-4469-825c-bf0da93f68af",
            "timestamp": "2022-04-20T23:36:52Z"
          }
        ]
      },
      "UploadImageUrlRequest": {
        "type": "object",
        "description": "Name of the image that you want to upload.",
        "properties": {
          "image_name": {
            "type": "string",
            "example": "logo.png"
          }
        }
      },
      "UploadImageUrlResponse": {
        "type": "object",
        "description": "Presigned AWS URL, permanent URL and expiration.",
        "properties": {
          "upload_url": {
            "type": "string",
            "example": "https://fake-test-cdn.s3.amazonaws.com/images/company-logos/local/companyId_1__56ff5f47-7660-4c0c-807e-af2c8a3e666b_logo.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20221206T163031Z&X-Amz-SignedHeaders=host"
          },
          "permanent_url": {
            "type": "string",
            "example": "https://fake-test-cdn.s3.amazonaws.com/images/company-logos/local/companyId_1__56ff5f47-7660-4c0c-807e-af2c8a3e666b_logo.png"
          },
          "expiry": {
            "type": "string",
            "example": "2022-12-06T17:00:31.098Z"
          },
          "content_type": {
            "type": "string",
            "example": "image/png"
          }
        }
      },
      "Product_UUID": {
        "description": "UUID",
        "type": "string",
        "format": "uuid"
      },
      "SkuType": {
        "description": "Sku Type (json object, category filed is mandatory)",
        "type": "object",
        "required": [
          "category"
        ],
        "properties": {
          "category": {
            "type": "string",
            "enum": [
              "processing",
              "storage",
              "transfer",
              "marketplace-data-transaction"
            ]
          }
        }
      },
      "CloudPlatform": {
        "description": "Cloud Platform (json object)",
        "type": "object",
        "properties": {
          "region": {
            "type": "string"
          },
          "platform": {
            "type": "string"
          }
        }
      },
      "UnitPrice": {
        "type": "object",
        "required": [
          "value",
          "expressed_in"
        ],
        "properties": {
          "value": {
            "type": "number",
            "format": "double"
          },
          "expressed_in": {
            "type": "string",
            "example": "cents"
          },
          "currency": {
            "type": "string",
            "example": "USD"
          }
        }
      },
      "Rate": {
        "description": "Product rate",
        "type": "object",
        "required": [
          "type",
          "unit_price"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "per_unit",
              "percent_of_gmv"
            ]
          },
          "unit_price": {
            "$ref": "#/components/schemas/UnitPrice"
          }
        }
      },
      "ProductStatus": {
        "type": "string",
        "enum": [
          "active",
          "archived"
        ]
      },
      "ProductResponse": {
        "type": "object",
        "required": [
          "id",
          "sku",
          "sku_type",
          "payable_company_id",
          "name",
          "unit",
          "default_rate",
          "status",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "id": {
            "$ref": "#/components/schemas/Product_UUID"
          },
          "sku": {
            "type": "string",
            "description": "SKU for product"
          },
          "sku_type": {
            "$ref": "#/components/schemas/SkuType"
          },
          "payable_company_id": {
            "type": "number",
            "description": "Payable company id"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "cloud_platform": {
            "$ref": "#/components/schemas/CloudPlatform"
          },
          "unit": {
            "type": "string"
          },
          "default_rate": {
            "$ref": "#/components/schemas/Rate"
          },
          "status": {
            "$ref": "#/components/schemas/ProductStatus"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "created_by_user_id": {
            "type": "number",
            "example": 123
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "updated_by_user_id": {
            "type": "number",
            "example": 123
          }
        },
        "example": {
          "id": "cd98bbb6-1086-4aea-9b5f-8ba39671a659",
          "sku": "general-storage",
          "sku_type": {
            "category": "storage"
          },
          "payable_company_id": 1,
          "name": "name",
          "cloud_platform": {
            "region": "us-east-1",
            "platform": "aws"
          },
          "unit": "bytes",
          "default_rate": {
            "type": "per_unit",
            "unit_price": {
              "value": 1,
              "expressed_in": "cents",
              "currency": "USD"
            }
          },
          "status": "active",
          "created_at": "2023-02-13T12:55:24.104Z",
          "created_by_user_id": 1,
          "updated_at": "2023-02-13T12:55:24.104Z",
          "updated_by_user_id": 1
        }
      },
      "ProductsResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProductResponse"
            }
          }
        }
      },
      "CreateProductRequest": {
        "type": "object",
        "required": [
          "sku",
          "sku_type",
          "payable_company_id",
          "name",
          "unit",
          "default_rate",
          "status"
        ],
        "properties": {
          "sku": {
            "type": "string",
            "description": "SKU for product"
          },
          "sku_type": {
            "$ref": "#/components/schemas/SkuType"
          },
          "payable_company_id": {
            "type": "number",
            "description": "Payable company id"
          },
          "name": {
            "type": "string",
            "description": "Product name"
          },
          "description": {
            "type": "string",
            "description": "Optional description of a product"
          },
          "cloud_platform": {
            "$ref": "#/components/schemas/CloudPlatform"
          },
          "unit": {
            "type": "string"
          },
          "default_rate": {
            "$ref": "#/components/schemas/Rate"
          },
          "status": {
            "$ref": "#/components/schemas/ProductStatus"
          }
        },
        "example": {
          "sku": "general-storage",
          "sku_type": {
            "category": "storage"
          },
          "payable_company_id": 1,
          "name": "name",
          "cloud_platform": {
            "platform": "aws",
            "region": "us-east-1"
          },
          "unit": "bytes",
          "default_rate": {
            "type": "per_unit",
            "unit_price": {
              "type": "test-price",
              "currency": "USD",
              "price_in_micro_cents": 1
            }
          },
          "status": "active"
        }
      },
      "UpdateProductRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Product name"
          },
          "description": {
            "type": "string",
            "description": "Optional description of a product"
          },
          "cloud_platform": {
            "$ref": "#/components/schemas/CloudPlatform"
          },
          "default_rate": {
            "$ref": "#/components/schemas/Rate"
          },
          "status": {
            "$ref": "#/components/schemas/ProductStatus"
          },
          "unit": {
            "type": "string"
          }
        }
      },
      "CreateProductPermissionRequest": {
        "type": "object",
        "required": [
          "product_id",
          "permission_id"
        ],
        "properties": {
          "product_id": {
            "$ref": "#/components/schemas/Product_UUID"
          },
          "permission_id": {
            "$ref": "#/components/schemas/Product_UUID"
          }
        }
      },
      "CreatePermissionRequest": {
        "type": "object",
        "required": [
          "resource",
          "status",
          "verb"
        ],
        "properties": {
          "resource": {
            "description": "Resource type associated with a permissions",
            "type": "string"
          },
          "status": {
            "description": "Status of a permission",
            "type": "object",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "active",
                  "archived",
                  "pending"
                ]
              }
            }
          },
          "verb": {
            "description": "Verb (action) associated with a permissions",
            "type": "object",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "admin",
                  "read",
                  "write",
                  "create",
                  "revise"
                ]
              }
            }
          }
        },
        "example": {
          "resource": "test_resource",
          "status": {
            "type": "active"
          },
          "verb": {
            "type": "admin"
          }
        }
      },
      "Contract_UUID": {
        "description": "UUID",
        "type": "string",
        "format": "uuid"
      },
      "PaymentMethod": {
        "description": "Payment Method",
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "credit_card",
              "invoice"
            ]
          }
        }
      },
      "ContractResponse": {
        "type": "object",
        "required": [
          "id",
          "payable_company_id",
          "payment_method",
          "revision",
          "revision_start",
          "updated_by",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "id": {
            "$ref": "#/components/schemas/Contract_UUID"
          },
          "payable_company_id": {
            "type": "number",
            "description": "CompanyId"
          },
          "payment_method": {
            "$ref": "#/components/schemas/PaymentMethod"
          },
          "internal_notes": {
            "type": "string",
            "description": "Optional internal notes"
          },
          "revision": {
            "type": "number",
            "description": "Contract revision"
          },
          "revision_notes": {
            "type": "string",
            "description": "Optional revision description"
          },
          "revision_start": {
            "type": "string",
            "format": "date-time",
            "description": "Start date of a contract."
          },
          "revision_end": {
            "type": "string",
            "format": "date-time",
            "description": "End date of a contract."
          },
          "updated_by": {
            "type": "number",
            "description": "User that updated contract"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When contract is created"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When contract is updated"
          }
        }
      },
      "ProductView": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/components/schemas/Contract_UUID"
          },
          "sku": {
            "type": "string",
            "description": "SKU for product"
          },
          "sku_type": {
            "$ref": "#/components/schemas/SkuType"
          },
          "payable_company_id": {
            "type": "number",
            "description": "Payable company id"
          },
          "name": {
            "type": "string",
            "description": "Product name"
          },
          "unit": {
            "type": "string"
          },
          "status": {
            "$ref": "#/components/schemas/ProductStatus"
          }
        }
      },
      "ContractRateView": {
        "type": "object",
        "properties": {
          "rate": {
            "$ref": "#/components/schemas/Rate"
          },
          "product": {
            "$ref": "#/components/schemas/ProductView"
          },
          "start_at": {
            "type": "string",
            "format": "date-time",
            "description": "Start date of a contract rate."
          },
          "end_at": {
            "type": "string",
            "format": "date-time",
            "description": "End date of a contract rate."
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When contract rate is created"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When contract rate is updated"
          }
        }
      },
      "ContractDetails": {
        "type": "object",
        "properties": {
          "contract": {
            "$ref": "#/components/schemas/ContractResponse"
          },
          "rates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ContractRateView"
            }
          }
        }
      },
      "ContractDetailsResponse": {
        "type": "object",
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ContractDetails"
            }
          }
        }
      },
      "ContractRateRequest": {
        "type": "object",
        "properties": {
          "product_id": {
            "description": "Optional field",
            "$ref": "#/components/schemas/Product_UUID"
          },
          "sku": {
            "description": "Optional field to uniquely identify product",
            "type": "string"
          },
          "end": {
            "type": "string",
            "format": "date-time"
          },
          "rate": {
            "description": "Optional field, if not provided default product rate will be used",
            "$ref": "#/components/schemas/Rate"
          }
        }
      },
      "CreateContractRequest": {
        "type": "object",
        "required": [
          "company_id"
        ],
        "properties": {
          "company_id": {
            "type": "number",
            "description": "Company Id of a contract"
          },
          "payment_method": {
            "$ref": "#/components/schemas/PaymentMethod"
          },
          "rates": {
            "type": "array",
            "description": "Optional rates associated to a contract",
            "items": {
              "$ref": "#/components/schemas/ContractRateRequest"
            }
          },
          "start": {
            "type": "string",
            "format": "date-time",
            "description": "Start date of a contract. If not specified it will be set to `now`"
          },
          "end": {
            "type": "string",
            "format": "date-time",
            "description": "Optional end date of a contract"
          },
          "internal_notes": {
            "type": "string",
            "description": "Internal notes related to a contract"
          },
          "revision_notes": {
            "type": "string",
            "description": "Internal notes related to specific contract revision"
          }
        }
      },
      "ContractRateResponse": {
        "type": "object",
        "properties": {
          "contract_id": {
            "$ref": "#/components/schemas/Contract_UUID"
          },
          "contract_revision": {
            "type": "number",
            "description": "Contract revision"
          },
          "product_id": {
            "$ref": "#/components/schemas/Contract_UUID"
          },
          "rate": {
            "$ref": "#/components/schemas/Rate"
          },
          "start_at": {
            "type": "string",
            "format": "date-time",
            "description": "Start date of a contract rate."
          },
          "end_at": {
            "type": "string",
            "format": "date-time",
            "description": "Optional end date of a contract rate"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "When contract is created"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "When contract is updated"
          }
        }
      },
      "CreateContractResponse": {
        "type": "object",
        "required": [
          "createdContract"
        ],
        "properties": {
          "createdContract": {
            "$ref": "#/components/schemas/ContractResponse"
          },
          "createdRates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ContractRateResponse"
            }
          }
        }
      },
      "UpdateContractRequest": {
        "type": "object",
        "properties": {
          "start": {
            "type": "string",
            "format": "date-time",
            "description": "Start date of a contract. If not specified it will be set to `now`"
          },
          "end": {
            "type": "string",
            "format": "date-time",
            "description": "Optional end date of a contract"
          },
          "payment_method": {
            "$ref": "#/components/schemas/PaymentMethod"
          },
          "rates": {
            "type": "array",
            "description": "Optional rates associated to a contract",
            "items": {
              "$ref": "#/components/schemas/ContractRateRequest"
            }
          },
          "internal_notes": {
            "type": "string"
          },
          "revision_notes": {
            "type": "string"
          }
        }
      },
      "ContractRatesResponse": {
        "type": "object",
        "properties": {
          "records": {
            "$ref": "#/components/schemas/ContractRateResponse"
          }
        }
      },
      "DatasetStorageBillingView": {
        "type": "object",
        "required": [
          "billing_month",
          "company_id",
          "company_name",
          "dataset_id",
          "updated_by"
        ],
        "properties": {
          "billing_month": {
            "type": "number",
            "format": "date-time"
          },
          "company_id": {
            "type": "number"
          },
          "company_name": {
            "type": "string"
          },
          "dataset_id": {
            "type": "number"
          },
          "avg_gb_hours": {
            "type": "number"
          }
        },
        "example": {
          "billing_month": "2022-08-31T22:00:00Z",
          "company_id": 1,
          "company_name": "test_company1",
          "dataset_id": 322,
          "avg_gb_hours": 4
        }
      },
      "DatasetStorageBillingViewResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/DatasetStorageBillingView"
        }
      },
      "Access": {
        "type": "string",
        "enum": [
          "read",
          "write",
          "admin"
        ]
      },
      "Resource": {
        "type": "string",
        "enum": [
          "api_info",
          "attributes",
          "apps",
          "app_profiles",
          "resources",
          "charges",
          "datasets",
          "data_streams",
          "deliveries",
          "destinations",
          "forecasts",
          "installations",
          "lists",
          "mappings",
          "internal_reports",
          "subscriptions",
          "payment_methods",
          "uploads",
          "company_info",
          "schema_preset"
        ]
      },
      "ResourcePermissions": {
        "type": "object",
        "properties": {
          "access": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Access"
            }
          },
          "resource": {
            "$ref": "#/components/schemas/Resource"
          }
        },
        "required": [
          "access",
          "resource"
        ]
      },
      "Permissions": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/ResourcePermissions"
        }
      },
      "WhoamiResponse": {
        "type": "object",
        "properties": {
          "user_id": {
            "description": "The user id",
            "type": "integer"
          },
          "name": {
            "description": "Name of the user",
            "type": "string"
          },
          "company_access_list": {
            "type": "array",
            "items": {
              "type": "integer"
            },
            "description": "Companies that could be accessed by the user."
          },
          "current_company_scope": {
            "$ref": "#/components/schemas/PublicCompanyResponse"
          },
          "permissions": {
            "$ref": "#/components/schemas/Permissions"
          },
          "created_at": {
            "description": "The instant this company was created.",
            "$ref": "#/components/schemas/Instant"
          },
          "created_by": {
            "description": "Contact of user who created the company",
            "type": "string"
          },
          "last_updated_at": {
            "description": "The instant this company was created.",
            "$ref": "#/components/schemas/Instant"
          },
          "last_updated_by": {
            "description": "Contact of user who updated the company",
            "type": "string"
          }
        },
        "example": {
          "user_id": 407,
          "name": "John Doe",
          "company_access_list": [
            1
          ],
          "current_company_scope": {
            "company_id": 1,
            "slug": "narrative",
            "name": "Narrative, Inc (id 1!)",
            "short_description": "Another New Short Description",
            "long_description": "Narrative Long Description",
            "contact_email": null,
            "website": "https://app-dev.narrative.io/",
            "data_shop_url": "https://shop.nicks.io/",
            "twitter_link": "https://twitter.com/narrative_io",
            "linkedin_link": "https://www.linkedin.com/company/narrative-io",
            "image_url": null,
            "status": "active",
            "visibility": "visible"
          },
          "created_at": "2022-11-29T21:42:24.978707Z",
          "created_by": null,
          "last_updated_at": null,
          "last_updated_by": null
        }
      },
      "UserUpdateRequest": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "User name"
          }
        }
      },
      "UserUpdateResponse": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "User name"
          },
          "id": {
            "$ref": "#/components/schemas/schemas_UserId"
          }
        }
      },
      "WebhookSubscriptionResponse": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "secret": {
            "type": "string",
            "format": "uuid"
          },
          "status": {
            "type": "string",
            "enum": [
              "active",
              "archived"
            ]
          },
          "companyId": {
            "type": "string"
          },
          "jobIds": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "costs",
                "datasets_calculate_column_stats",
                "datasets_delete_table",
                "datasets_deliver_data",
                "datasets_sample",
                "datasets_suggest_mappings",
                "delete-snowflake-table",
                "forecast",
                "materialize-view",
                "models_deliver_model",
                "model_training_run",
                "nql-forecast",
                "upload-stats"
              ]
            }
          },
          "jobStates": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "pending",
                "running",
                "completed",
                "pending_cancellation",
                "cancelled",
                "failed"
              ]
            }
          },
          "jobTypes": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "url": {
            "type": "string",
            "format": "uri"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "id",
          "secret",
          "status",
          "companyId",
          "url",
          "createdAt",
          "updatedAt"
        ],
        "example": {
          "id": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
          "secret": "8b6dba8c-9a8b-4a3a-8469-9dc7a33c3e17",
          "status": "active",
          "companyId": 42,
          "jobIds": [
            "d35a12c1-7a2f-46b9-8d60-9e0a2a84c205",
            "9a3cf334-4c6d-4d3f-a7d6-22b6e6f2ac1b"
          ],
          "jobStates": [
            "pending",
            "running",
            "completed"
          ],
          "jobTypes": [
            "forecast",
            "materialized-view"
          ],
          "url": "https://webhooks.mycompany.com/events",
          "createdAt": "2025-04-29T16:12:45.123456",
          "updatedAt": "2025-04-29T16:12:45.123456"
        }
      },
      "WebhookSubscriptionsResponse": {
        "type": "array",
        "items": {
          "$ref": "#/components/schemas/WebhookSubscriptionResponse"
        }
      },
      "AppWebhookSubscriptionRequest": {
        "type": "object",
        "required": [
          "type",
          "app_id",
          "url"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "webhook_subscription_app"
            ]
          },
          "app_id": {
            "type": "string",
            "format": "uuid"
          },
          "url": {
            "type": "string",
            "format": "uri"
          },
          "name": {
            "type": "string"
          }
        },
        "example": {
          "type": "webhook_subscription_app",
          "app_id": "32b83061-e41b-4789-8d62-f1d4f1faf07e",
          "url": "https://example.com/123",
          "name": "some_webhook"
        }
      },
      "JobsWebhookSubscriptionRequest": {
        "type": "object",
        "required": [
          "type",
          "url"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "webhook_subscription_jobs"
            ]
          },
          "job_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "job_types": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "costs",
                "datasets_calculate_column_stats",
                "datasets_delete_table",
                "datasets_deliver_data",
                "datasets_sample",
                "datasets_suggest_mappings",
                "delete-snowflake-table",
                "forecast",
                "materialize-view",
                "models_deliver_model",
                "model_training_run",
                "nql-forecast",
                "upload-stats"
              ]
            }
          },
          "states": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "pending",
                "running",
                "completed",
                "pending_cancellation",
                "cancelled",
                "failed"
              ]
            }
          },
          "url": {
            "type": "string",
            "format": "uri"
          },
          "name": {
            "type": "string"
          }
        },
        "example": {
          "type": "webhook_subscription_jobs",
          "job_ids": [
            "32b83061-e41b-4789-8d62-f1d4f1faf07e"
          ],
          "job_types": [
            "forecast",
            "materialize-view"
          ],
          "states": [
            "pending",
            "running",
            "completed"
          ],
          "url": "https://example.com/123",
          "name": "job_updates"
        }
      },
      "CreateWebhookSubscriptionRequest": {
        "type": "object",
        "discriminator": {
          "propertyName": "type",
          "mapping": {
            "webhook_subscription_app": "#/components/schemas/AppWebhookSubscriptionRequest",
            "webhook_subscription_jobs": "#/components/schemas/JobsWebhookSubscriptionRequest"
          }
        },
        "oneOf": [
          {
            "$ref": "#/components/schemas/AppWebhookSubscriptionRequest"
          },
          {
            "$ref": "#/components/schemas/JobsWebhookSubscriptionRequest"
          }
        ]
      },
      "AwsPlatform": {
        "type": "object",
        "required": [
          "type",
          "region"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "platform_aws"
            ]
          },
          "region": {
            "type": "string"
          }
        }
      },
      "SnowflakePlatform": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "platform_snowflake"
            ]
          },
          "region": {
            "type": "string"
          }
        }
      },
      "Platform": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/AwsPlatform"
          },
          {
            "$ref": "#/components/schemas/SnowflakePlatform"
          }
        ]
      },
      "ParticipantsAll": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "all"
            ]
          }
        }
      },
      "ParticipantsNone": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "none"
            ]
          }
        }
      },
      "data-plane-collaborators_CompanyId": {
        "type": "string"
      },
      "ParticipantsInclusion": {
        "type": "object",
        "required": [
          "type",
          "company_ids"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "inclusion"
            ]
          },
          "company_ids": {
            "type": "array",
            "minItems": 1,
            "items": {
              "$ref": "#/components/schemas/data-plane-collaborators_CompanyId"
            }
          }
        }
      },
      "DataPlaneParticipants": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/ParticipantsAll"
          },
          {
            "$ref": "#/components/schemas/ParticipantsNone"
          },
          {
            "$ref": "#/components/schemas/ParticipantsInclusion"
          }
        ],
        "discriminator": {
          "propertyName": "type",
          "mapping": {
            "all": "#/components/schemas/ParticipantsAll",
            "none": "#/components/schemas/ParticipantsNone",
            "inclusion": "#/components/schemas/ParticipantsInclusion"
          }
        }
      },
      "DataPlaneCollaborators": {
        "type": "object",
        "required": [
          "participants"
        ],
        "properties": {
          "participants": {
            "$ref": "#/components/schemas/DataPlaneParticipants"
          }
        }
      },
      "DataPlaneOwnedResponse": {
        "type": "object",
        "required": [
          "type",
          "id",
          "company_id",
          "created_at",
          "display_name",
          "external_id",
          "platform",
          "status",
          "updated_at",
          "collaborators"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "owned"
            ]
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "company_id": {
            "type": "number"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string"
          },
          "display_name": {
            "type": "string"
          },
          "external_id": {
            "type": "string"
          },
          "platform": {
            "$ref": "#/components/schemas/Platform"
          },
          "status": {
            "type": "string",
            "enum": [
              "active",
              "archived"
            ]
          },
          "last_heartbeat_at": {
            "type": "string",
            "format": "date-time"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "collaborators": {
            "$ref": "#/components/schemas/DataPlaneCollaborators"
          }
        }
      },
      "AwsSharedResponse": {
        "type": "object",
        "required": [
          "type",
          "region"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "platform_shared_aws"
            ]
          },
          "region": {
            "type": "string"
          }
        }
      },
      "SnowflakeSharedResponse": {
        "type": "object",
        "required": [
          "type"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "platform_shared_snowflake"
            ]
          },
          "region": {
            "type": "string"
          }
        }
      },
      "PlatformSharedResponse": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/AwsSharedResponse"
          },
          {
            "$ref": "#/components/schemas/SnowflakeSharedResponse"
          }
        ]
      },
      "DataPlaneSharedResponse": {
        "type": "object",
        "required": [
          "type",
          "id",
          "company_id",
          "created_at",
          "display_name",
          "platform",
          "status",
          "updated_at"
        ],
        "properties": {
          "type": {
            "type": "string",
            "enum": [
              "shared"
            ]
          },
          "id": {
            "type": "string"
          },
          "company_id": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": "string"
          },
          "display_name": {
            "type": "string"
          },
          "platform": {
            "$ref": "#/components/schemas/PlatformSharedResponse"
          },
          "status": {
            "type": "string",
            "enum": [
              "active",
              "archived"
            ]
          },
          "last_heartbeat_at": {
            "type": "string",
            "format": "date-time"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "DataPlaneResponse": {
        "oneOf": [
          {
            "$ref": "#/components/schemas/DataPlaneOwnedResponse"
          },
          {
            "$ref": "#/components/schemas/DataPlaneSharedResponse"
          }
        ]
      },
      "GetDataPlanesResponse": {
        "type": "object",
        "required": [
          "records"
        ],
        "properties": {
          "records": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DataPlaneResponse"
            }
          }
        }
      },
      "CreateDataPlaneRequest": {
        "type": "object",
        "required": [
          "display_name",
          "external_id",
          "platform",
          "tags"
        ],
        "properties": {
          "description": {
            "type": "string"
          },
          "display_name": {
            "type": "string"
          },
          "external_id": {
            "type": "string"
          },
          "platform": {
            "$ref": "#/components/schemas/Platform"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "collaborators": {
            "$ref": "#/components/schemas/DataPlaneCollaborators"
          }
        }
      }
    },
    "parameters": {
      "AccessTokenId": {
        "in": "path",
        "name": "access_token_id",
        "required": true,
        "description": ".",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "AccessRuleId": {
        "in": "path",
        "name": "access_rule_id",
        "schema": {
          "type": "integer"
        },
        "required": true,
        "description": "Access rule identifier."
      },
      "CompanySlug": {
        "in": "path",
        "name": "company_slug",
        "schema": {
          "type": "string"
        },
        "required": true,
        "description": "Company slug."
      },
      "AccessRuleName": {
        "in": "path",
        "name": "access_rule_name",
        "schema": {
          "type": "string"
        },
        "required": true,
        "description": "Access rule name."
      },
      "OwnedOnly": {
        "in": "query",
        "name": "owned_only",
        "schema": {
          "type": "boolean"
        },
        "required": false,
        "description": "If enabled, returns only owned rules."
      },
      "SharedOnly": {
        "in": "query",
        "name": "shared_only",
        "schema": {
          "type": "boolean"
        },
        "required": false,
        "description": "If enabled, returns only shared (not owned) rules."
      },
      "Tag": {
        "in": "query",
        "name": "tag",
        "schema": {
          "type": "string"
        },
        "required": false,
        "description": "Check whether tag is presented. If multiple tags specified, looks if any of them is attached to a rule."
      },
      "CompanyId": {
        "in": "query",
        "name": "company_id",
        "schema": {
          "type": "integer"
        },
        "required": false,
        "description": "Check whether owned by the company. Can be specified multiple times."
      },
      "PageNumber": {
        "in": "query",
        "name": "page",
        "required": false,
        "description": "Number of page. Stars from the first (1) page.",
        "schema": {
          "type": "integer"
        }
      },
      "per_page": {
        "in": "query",
        "name": "per_page",
        "required": false,
        "description": "Number of records to return.",
        "schema": {
          "type": "integer"
        }
      },
      "DatasetId": {
        "in": "query",
        "name": "dataset_id",
        "schema": {
          "type": "integer"
        },
        "required": false,
        "description": "Check whether the rule is associated with specified dataset. Multiple values are allowed."
      },
      "QueryId": {
        "in": "path",
        "name": "query_id",
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "required": true,
        "description": "Query identifier."
      },
      "IsOwned": {
        "in": "query",
        "name": "is_owned",
        "schema": {
          "type": "boolean"
        },
        "required": false,
        "description": "If `true` returns only queries that are owned by the requestor. If `false` returns only queries that have been shared with the requestor. If not provided returns both."
      },
      "parameters_Tag": {
        "in": "query",
        "name": "tag",
        "schema": {
          "type": "string"
        },
        "required": false,
        "description": "Filters queries that are tagged with `tag`. Can appear multiple times, in which case they're OR-d together"
      },
      "PageNumberQueryParam": {
        "in": "query",
        "name": "page",
        "required": false,
        "description": "Number of page. Stars from the first (1) page.",
        "schema": {
          "type": "integer"
        }
      },
      "PerPageQueryParam": {
        "in": "query",
        "name": "per_page",
        "required": false,
        "description": "Number of records to return.",
        "schema": {
          "type": "integer"
        }
      },
      "ViewId": {
        "in": "path",
        "name": "view_id",
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "required": true,
        "description": "View identifier."
      },
      "parameters_IsOwned": {
        "in": "query",
        "name": "is_owned",
        "schema": {
          "type": "boolean"
        },
        "required": false,
        "description": "If `true` returns only views that are owned by the requestor. If `false` returns only views that have been shared with the requestor. If not provided returns both."
      },
      "parameters_Tag-2": {
        "in": "query",
        "name": "tag",
        "schema": {
          "type": "string"
        },
        "required": false,
        "description": "Filters views that are tagged with `tag`. Can appear multiple times, in which case they're OR-d together"
      },
      "AppCategory": {
        "name": "category",
        "in": "query",
        "description": "a filter for app categories",
        "schema": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "destination_connector"
            ]
          }
        }
      },
      "AppSlug": {
        "in": "path",
        "required": true,
        "name": "app_slug",
        "description": "unique app name",
        "schema": {
          "type": "string"
        }
      },
      "SchemaVersionId": {
        "name": "schema_version_id",
        "in": "path",
        "required": true,
        "description": "schema version id",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "ProfileId": {
        "name": "profile_id",
        "in": "path",
        "required": true,
        "description": "the profile id",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "Resolve": {
        "in": "query",
        "name": "resolve",
        "required": false,
        "description": "resolve attribute(s) which is true by default.",
        "schema": {
          "type": "boolean"
        }
      },
      "AttributeNameOrId": {
        "in": "path",
        "name": "attribute_name_or_id",
        "required": true,
        "description": "Either an attribute name or an attribute id",
        "schema": {
          "oneOf": [
            {
              "type": "integer",
              "description": "Unique identifier"
            },
            {
              "type": "string",
              "description": "Unique name`"
            }
          ]
        }
      },
      "parameters_DatasetId": {
        "name": "dataset_id",
        "in": "query",
        "required": true,
        "description": "Unique identifier for a dataset.",
        "schema": {
          "type": "number"
        }
      },
      "ConnectionId": {
        "name": "connection_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for a connection.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "parameters_DatasetId-2": {
        "in": "path",
        "name": "dataset_id",
        "required": true,
        "description": "Unique identifier for a dataset.",
        "schema": {
          "type": "integer"
        }
      },
      "SampleSize": {
        "in": "query",
        "name": "size",
        "required": false,
        "description": "The number of rows to sample from the dataset.",
        "schema": {
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 1000
        }
      },
      "AllRecords": {
        "in": "query",
        "name": "all_records",
        "required": false,
        "description": "If true will return 100 records. If false, only returns the most recent record.\nPagination api with `per_page` and `offset` parameters should be used instead of this one.",
        "schema": {
          "type": "boolean"
        }
      },
      "PerPage": {
        "in": "query",
        "name": "per_page",
        "required": false,
        "description": "Number of records to return.",
        "schema": {
          "type": "integer"
        }
      },
      "Offset": {
        "in": "query",
        "name": "offset",
        "required": false,
        "description": "Number of records to skip (it's usually page_number * per_page).",
        "schema": {
          "type": "integer"
        }
      },
      "HistogramBinLimit": {
        "in": "query",
        "name": "histogram_bin_limit",
        "required": false,
        "description": "The maximum number of bins to return for the histograms.",
        "schema": {
          "type": "integer",
          "exclusiveMinimum": 0
        }
      },
      "SnapshotId": {
        "name": "snapshot_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for a snapshot.",
        "schema": {
          "type": "integer"
        }
      },
      "FromTimestamp": {
        "in": "query",
        "name": "timestamp.gte",
        "required": false,
        "description": "ISO-8601 timestamp that will be inclusively used as minimal timestamp of a snapshot.",
        "schema": {
          "type": "string"
        },
        "example": "2021-06-24T00:54:40"
      },
      "UntilTimestamp": {
        "in": "query",
        "name": "timestamp.lt",
        "required": false,
        "description": "ISO-8601 timestamp that will be exclusively used as maximal timestamp of a snapshot.",
        "schema": {
          "type": "string"
        },
        "example": "2021-06-24T00:54:40"
      },
      "ToTimestamp": {
        "in": "query",
        "name": "timestamp.lte",
        "required": false,
        "description": "ISO-8601 timestamp that will be inclusively used as maximal timestamp of a snapshot.",
        "schema": {
          "type": "string"
        },
        "example": "2021-06-24T00:54:40"
      },
      "FromSnapshot": {
        "in": "query",
        "name": "from_snapshot_id",
        "required": false,
        "description": "Snapshot Id that will be inclusively used as the beginning of snapshot search range. That snapshot should exist.",
        "schema": {
          "type": "number"
        },
        "example": 12345989746723134
      },
      "UntilSnapshot": {
        "in": "query",
        "name": "until_snapshot_id",
        "required": false,
        "description": "Snapshot Id that will be exclusively used as the end of snapshot search range. That snapshot should exist.",
        "schema": {
          "type": "number"
        },
        "example": 12345989746723134
      },
      "ToSnapshot": {
        "in": "query",
        "name": "to_snapshot_id",
        "required": false,
        "description": "Snapshot Id that will be inclusively used as the end of snapshot search range. That snapshot should exist.",
        "schema": {
          "type": "number"
        },
        "example": 12345989746723134
      },
      "FileId": {
        "name": "file_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for a file.",
        "schema": {
          "type": "string"
        }
      },
      "CostForecastId": {
        "name": "cost_forecast_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for a cost forecast.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "SubscriptionId": {
        "name": "subscription_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for a subscription.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "DataShopId": {
        "name": "data_shop_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for a data-shop.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "Hostname": {
        "name": "host_name",
        "in": "path",
        "required": true,
        "description": "hostname like 'datashop.narrative.io'",
        "schema": {
          "type": "string"
        }
      },
      "CompanyId_CompanyId": {
        "in": "path",
        "name": "company_id",
        "schema": {
          "type": "integer",
          "format": "int64"
        },
        "required": true,
        "description": "The id of an existing company",
        "example": 345
      },
      "DataStreamId": {
        "name": "data_stream_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for a data-stream.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "SearchQueryParam": {
        "name": "q",
        "in": "query",
        "required": true,
        "description": "search query expression",
        "example": "apparel or fabric or accessories -leather",
        "schema": {
          "type": "string"
        }
      },
      "Slug": {
        "name": "slug",
        "in": "path",
        "required": true,
        "description": "The DataStream's slug. Used for SEO/URLs.",
        "schema": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9-_.:]+$"
        }
      },
      "SalesChannel": {
        "name": "sales_channel",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string",
          "enum": [
            "data_streams_market",
            "data_shop"
          ]
        }
      },
      "OrderQueryParam": {
        "name": "o",
        "in": "query",
        "required": false,
        "description": "Order by offers price low/high",
        "example": "price-high",
        "schema": {
          "type": "string",
          "enum": [
            "price-low",
            "price-high"
          ]
        }
      },
      "EncryptionMaterialId": {
        "name": "encryption_material_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for an encryption material",
        "schema": {
          "type": "string"
        }
      },
      "parameters_AppCategory": {
        "name": "app_category",
        "in": "query",
        "description": "A filter for app categories.",
        "schema": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "destination_connector"
            ]
          }
        }
      },
      "InstallationId": {
        "name": "installation_id",
        "in": "path",
        "required": true,
        "description": "The installation ID",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "parameters_ProfileId": {
        "name": "app_profile_id",
        "in": "path",
        "required": true,
        "description": "The profile ID",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "data_plane_id": {
        "in": "query",
        "name": "data_plane_id",
        "required": false,
        "description": "Filter jobs by data plane ID.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "dataset_id": {
        "in": "query",
        "name": "dataset_id",
        "required": false,
        "description": "Filter jobs where the input has a dataset_id (such as materalized-view)",
        "schema": {
          "type": "integer"
        }
      },
      "offset": {
        "in": "query",
        "name": "offset",
        "required": false,
        "description": "Number of records to skip (page_number * per_page).",
        "schema": {
          "type": "integer"
        }
      },
      "order_by": {
        "in": "query",
        "name": "order_by",
        "required": false,
        "description": "Order the results by a specific field. By default, job are order by created_at in descending order.",
        "schema": {
          "type": "string",
          "enum": [
            "created_at_asc",
            "created_at_desc"
          ]
        }
      },
      "state": {
        "in": "query",
        "name": "state",
        "required": false,
        "description": "Filter jobs by state.",
        "schema": {
          "type": "string",
          "enum": [
            "cancelled",
            "completed",
            "failed",
            "pending",
            "pending_cancellation",
            "running"
          ]
        }
      },
      "type": {
        "in": "query",
        "name": "type",
        "required": false,
        "description": "Filter jobs by type.",
        "schema": {
          "type": "string"
        }
      },
      "JobId": {
        "in": "path",
        "name": "job_id",
        "required": true,
        "description": "Unique identifier for a job.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "MappingId": {
        "in": "path",
        "name": "mapping_id",
        "required": true,
        "description": "Unique identifier for a mapping.",
        "schema": {
          "type": "string",
          "format": "uuid"
        },
        "example": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a6f0"
      },
      "parameters_CompanyId": {
        "in": "path",
        "name": "company_id",
        "required": true,
        "description": "Unique identifier for a company",
        "schema": {
          "type": "integer"
        }
      },
      "SchemaPresetId": {
        "in": "path",
        "name": "schema_preset_id",
        "required": true,
        "schema": {
          "type": "integer",
          "format": "int64"
        },
        "description": "Unique identifier of an existing schema preset."
      },
      "ApplicationId": {
        "name": "app_id",
        "in": "path",
        "required": true,
        "description": "the app id",
        "schema": {
          "type": "integer",
          "format": "int64"
        }
      },
      "UploadPath": {
        "in": "path",
        "name": "upload_path",
        "schema": {
          "type": "string"
        },
        "description": "A slash-separated path where the uploaded file should be stored",
        "example": "/lists/idlist.csv",
        "required": true
      },
      "DestinationId": {
        "name": "destination_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for a destination.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "parameters_ProfileId-2": {
        "name": "profile_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for an app profile.",
        "schema": {
          "type": "string",
          "format": "uuid"
        }
      },
      "DeliveryId": {
        "name": "delivery_id",
        "in": "path",
        "required": true,
        "description": "Unique identifier for an delivery record.",
        "schema": {
          "type": "integer"
        }
      },
      "FileName": {
        "name": "filename",
        "in": "path",
        "required": true,
        "description": "Name of a delivery file.",
        "schema": {
          "type": "string"
        }
      },
      "Sku": {
        "in": "path",
        "name": "sku",
        "required": true,
        "description": "Unique identifier for a product.",
        "schema": {
          "type": "string"
        },
        "example": "general-purpose-processing-aws-us-east-1"
      },
      "Contract_CompanyId": {
        "in": "path",
        "name": "company_id",
        "required": true,
        "description": "Unique identifier for a company.",
        "schema": {
          "type": "number"
        },
        "example": "123"
      }
    }
  },
  "servers": [
    {
      "url": "https://api-dev.narrative.io"
    },
    {
      "url": "https://api.narrative.io"
    }
  ],
  "tags": [
    {
      "name": "Access Rules",
      "description": "Access rules let data providers control who can purchase their data and the terms of purchase.\n\nThe `access-rules` API allows you to manage access rules for your datasets.\n\nRelated guides:\n  - [What is an access rule?](https://kb.narrative.io/access-rules)"
    },
    {
      "name": "Apps",
      "description": "Apps are applications bundled with a UI that can perform various actions on behalf of a user utilizing the Narrative API.\nRelated guides:\n  - [Building a Narrative Native App](https://www.narrative.io/knowledge-base/how-to-guides/building-a-narrative-native-app)"
    },
    {
      "name": "Access Tokens",
      "description": "API Access Token management"
    },
    {
      "name": "Attributes",
      "description": "An attribute models a standardized data point available for sale on the Narrative marketplace.\n\nNarrative automatically turns data points from provider datasets into attributes so that buyers can purchase well-formed, standardized data from any supplier on the marketplace."
    },
    {
      "name": "Auth",
      "description": "API token is a crucial step for developers to securely authenticate requests to the Narrative API\nRelated guides:\n  - [How to Create an API Token](https://www.narrative.io/knowledge-base/how-to-guides/understanding-narratives-apis/create-an-api-token)"
    },
    {
      "name": "Authentication",
      "description": "User login and registration"
    },
    {
      "name": "Billings",
      "description": "Used by Narrative internally to bill customers"
    },
    {
      "name": "Companies",
      "description": "A collection of employees"
    },
    {
      "name": "Company Marketing Information",
      "description": "Useful information related to companies"
    },
    {
      "name": "Connections",
      "description": "Associations between connectors and datasets"
    },
    {
      "name": "Data Shops",
      "description": "Self-hosted website to sell your data\nRelated guides:\n  - [Setting up your datashop](https://www.narrative.io/knowledge-base/how-to-guides/shop-builder/settting-up-your-data-shop)"
    },
    {
      "name": "Data Streams",
      "description": "The `data-stream` API endpoints allows one to create and update data-streams. Additionally the endpoints allow\nfinding data-streams using free text search. A few of the endpoints are behind authorization.\n\nUpdate endpoint allows a client to post an edited data-stream document as is, without having to change its shape.\nThe API ensures that only certain fields are allowed to be modified. Attempts to modify fields not up for client\nmodifications are ignored.\n\nRelated guides:\n  - [What is a data stream?](https://kb.narrative.io/what-is-a-data-stream)"
    },
    {
      "name": "Contracts",
      "description": "Contracts related APIs"
    },
    {
      "name": "Datasets",
      "description": "Any kind of data, in any schema, can be pushed into the Narrative Data Collaboration Platform as a dataset exactly as it is stored in your own system.\n\nThe `datasets` API allows you to manage your datasets."
    },
    {
      "name": "Destinations",
      "description": "Destinations associate a subscription to a profile. Optionally, ad-hoc quick settings can be configured to a destination.\nThose quick settings have to match the format defined on the app manifest."
    },
    {
      "name": "Installations",
      "description": "Installations of Applications for a profile"
    },
    {
      "name": "Jobs",
      "description": "Jobs represent an operation done on a given data plane. All jobs today are tied to a query that represents a forecast or a materialized view.\n\nThe jobs API provides an interface for interacting with the jobs table, which stores various operations involving reading or writing data. This API allows users to retrieve detailed information about specific jobs, including cost forecasts, data forecasts, NQL forecasts and materialized views."
    },
    {
      "name": "Mappings",
      "description": "A mapping is a transformation from a dataset to an attribute. Defining a mapping between a dataset and an attribute makes the dataset eligible to participate in subscriptions where a buyer is purchasing the target attribute."
    },
    {
      "name": "Model Inference",
      "description": "Model Inference"
    },
    {
      "name": "NQL",
      "description": "Narrative Query Language (NQL) is a specialized, SQL-inspired language designed to query and manipulate data within the Narrative platform. While it looks and feels much like standard SQL, it offers extended functionality and syntax that let you leverage platform-specific features—such as referencing datasets by their IDs, creating materialized views, or generating forecasts—without having to manage the complexities of different query engines behind the scenes. NQL queries can ultimately compile down to multiple underlying engines (e.g., Snowflake, Spark) to execute your requests efficiently in the Narrative ecosystem."
    },
    {
      "name": "Payment Methods",
      "description": "Payment methods used to purchase data"
    },
    {
      "name": "Products",
      "description": "Internal routes used to offer datastream as products"
    },
    {
      "name": "Profiles",
      "description": "App profiles are associated with an installation. They represent a reference to a configuration that the app can use to save confidential information outside of Narrative's control.\nProfiles are currently used to configure settings for connector apps."
    },
    {
      "name": "Resources",
      "description": "Narrative gives you access to managed resources, like your own AWS S3 bucket, so that you can effortlessly buy and sell data on the platform.\n\nThe `resources` API allows you to manage your resources."
    },
    {
      "name": "Schema Inference",
      "description": "The `schema-inference` API analyzes submitted files to automatically infer and return their structure as a dataset schema."
    },
    {
      "name": "Schema Presets",
      "description": "The `schema-presets` API allows you to list the available schema presets, get detailed information about a specific one and manage its life cycle.\n\nYou can create a schema preset from scratch or create one based on an existing one, administrators can create platform wide available (public) schema preset."
    },
    {
      "name": "Subscriptions",
      "description": "In the Narrative Data Collaboration Platform a subscription represents a set of rules dictating the commercial terms related to the licensing of data.\n\nThe `subscriptions` API allows you to set and get information about `subscription` objects owned by the authenticated account."
    },
    {
      "name": "Uploads",
      "description": "The `uploads` API allows you to send files to Narrative and use them to perform tasks like creating a list or adding data to a dataset."
    },
    {
      "name": "Usage",
      "description": "The `usage` API enables the recording of usage events associated with a product."
    }
  ],
  "paths": {
    "/v2/access-rules/{access_rule_id}": {
      "get": {
        "summary": "Get an Access Rule by id (V2)",
        "operationId": "GetAccessRuleByIdV2",
        "description": "Get an access rule.",
        "tags": [
          "Access Rules"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AccessRuleId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRuleV2Response"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update an Access Rule by id (V2)",
        "operationId": "UpdateAccessRuleByIdV2",
        "description": "Update an access rule.",
        "tags": [
          "Access Rules"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AccessRuleId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRuleV2Response"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request or Invalid field updates (nql, schema, owner, is_owned, and metadata)"
          },
          "404": {
            "description": "No Access Rule found to update."
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AccessRuleUpdateRequest"
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete an access rule",
        "operationId": "DeleteAccessRule",
        "description": "Access rule deletion cannot be undone.",
        "parameters": [
          {
            "$ref": "#/components/parameters/AccessRuleId"
          }
        ],
        "tags": [
          "Access Rules"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/v2/access-rules/{company_slug}/{access_rule_name}": {
      "get": {
        "summary": "Get an Access Rule by name (V2)",
        "operationId": "GetAccessRuleByNameV2",
        "description": "Get an access rule by name and company slug.",
        "tags": [
          "Access Rules"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanySlug"
          },
          {
            "$ref": "#/components/parameters/AccessRuleName"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRuleV2Response"
                }
              }
            }
          }
        }
      }
    },
    "/v2/access-rules": {
      "get": {
        "summary": "Get all accessible Access Rules (V2)",
        "operationId": "GetAllAccessibleAccessRules(v2)",
        "description": "Get all accessible Access Rules.\n\n'owned_only' and 'owned_only' are flags, they don't require values.\n\n'tag', 'dataset_id', and 'company_id' are multi-params.\n\nQuery like 'tag=tag1&tag=tag2&company_id=1&company_id=2' is interpreted as \"access rules with tags that comprise 'tag1' or 'tag2' AND belonging to companies with id '1' or '2'.",
        "tags": [
          "Access Rules"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/OwnedOnly"
          },
          {
            "$ref": "#/components/parameters/SharedOnly"
          },
          {
            "$ref": "#/components/parameters/Tag"
          },
          {
            "$ref": "#/components/parameters/CompanyId"
          },
          {
            "$ref": "#/components/parameters/PageNumber"
          },
          {
            "$ref": "#/components/parameters/per_page"
          },
          {
            "$ref": "#/components/parameters/DatasetId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRulesV2PaginatedResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a new Access Rule",
        "operationId": "CreateANewAccessRule",
        "description": "Creates a new access rule based on the provided NQL query.",
        "tags": [
          "Access Rules"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRulesV2PaginatedResponse"
                }
              }
            }
          }
        },
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AccessRuleCreateRequest"
              }
            }
          }
        }
      }
    },
    "/access-tokens/tokens": {
      "get": {
        "summary": "List System Access Tokens",
        "description": "List System Access Tokens",
        "tags": [
          "Access Tokens"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/response"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The token used to authenticate the request is not associated with a company",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a System Access Token",
        "description": "Create a System Access Token",
        "tags": [
          "Access Tokens"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/request"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/tokens_AccessToken"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when:\n- The request cannot be parsed\n- The provided name is invalid\n- The provided permissions are invalid\n- The provided expiration date is invalid",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The token used to authenticate the request is not associated with a company",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/access-tokens/tokens/{access_token_id}": {
      "get": {
        "summary": "Get a System Access Token by id",
        "description": "Get a System Access Token by id",
        "tags": [
          "Access Tokens"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AccessTokenId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/get_response"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The token used to authenticate the request is not associated with a company",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "This error is raised when:\n- The token id is not found or the credentials used to authenticate the request doesn't have access to the requested token"
          }
        }
      },
      "put": {
        "summary": "Update a System Access Token",
        "description": "Update a System Access Token",
        "tags": [
          "Access Tokens"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AccessTokenId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/update_request"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessTokenWithoutCredentials"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when:\n- The request cannot be parsed\n- The provided name is invalid\n- The provided permissions are invalid\n- The provided expiration date is invalid\n- Update request is empty",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The token used to authenticate the request is not associated with a company",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "This error is raised when:\n- The token id is not found or the credentials used to authenticate the request doesn't have access to the requested token"
          }
        }
      },
      "delete": {
        "summary": "Delete a System Access Token",
        "description": "Delete a System Access Token",
        "tags": [
          "Access Tokens"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AccessTokenId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "404": {
            "description": "This error is raised when:\n- The token id is not found or the credentials used to authenticate the request doesn't have access to the requested token"
          }
        }
      }
    },
    "/v1/app/commands/delivery": {
      "get": {
        "summary": "Delivery Commands",
        "description": "Lists delivery commands this app has access to.",
        "tags": [
          "App API"
        ],
        "security": [
          {
            "App_Token": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedCommands"
                }
              }
            }
          }
        }
      }
    },
    "/v1/app/commands/delivery/{delivery_id}/files": {
      "get": {
        "summary": "Delivery Files",
        "description": "Lists delivery files for a particular delivery command.",
        "parameters": [
          {
            "$ref": "#/components/parameters/DeliveryId"
          }
        ],
        "tags": [
          "App API"
        ],
        "security": [
          {
            "App_Token": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeliveryFiles"
                }
              }
            }
          }
        }
      }
    },
    "/v1/app/commands/delivery/{delivery_id}/download/{filename}": {
      "post": {
        "summary": "Download file",
        "description": "Generates a download url for a particular delivery file",
        "parameters": [
          {
            "$ref": "#/components/parameters/DeliveryId"
          },
          {
            "$ref": "#/components/parameters/FileName"
          }
        ],
        "tags": [
          "App API"
        ],
        "security": [
          {
            "App_Token": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedCommands"
                }
              }
            }
          }
        }
      }
    },
    "/apps": {
      "get": {
        "summary": "Lists apps",
        "parameters": [
          {
            "$ref": "#/components/parameters/AppCategory"
          }
        ],
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {}
            }
          }
        }
      }
    },
    "/apps/events": {
      "post": {
        "summary": "Publish app event",
        "description": "Create a new webhook subscription for the authenticated company.",
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookAppEventBulkRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookAppEventResponse"
                }
              }
            }
          }
        }
      }
    },
    "/apps/{app_slug}/profiles": {
      "get": {
        "summary": "Lists profiles",
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AppSlug"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProfilesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/apps/{app_slug}/manifest/profile-store-schema": {
      "put": {
        "summary": "Put Schema",
        "description": "Submitting (create or update) JSON Schema (2019-09 version) for an app.",
        "parameters": [
          {
            "$ref": "#/components/parameters/AppSlug"
          }
        ],
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "description": "JSON Schema (2019-09 version).",
                "additionalProperties": true
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PostSchemaResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "Get Schema",
        "parameters": [
          {
            "$ref": "#/components/parameters/AppSlug"
          }
        ],
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetSchemasResponse"
                }
              }
            }
          },
          "404": {
            "description": "App or schema not found",
            "content": {}
          }
        }
      }
    },
    "/apps/{app_slug}/manifest/profile-store-schema/{schema_version_id}": {
      "get": {
        "summary": "Get Schema",
        "parameters": [
          {
            "$ref": "#/components/parameters/AppSlug"
          },
          {
            "$ref": "#/components/parameters/SchemaVersionId"
          }
        ],
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetSchemaResponse"
                }
              }
            }
          },
          "404": {
            "description": "App or schema not found",
            "content": {}
          }
        }
      }
    },
    "/apps/{app_slug}/profile-store/${profile_id}": {
      "put": {
        "summary": "Post Data instance",
        "description": "Submitting (create or update) data for a profile.",
        "parameters": [
          {
            "$ref": "#/components/parameters/AppSlug"
          },
          {
            "$ref": "#/components/parameters/ProfileId"
          }
        ],
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "description": "Data that match schema",
                "additionalProperties": true
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PutDataResponse"
                }
              }
            }
          },
          "404": {
            "description": "App, schema or profile not found",
            "content": {}
          }
        }
      },
      "get": {
        "summary": "Get Data instance",
        "parameters": [
          {
            "$ref": "#/components/parameters/AppSlug"
          },
          {
            "$ref": "#/components/parameters/ProfileId"
          }
        ],
        "tags": [
          "Apps"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetDataResponse"
                }
              }
            }
          },
          "404": {
            "description": "App, schema or profile not found",
            "content": {}
          }
        }
      }
    },
    "/admin/apps/{app_id}/slug": {
      "put": {
        "summary": "Update a slug",
        "tags": [
          "Apps"
        ],
        "description": "Slug can be changed (from NULL) just once.",
        "parameters": [
          {
            "$ref": "#/components/parameters/ApplicationId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSlugRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UpdateSlugResponse"
                }
              }
            }
          }
        }
      }
    },
    "/attributes": {
      "get": {
        "summary": "Get attributes",
        "description": "Return all attributes.",
        "tags": [
          "Attributes"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Resolve"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "$ref": "#/components/schemas/AttributesResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create an attribute",
        "description": "Create a new attribute.",
        "tags": [
          "Attributes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AttributeCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttributeOwnedResponse"
                }
              }
            }
          }
        }
      }
    },
    "/attributes/{attribute_name_or_id}": {
      "get": {
        "summary": "Get an attribute",
        "tags": [
          "Attributes"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AttributeNameOrId"
          },
          {
            "$ref": "#/components/parameters/Resolve"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttributeResponseWithMetadata"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete an attribute",
        "description": "Permanently removes an attribute from the platform.\n\nAttribute deletion will fail if the given attribute is referenced by another attribute.\n\nAttribute deletions cannot be undone.",
        "parameters": [
          {
            "$ref": "#/components/parameters/AttributeNameOrId"
          }
        ],
        "tags": [
          "Attributes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/attributes/{attribute_name_or_id}/references": {
      "get": {
        "summary": "Get attribute references.",
        "tags": [
          "Attributes"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AttributeNameOrId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AttributeResponse"
                }
              }
            }
          }
        }
      }
    },
    "/oauth/token": {
      "description": "An endpoint used to acquire a bearer token.  Calls to /oauth/token need to be authenticated using the `client_id` and a valid `refresh_token`.",
      "post": {
        "summary": "Request or refresh an OAuth token",
        "security": [
          {
            "TokenRequest": []
          }
        ],
        "tags": [
          "Auth"
        ],
        "description": "# /oauth/token\n#\nRequests or refreshes the OAuth Token.",
        "operationId": "RefreshOAuthToken",
        "requestBody": {
          "description": "Request or refresh token",
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "grant_type": {
                    "type": "string",
                    "enum": [
                      "refresh_token",
                      "client_credentials"
                    ],
                    "example": "refresh_token"
                  },
                  "client_id": {
                    "type": "string",
                    "description": "A client specific identifier provided by Narrative",
                    "example": "zzzzzzzzzzzzz"
                  },
                  "refresh_token": {
                    "type": "string",
                    "description": "The token used to refresh the API session.  Required if `grant_type` is `refresh_token`",
                    "example": "yyyyyyyyyyy"
                  }
                },
                "required": [
                  "grant_type"
                ]
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Refreshed token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessToken"
                }
              }
            }
          }
        }
      }
    },
    "/authentication/b2b/login": {
      "post": {
        "summary": "Authenticate a user based on a Stytch session token (B2B version)",
        "description": "Authenticate the user based on the Stytch session token, and return the user information, and API Access Token.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'LoginRequest'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "This error is raised when:\n- The stytch token cannot be authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/authentication/b2b/register": {
      "post": {
        "summary": "Register a user based on a Stytch session token (B2B)",
        "description": "Register the user based on the Stytch session token and name/company name, and return the the created user id.\nThe Stych session token can be obtained from a Magic Links or OAuth token thanks to the registration status API.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/B2bRegisterRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegisterResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'RegisterRequest'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "This error is raised when:\n- The stytch token cannot be authenticated\n- An active user matching the Stytch email cannot be found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/authentication/b2b/registration-status": {
      "post": {
        "summary": "Report whether the user associatd to a Stytch OAuth or Magic Links token has been fully registered on Narrative side (B2B)",
        "description": "Report whether the user associatd to a Stytch OAuth or Magic Links token has been fully registered on Narrative side.\nProvides a Stytch session token that can be used to access the login and register APIs.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/B2bRegistrationStatusRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegistrationStatusResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'RegistrationStatusRequest'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "This error is raised when:\n- The stytch token cannot be authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/authentication/login": {
      "post": {
        "summary": "Authenticate a user based on a Stytch session token",
        "description": "Authenticate the user based on the Stytch session token, and return the user information, and API Access Token.\nThe Stych session token can be obtained from a Magic Links or OAuth token thanks to the registration status API.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'LoginRequest'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "This error is raised when:\n- The stytch token cannot be authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The stytch email has not been validated or has not been provided by the OAuth provider",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "409": {
            "description": "This error is raised when:\n- An active user with the same email already exists\n- An inactive user with the same email already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/authentication/register": {
      "post": {
        "summary": "Register a user based on a Stytch session token",
        "description": "Register the user based on the Stytch session token and name/company name, and return the the created user id.\nThe Stych session token can be obtained from a Magic Links or OAuth token thanks to the registration status API.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegisterResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'RegisterRequest'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "This error is raised when:\n- The stytch token cannot be authenticated\n- An active user matching the Stytch email cannot be found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The stytch email has not been validated or has not been provided by the OAuth provider",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/authentication/registration-status": {
      "post": {
        "summary": "Report whether the user associatd to a Stytch OAuth or Magic Links token has been fully registered on Narrative side",
        "description": "Report whether the user associatd to a Stytch OAuth or Magic Links token has been fully registered on Narrative side.\nProvides a Stytch session token that can be used to access the login and register APIs.",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegistrationStatusRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegistrationStatusResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'RegistrationStatusRequest'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "This error is raised when:\n- The stytch token cannot be authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The stytch email has not been validated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "409": {
            "description": "This error is raised when:\n- An active user with the same email already exists\n- An inactive user with the same email already exists",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/admin/billings/dataset-storage-billing": {
      "get": {
        "summary": "Get dataset storage billing",
        "description": "Get dataset storage billings paginated.",
        "tags": [
          "Billings"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "per_page",
            "required": false,
            "description": "Number of records to return.",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "description": "Number of records to skip (it's usually page_number * per_page).",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetStorageBillingViewResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed"
          }
        }
      }
    },
    "/billings/dataset-storage-billing": {
      "get": {
        "summary": "Get dataset storage billing for company",
        "description": "Get dataset storage billings for a company id paginated.\nCompany id is extracted from token.",
        "tags": [
          "Billings"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "per_page",
            "required": false,
            "description": "Number of records to return.",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "description": "Number of records to skip (it's usually page_number * per_page).",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetStorageBillingViewResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed, or when there are to dataset storage billings for a company"
          }
        }
      }
    },
    "/companies/{company_id}/domains": {
      "get": {
        "summary": "Lists Company Domains",
        "description": "# /companies/{company_id}/domains\n\nReturns all domains registered by a specific company",
        "tags": [
          "Companies"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DomainsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/admin/companies/logo-upload-url": {
      "post": {
        "summary": "Get a presigned URL to upload company logo",
        "description": "Sending a file to Narrative is a two step process.\nThis endpoint allows you to request an `upload_url` which can be used in a `PUT` request to upload the file.\nFor example, once you have received an `upload_url` you could use it as follows:\n\n```bash\ncurl -v --upload-file logo.png {upload_url}\n```\n\nThe generated `upload_url` is only valid for 30 minutes after issuance.\n\nResponse also contains `permanent_url`, `expiry`, and `content_type`.\n`permanent_url` should be used as long-term reference.\n`content_type` should be used as Content-Type header since it is part of URL signature.",
        "tags": [
          "Companies"
        ],
        "security": [
          {}
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UploadImageUrlRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "List of companies",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UploadImageUrlResponse"
                }
              }
            }
          },
          "400": {
            "description": "Extension error, ensure that you're uploading one of supported formats."
          }
        }
      }
    },
    "/companies/{company_id}": {
      "get": {
        "summary": "Get a company",
        "tags": [
          "Company"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicCompanyResponse"
                }
              }
            }
          }
        }
      }
    },
    "/company/{company_id}": {
      "get": {
        "summary": "Get a company",
        "tags": [
          "Company"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CompanyResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete (archive) a company",
        "tags": [
          "Company"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "put": {
        "summary": "Update a company",
        "tags": [
          "Company"
        ],
        "description": "Update the company.\nPlease note that \"slug\" could be changed only once (from null to some value).\nLack of slug (in the request) considered as change to null and passes validation if current value is null too.\nStatus can be changed from pending to active but not in the opposite direction.",
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CompanyUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CompanyResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users/{user_id}": {
      "put": {
        "summary": "Update a user",
        "tags": [
          "Company"
        ],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "description": "The user id",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/schemas_UserId"
            }
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserUpdateResponse"
                }
              }
            }
          }
        }
      }
    },
    "/company-info/data-stream-markets": {
      "get": {
        "summary": "Get all data-streams provider companies",
        "description": "Returns all the companies providing data-stream market offers.",
        "tags": [
          "Company Marketing Information"
        ],
        "security": [
          {}
        ],
        "responses": {
          "200": {
            "description": "Returns the marketing detail of a specific company.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedCompanyInfoResponse"
                }
              }
            }
          }
        }
      }
    },
    "/company-info/whoami": {
      "get": {
        "summary": "Returns the company and user associated with the token",
        "description": "Returns the company and user associated with the token.",
        "tags": [
          "Company Marketing Information"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Returns the marketing detail of a specific company.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WhoAmIResponse"
                }
              }
            }
          }
        }
      }
    },
    "/company-info/{company_id}": {
      "get": {
        "summary": "Get marketing details on a company",
        "description": "Returns the marketing detailed information on a company.",
        "tags": [
          "Company Marketing Information"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          }
        ],
        "responses": {
          "200": {
            "description": "Returns the marketing detail of a specific company.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CompanyInfo"
                }
              }
            }
          }
        }
      }
    },
    "/connections": {
      "get": {
        "summary": "Searches for connections from a given dataset id",
        "tags": [
          "Connections"
        ],
        "security": [
          {
            "App_Token": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedConnections"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Creates a connection",
        "tags": [
          "Connections"
        ],
        "security": [
          {
            "App_Token": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateConnection"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Connection"
                }
              }
            }
          }
        }
      }
    },
    "/connections/{connection_id}": {
      "get": {
        "summary": "Returns a connection",
        "tags": [
          "Connections"
        ],
        "security": [
          {
            "App_Token": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ConnectionId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Connection"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Archive a connection",
        "tags": [
          "Connections"
        ],
        "security": [
          {
            "App_Token": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ConnectionId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Connection"
                }
              }
            }
          }
        }
      }
    },
    "/admin/contracts": {
      "get": {
        "summary": "Get contracts",
        "description": "Get contracts with details paginated.",
        "tags": [
          "Contracts"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "per_page",
            "required": false,
            "description": "Number of records to return.",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "description": "Number of records to skip (it's usually page_number * per_page).",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContractDetailsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create contract",
        "description": "Create a new contract with rates",
        "tags": [
          "Contracts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateContractRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Return created contract with rates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateContractResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or start/end dates are invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "409": {
            "description": "This error is raised when company does not exists or when the same product already exists.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/admin/contracts/{company_id}": {
      "put": {
        "summary": "Update Contract",
        "description": "Update active contract for a company",
        "parameters": [
          {
            "$ref": "#/components/parameters/Contract_CompanyId"
          }
        ],
        "tags": [
          "Contracts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateContractRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Return created contract with rates",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateContractResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or active contract for company doesn't exist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/admin/contracts/{contract_id}/{revision}": {
      "get": {
        "summary": "Get contract",
        "description": "Return single contract with details by id and revision.",
        "parameters": [
          {
            "in": "path",
            "name": "revision",
            "required": true,
            "description": "Contract revision",
            "schema": {
              "type": "number"
            },
            "example": "1"
          },
          {
            "in": "path",
            "name": "contract_id",
            "required": true,
            "description": "Unique identifier for a contract.",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a6f0"
          }
        ],
        "tags": [
          "Contracts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContractDetails"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or when the company doesn't have contract"
          }
        }
      }
    },
    "/admin/contracts/active/{company_id}": {
      "get": {
        "summary": "Get active contract",
        "description": "Return active contract with details for a company id.",
        "parameters": [
          {
            "$ref": "#/components/parameters/Contract_CompanyId"
          }
        ],
        "tags": [
          "Contracts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContractDetails"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or when the company doesn't have an active contract"
          }
        }
      }
    },
    "/admin/contracts/rate/{company_id}": {
      "get": {
        "summary": "Get rates for active contract",
        "description": "Return all rates for a active contract for company_id",
        "parameters": [
          {
            "$ref": "#/components/parameters/Contract_CompanyId"
          }
        ],
        "tags": [
          "Contracts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContractRatesResponse"
                }
              }
            }
          },
          "400": {
            "description": "If the company doesn't have an active contract"
          }
        }
      }
    },
    "/contracts": {
      "get": {
        "summary": "Get contracts for company",
        "description": "Return all contract with details for a company id.\nCompany id is extracted from token.",
        "tags": [
          "Contracts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContractDetailsResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed."
          }
        }
      }
    },
    "/contracts/active": {
      "get": {
        "summary": "Get active contract for company",
        "description": "Return active contract with details for a company id.\nCompany id is extracted from token.",
        "tags": [
          "Contracts"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ContractDetails"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or when the company doesn't have an active contract"
          }
        }
      }
    },
    "/data-planes": {
      "get": {
        "summary": "List data planes",
        "description": "Retrieve all data planes accessible to the authenticated company.",
        "tags": [
          "Data Planes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetDataPlanesResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a data plane",
        "description": "Create a new data plane owned by the authenticated company.",
        "tags": [
          "Data Planes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDataPlaneRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataPlaneResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-planes/{data_plane_id}": {
      "get": {
        "summary": "Get a data plane by ID",
        "description": "Retrieve a specific data plane owned or shared with the authenticated company.",
        "tags": [
          "Data Planes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "data_plane_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataPlaneResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not Found"
          }
        }
      },
      "delete": {
        "summary": "Archive a data plane",
        "description": "Archive the specified data plane owned by the authenticated company.",
        "tags": [
          "Data Planes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "data_plane_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Archived"
          },
          "404": {
            "description": "Not Found"
          }
        }
      }
    },
    "/data-planes/{data_plane_id}/heartbeat": {
      "post": {
        "summary": "Data plane heartbeat",
        "description": "Send a heartbeat to update the last active timestamp of the data plane.",
        "tags": [
          "Data Planes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "data_plane_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "404": {
            "description": "Data plane not found"
          }
        }
      }
    },
    "/data-planes/{data_plane_id}/collaborators/{collaborator_company_id}": {
      "put": {
        "summary": "Add a collaborator to a data plane",
        "description": "Grants the specified company access to the given data plane.",
        "tags": [
          "Data Planes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "data_plane_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "collaborator_company_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Collaborator added"
          },
          "404": {
            "description": "Data plane or collaborator not found"
          }
        }
      },
      "delete": {
        "summary": "Remove a collaborator from a data plane",
        "description": "Revokes the specified company's access to the given data plane.",
        "tags": [
          "Data Planes"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "data_plane_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "collaborator_company_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Collaborator removed"
          },
          "404": {
            "description": "Data plane or collaborator not found"
          }
        }
      }
    },
    "/data-shop": {
      "post": {
        "summary": "Create a data-shop.",
        "description": "Create a new data-shop.",
        "tags": [
          "Data Shops"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDataShopRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataShop"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised if the json is malformed or can't be decoded into 'CreateDataShopRequest'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          }
        }
      }
    },
    "/data-shop/{data_shop_id}": {
      "get": {
        "summary": "Get a data-shop by its id.",
        "description": "Gets the data-shop given its uuid.",
        "tags": [
          "Data Shops"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DataShopId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataShop"
                }
              }
            }
          },
          "404": {
            "description": "If the data-shop with that id doesn't exist"
          }
        }
      },
      "patch": {
        "summary": "Update a data-shop.",
        "description": "Update a new data-shop.\n\n**Note**: Not passing a `fe_manifest` will remove the `fe_manifest` from the data-shop `manifest`.\n\nOnly a user belonging to the company can update a data-shop.",
        "tags": [
          "Data Shops"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DataShopId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateDataShopRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataShop"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised if the json is malformed or can't be decoded into a 'UpdateDataShopRequest'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "404": {
            "description": "If the data-shop with that id doesn't exist"
          }
        }
      }
    },
    "/data-shop/hostname/{host_name}": {
      "get": {
        "summary": "Get a data-shop by its host name.",
        "description": "Gets the data-shop given its host name.",
        "tags": [
          "Data Shops"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Hostname"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataShop"
                }
              }
            }
          },
          "404": {
            "description": "If the data-shop fot that host doesn't exist"
          }
        }
      }
    },
    "/data-shop/ids": {
      "post": {
        "summary": "Fetch many data-shops",
        "description": "Fetch many data-shops, given their `ids`.\n\nAllows only upto 200 data-shops to be fetched in a call. If no `ids` are requested, empty array result is returned.",
        "tags": [
          "Data Shops"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DataShopIds"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataShop"
                }
              }
            }
          },
          "400": {
            "description": "The following error is raised as a bad request.\n\n    \"too-many-ids\" — This endoint only allows fetching upto 200 documents a call. If more are requsted then this\n      error-code is raised.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          }
        }
      }
    },
    "/data-shop/company/{company_id}": {
      "get": {
        "summary": "Get all data-shops for a company.",
        "description": "Gets all data-shops belonging to a company or empty if non exist.",
        "tags": [
          "Data Shops"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataShops"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream": {
      "post": {
        "summary": "Create a data-stream.",
        "description": "Create a new data-stream.\n\nAny datasets involved in the data-stream should exist and be active. Any fields referred",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DataStreamCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised if the json is malformed or can't be decoded into 'DataStreamCreateRequest',\ndata rules are invalid or, the dataset itself doesn't exist or is inactive.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "409": {
            "description": "This error is raised if the slug is already in use.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/{data_stream_id}": {
      "get": {
        "summary": "Get a data-stream by its id.",
        "description": "Gets the data-stream given its uuid.",
        "tags": [
          "Data Streams"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DataStreamId"
          }
        ],
        "security": [
          {}
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream"
                }
              }
            }
          },
          "404": {
            "description": "If the data-stream with that id doesn't exist"
          }
        }
      },
      "put": {
        "summary": "Update a data-stream.",
        "description": "Update a new data-stream.\n\nThe main idea: get a data-stream document/resource, after creation or accessing by id,\nthen update the document and PUT it as it is.\n\nOf course certain things aren't updateable and are ignored,\nfor instance identifiers already established (like DS id) and\nmetadata like creation/update dates and who created/updated the entity.\n\nThings that can be updated\n\n- name\n- slug\n- content\n- tags\n- category\n- offers\n- data_rules\n- auth_rules\n\n**Note**: nested structures like content etc. are changed as complete structures,\nhence care needs to be taken to include unchanged data at as the same time as the data being changed so as not to\nover-write the rest of it.\n\nAny validations applicable on creation time also apply on updates.\n\nOnly a user belonging to the company can update a data-stream.",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DataStreamId"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DataStream"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised if the json is malformed or can't be decoded into a 'DataStream' or,\ndata rules are invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "404": {
            "description": "If the data-stream with that id doesn't exist"
          },
          "409": {
            "description": "This error is raised if the slug is already in use.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/ids": {
      "post": {
        "summary": "Fetch many data-streams",
        "description": "Fetch many data-streams, given their `ids`.\n\nAllows only upto 50 data-streams to be fetched in a call. If no `ids` are requested, empty array result is returned.\n\n**Note**: If `n` `ids` are requested this might return any `m` `(0 <= m <= n)` number of data-streams depending on\nhow many actually do exist. It is the clients duty to find this discrepancy.",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DataStreamIds"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          },
          "400": {
            "description": "The following error is raised as a bad request.\n\n    \"too-many-ids\" — This endoint only allows fetching upto 50 documents a call. If more are requsted then this\n      error-code is raised.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/company/{company_id}": {
      "get": {
        "summary": "Get all data-streams for a company.",
        "description": "Gets all data-streams belonging to a company or empty if non exist.",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/company/{company_id}/search": {
      "get": {
        "summary": "Get all data-streams for a company given a search expression.",
        "description": "Gets all data-streams belonging to a company and the given search expression.\n\nSearch expressions follow the postgres 'websearch_to_tsquery' specification:\n\n1. logical operators : `tshirt and apparel or accessories -leather`\n2. phrases           : `\"find this\"  -\"but not this\"`\n3. multiple words    : `goods services`  (this is the same as `goods and services`)\n\nReference: https://www.postgresql.org/docs/11/textsearch-controls.html#TEXTSEARCH-PARSING-QUERIES search for 'websearch_to_tsquery'",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SearchQueryParam"
          },
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/company/{company_id}/slug/{slug}": {
      "get": {
        "summary": "Gets the data-stream for a given company and slug.",
        "description": "Gets the data-stream for a given company and slug",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          },
          {
            "$ref": "#/components/parameters/Slug"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          },
          "404": {
            "description": "if no companyId and/or slug combination exists"
          }
        }
      }
    },
    "/data-stream/company/{company_id}/slug/{slug}/schema": {
      "get": {
        "summary": "Get schema",
        "description": "Retrieve schema for deliveries from this data stream.",
        "tags": [
          "Data Streams"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          },
          {
            "$ref": "#/components/parameters/Slug"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataSchema"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/company/{company_id}/host/{host_name}": {
      "get": {
        "summary": "Get all data-streams for the given company and its data-shop hostname.",
        "description": "Gets all data-streams belonging to a company, filtered for the hostname.",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          },
          {
            "$ref": "#/components/parameters/Hostname"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          },
          "404": {
            "description": "if no companyid and/or hostname combination exists"
          }
        }
      }
    },
    "/data-stream/company/{company_id}/host/{host_name}/search": {
      "get": {
        "summary": "Find data-streams for the given company and its data-shop hostname and the given search expression.",
        "description": "Gets all data-streams belonging to a company, filtered for the hostname and the given search expression.\n\nSearch expressions follow the postgres 'websearch_to_tsquery' specification:\n\n1. logical operators : `tshirt and apparel or accessories -leather`\n2. phrases           : `\"find this\"  -\"but not this\"`\n3. multiple words    : `goods services`  (this is the same as `goods and services`)\n\nReference: https://www.postgresql.org/docs/11/textsearch-controls.html#TEXTSEARCH-PARSING-QUERIES search for 'websearch_to_tsquery'",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SearchQueryParam"
          },
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          },
          {
            "$ref": "#/components/parameters/Hostname"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/company/{company_id}/sales-channel/{sales_channel}": {
      "get": {
        "summary": "Get all data-streams for a company given a sales channel",
        "description": "Gets all data-streams belonging to a company, given a sales channel.\n\nSales channels:\n  1. data-streams-market\n  2. data-shop",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          },
          {
            "$ref": "#/components/parameters/SalesChannel"
          },
          {
            "$ref": "#/components/parameters/OrderQueryParam"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/company/{company_id}/sales-channel/{sales_channel}/search": {
      "get": {
        "summary": "Find data-streams for the given company and a sales-channel and the given search expression.",
        "description": "Gets all data-streams belonging to a company, filtered for the sales-channel and the given search expression.\n\nSearch expressions follow the postgres 'websearch_to_tsquery' specification:\n\n1. logical operators : `tshirt and apparel or accessories -leather`\n2. phrases           : `\"find this\"  -\"but not this\"`\n3. multiple words    : `goods services`  (this is the same as `goods and services`)\n\nReference: https://www.postgresql.org/docs/11/textsearch-controls.html#TEXTSEARCH-PARSING-QUERIES search for 'websearch_to_tsquery'",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SearchQueryParam"
          },
          {
            "$ref": "#/components/parameters/CompanyId_CompanyId"
          },
          {
            "$ref": "#/components/parameters/SalesChannel"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          }
        }
      }
    },
    "/data-stream/sales-channel/data-streams-market/search": {
      "get": {
        "summary": "Find data-streams available on the data-streams-market.",
        "description": "Gets all data-streams available on the data-streams-market matching the given search expression.\n\nSearch expressions follow the postgres 'websearch_to_tsquery' specification:\n\n1. logical operators : `tshirt and apparel or accessories -leather`\n2. phrases           : `\"find this\"  -\"but not this\"`\n3. multiple words    : `goods services`  (this is the same as `goods and services`)\n\nReference: https://www.postgresql.org/docs/11/textsearch-controls.html#TEXTSEARCH-PARSING-QUERIES search for 'websearch_to_tsquery'",
        "tags": [
          "Data Streams"
        ],
        "security": [
          {}
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SearchQueryParam"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDataStreams"
                }
              }
            }
          }
        }
      }
    },
    "/datasets": {
      "get": {
        "summary": "Get datasets",
        "description": "Return all datasets belonging to the authenticated company.",
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a dataset",
        "description": "Create or register a new dataset.\n\nNewly created datasets are in the `pending` status and require activation.\n\nTo register an empty dataset in Snowflake Dataplane:\n\nIf the request has `data_plane_id` defined but `external_id` is not provided, it will create an empty dataset with the specified schema in `pending` state.\n\nTo trigger creation of such dataset in Snowflake Dataplane, it should call `PUT datasets/<dataset_id>/activate`.",
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DatasetCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'DatasetCreateRequest'.\nInvariants that must be satisfied when decoding the request:\n- The dataset name should be defined\n- The schema must be properly defined\n- The partition key should be a valid pointer to an existing property of one of the following types: boolean, long, string, timestamptz",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update a dataset",
        "description": "Update existing dataset.",
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DatasetCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'DatasetCreateRequest'.\nInvariants that must be satisfied when decoding the request:\n- The dataset name should be defined\n- The schema must be properly defined\n- The partition key should be a valid pointer to an existing property of one of the following types: boolean, long, string, timestamptz",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}": {
      "get": {
        "summary": "Get a dataset",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete a dataset",
        "description": "Permanently removes a dataset from the platform.\n\nDataset deletion cannot be undone.",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "in": "header",
            "name": "X-Narrative-Retention-Days",
            "schema": {
              "type": "string",
              "description": "A number of days between 1 and 30. Defaults to 30."
            }
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "This error is raised when the X-Narrative-Retention-Days header is malformed or can't be decoded into a valid number between 1 and 30.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update a dataset",
        "description": "Update a pending or active dataset.\n\nAll fields can be updated on a pending dataset.\nSchema property metadata (`sensitive`, `required`, `unsellable`) and enumeration (append-only), `description`, `display_name`\ncan be updated on an active dataset. \n\nArchived datasets cannot be updated.",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DatasetUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'DatasetUpdateRequest'.\nInvariants that must be satisfied when decoding the request:\n- The schema (if presented) must be properly defined\n- The partition key (if presented) should be a valid pointer to an existing property of one of the following types: boolean, long, string, timestamptz\n\nThis error can also be raised when:\n- Requesting to update an activated dataset and some immutable field is changed\n- Requesting to update an archived dataset\n- The update request does not contain any changes\n- Downgrading a sensitive field back into a regular field",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/activate": {
      "parameters": [
        {
          "$ref": "#/components/parameters/parameters_DatasetId-2"
        }
      ],
      "put": {
        "summary": "Activate a dataset",
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "description": "Activates a dataset.\n\nThis locks in the schema and allows Narrative to begin ingesting data.",
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "deprecated": true,
        "summary": "Activate a dataset",
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "description": "Activates a dataset.\n\nThis locks in the schema and allows Narrative to begin ingesting data.",
        "responses": {
          "200": {
            "description": "OK",
            "headers": {
              "Warning": {
                "schema": {
                  "type": "string",
                  "description": "299 - POST is deprecated, use PUT instead (2022-01-21 v1.7.59)."
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/truncate": {
      "parameters": [
        {
          "$ref": "#/components/parameters/parameters_DatasetId-2"
        }
      ],
      "post": {
        "summary": "Truncate a dataset",
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "description": "Truncates a dataset.\n\nRemoves all rows from the dataset but leaves the dataset intact.",
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "This error is raised when:\n  - The JSON is malformed or can't be decoded into a valid 'TruncateTableRequest'\n  - The dataset is not active\n  - The dataset is not managed by Narrative (i.e. created from a table/view reference in Snowflake. Not supported to avoid requesting TRUNCATE privilege when getting a reference)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/sample": {
      "get": {
        "summary": "Sample a dataset",
        "description": "Get a sample of rows from a dataset as JSON.",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/SampleSize"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "records": {
                      "type": "array",
                      "description": "A list of rows from the dataset encoded as JSON objects.",
                      "items": {
                        "type": "object"
                      }
                    }
                  },
                  "example": {
                    "records": [
                      {
                        "idValue": "9a200747-86ea-4ab3-a5c5-ce384e4f93dc",
                        "idType": "ADID",
                        "timestamp": "2021-12-10T00:00:00Z"
                      },
                      {
                        "idValue": "6657fa10-4e5f-4ff5-8e46-53ffb1df692f",
                        "idType": "ADID",
                        "timestamp": "2021-12-10T00:00:01Z"
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "description": "Raised when\n  - `size` doesn't lie in the interval `(0, 1000]`\n  - The dataset is not active",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "403": {
            "description": "Raised when the auth token company doesn't own the dataset.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "404": {
            "description": "If the data-stream with that id doesn't exist"
          }
        }
      },
      "delete": {
        "summary": "Delete a sample",
        "description": "Deletes a sample of rows from a dataset.",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          },
          "403": {
            "description": "Raised when the auth token company doesn't own the dataset.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataStream_Error"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/admin": {
      "get": {
        "summary": "Get admin info for a dataset",
        "description": "Get a dataset including information about the backing [Iceberg table](http://iceberg.apache.org/).",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetAdminResponse"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/admin/sample": {
      "get": {
        "summary": "Sample a dataset (Admin)",
        "description": "Get a sample of rows from a dataset as JSON.",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/SampleSize"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "records": {
                      "type": "array",
                      "description": "A list of rows from the dataset encoded as JSON objects.",
                      "items": {
                        "type": "object"
                      }
                    }
                  },
                  "example": {
                    "records": [
                      {
                        "idValue": "9a200747-86ea-4ab3-a5c5-ce384e4f93dc",
                        "idType": "ADID",
                        "timestamp": "2021-12-10T00:00:00Z"
                      },
                      {
                        "idValue": "6657fa10-4e5f-4ff5-8e46-53ffb1df692f",
                        "idType": "ADID",
                        "timestamp": "2021-12-10T00:00:01Z"
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/admin/partition-spec": {
      "post": {
        "summary": "Update a dataset's partition spec",
        "description": "Update the partition specification of the [Iceberg table](http://iceberg.apache.org/) backing the dataset.\n\nSee:\n  - [What is partitioning?](http://iceberg.apache.org/partitioning/)\n  - [Iceberg Specification: Partitioning](http://iceberg.apache.org/spec/#partitioning)",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePartitionSpecRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetAdminResponse"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/retention-policy/preview": {
      "post": {
        "summary": "Preview snapshot expirations",
        "description": "Preview snapshot expirations given a retention policy.",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SnapshotRetentionPolicy"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SnapshotExpirationsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/retention-policy": {
      "put": {
        "summary": "Upsert retention policies for a dataset",
        "description": "Accepts either a legacy payload (snapshot-only) or the unified v1 policy object. The response is always returned in the unified v1 shape with a `compat.mode` indicating whether the server interpreted the request as legacy or v1.\n**Row TTL clock default:** If `row_ttl.enabled=true` and `row_ttl.clock` is omitted, the server will default to the configured Rosetta Stone attribute (nio_last_modified) **if that mapping exists**; otherwise  it returns HTTP 400.\n",
        "tags": [
          "Datasets",
          "Retention Policies"
        ],
        "operationId": "putRetentionPolicy",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "oneOf": [
                  {
                    "$ref": "#/components/schemas/SnapshotRetentionPolicy"
                  },
                  {
                    "$ref": "#/components/schemas/UnifiedV1Request"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetResponse"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/request-sample": {
      "post": {
        "summary": "Request Dataset Sample",
        "description": "Request a dataset sample job (for non-Narrative Data Planes only)",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RequestSampleResponse"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/sample/mappings": {
      "get": {
        "summary": "Sampled Mappings",
        "description": "Returns sampled dataset after attribute mapping for a given `mapping_id`\n\nThis endpoint should be used when mapping exist.\n\nA response is a list of JSON objects, where every object will have an `input` field, that represents the original key/value pairs from the dataset, and the `output` filed that will contain mapped fields where the key will be `attribute name`, and value will be JSON object of key/value pairs.",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "size",
            "required": false,
            "description": "The number of rows to sample from the dataset.",
            "schema": {
              "type": "integer",
              "exclusiveMinimum": 0,
              "maximum": 1000
            }
          },
          {
            "in": "path",
            "name": "dataset_id",
            "required": true,
            "description": "Unique identifier for a dataset.",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object"
                  },
                  "example": [
                    {
                      "mapping_id": "62db1e99-7e0e-46c3-802b-1b13a0ebdb7b",
                      "records": [
                        {
                          "input": {
                            "idType": "idType1",
                            "idValue": "idValue1"
                          },
                          "output": {
                            "unique_id_95b79302_0f80_4cfd_9e43_ea26aa13b9a7": {
                              "type": "idType1"
                            }
                          }
                        },
                        {
                          "input": {
                            "idType": "idType2",
                            "idValue": "idValue2"
                          },
                          "output": {
                            "unique_id_95b79302_0f80_4cfd_9e43_ea26aa13b9a7": {
                              "type": "idType2"
                            }
                          }
                        }
                      ]
                    },
                    {
                      "mapping_id": "f2d14fb8-2c9b-4ade-851e-388bfcd942f1",
                      "records": [
                        {
                          "input": {
                            "idType": "idType1",
                            "idValue": "idValue1"
                          },
                          "output": {
                            "unique_id_322d2d83_d8ec_4808_80be_66d08e446de5": {
                              "value": "idValue1"
                            }
                          }
                        },
                        {
                          "input": {
                            "idType": "idType2",
                            "idValue": "idValue2"
                          },
                          "output": {
                            "unique_id_322d2d83_d8ec_4808_80be_66d08e446de5": {
                              "value": "idValue2"
                            }
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/suggest-mappings": {
      "post": {
        "summary": "Suggest mappings",
        "description": "Schedule the execution of a mappings suggestion job for a given dataset, using the Rosetta Stone API (Snowflake data plane only).",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object"
              }
            }
          },
          "required": false
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuggestMappingsResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when:\n- The request cannot be parsed\n- The dataset belongs to a data plane that does not support the operation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- A user-bound API key has not been provided",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "If the dataset does not exist"
          }
        }
      }
    },
    "/datasets/{dataset_id}/stats": {
      "get": {
        "summary": "Get dataset statistics",
        "description": "Return summary statistics for all ingestion snapshots for a given dataset.\nFor datasets with \"incremental\" updates, each snapshot defines a new incremental upload of data.\nFor datasets with \"overwrite\" updates, each snapshot overwrites the previous data.\n`all_records` query parameter is here because of backward compatibility.\nBy default API is paginated, so if you don't provide both `per_page` and `offset` parameters, you will get only the latest summary.",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/AllRecords"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetSummariesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/columns-stats": {
      "get": {
        "summary": "Get detailed statistics",
        "description": "Get statistics for each column.",
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/HistogramBinLimit"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetColumnStatsResponse"
                }
              }
            }
          },
          "404": {
            "description": "If the dataset does not exist or if the stats have not been added for the dataset\n(in the case of a Non-Narrative data planes)"
          }
        }
      },
      "put": {
        "summary": "Create or Update detailed statistics",
        "description": "Create or Update detailed statistics. Detailed statistics are collected for datasets belonging to the Narrative Data Plane, but\nuploading these stats is necessary for non-Narrative data planes, since Narrative does not have access to the data to compute these statistics.",
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpsertColumnStatsRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "OK"
          },
          "400": {
            "description": "This error is raised when:\n- The request cannot be parsed\n- Stats are missing for some columns\n- Stats are provided for columns not specified in the dataset schema",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "If the dataset does not exist"
          }
        }
      }
    },
    "/datasets/{dataset_id}/columns-stats/recalculate": {
      "post": {
        "summary": "Submit recalculation",
        "description": "Run recalculation for the dataset.",
        "tags": [
          "Datasets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "from_snapshot": {
                    "type": "string",
                    "description": "Start of the recalculation range"
                  }
                }
              }
            }
          },
          "required": false
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RecalculationResponse"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/upload": {
      "post": {
        "summary": "Ingest a file",
        "description": "After uploading a file to Narrative via the `upload` API, you can then have the file can then be ingested into a dataset.\n\nRelated guides:\n  - [How do I create a dataset?](https://kb.narrative.io/how-do-i-create-a-dataset): see the section titled **Upload Files for Ingestion**.",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FileIngestionRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/datasets/{dataset_id}/snapshots/{snapshot_id}/files-added": {
      "get": {
        "summary": "Files added",
        "description": "Lists files added by a snapshot",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/SnapshotId"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FilesAdded"
                }
              }
            }
          },
          "403": {
            "description": "Download of files belonging to snapshots that are older than 30 days is not permitted."
          },
          "404": {
            "description": "Either the dataset or the snapshot don't exist or the token has no permissions to access them."
          }
        }
      }
    },
    "/datasets/{dataset_id}/find-snapshots": {
      "get": {
        "summary": "Find snapshots",
        "description": "Lists snapshots and associated files",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          },
          {
            "$ref": "#/components/parameters/FromTimestamp"
          },
          {
            "$ref": "#/components/parameters/UntilTimestamp"
          },
          {
            "$ref": "#/components/parameters/ToTimestamp"
          },
          {
            "$ref": "#/components/parameters/FromSnapshot"
          },
          {
            "$ref": "#/components/parameters/UntilSnapshot"
          },
          {
            "$ref": "#/components/parameters/ToSnapshot"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DetailedSnapshotListResponse"
                }
              }
            }
          },
          "400": {
            "description": "Inappropriately specified range(s) or non-existing snapshot."
          },
          "404": {
            "description": "Either the dataset or the snapshot don't exist or the token has no permissions to access them."
          }
        }
      }
    },
    "/datasets/{dataset_id}/metrics": {
      "get": {
        "summary": "Metrics",
        "description": "Lists metrics for a dataset",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetStatistics"
                }
              }
            }
          },
          "404": {
            "description": "Either the dataset or any metrics don't exist or the token has no permissions to access them."
          }
        }
      }
    },
    "/datasets/{dataset_id}/snapshots/{snapshot_id}/column-stats": {
      "get": {
        "summary": "Metrics",
        "description": "Metrics for a snapshot",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/SnapshotId"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AllColumnsStatistics"
                }
              }
            }
          },
          "404": {
            "description": "Either the snapshot or any metrics don't exist or the token has no permissions to access them."
          }
        }
      }
    },
    "/datasets/{dataset_id}/stats-config": {
      "put": {
        "summary": "Put Metrics Configuration",
        "description": "Put new version of configuration.",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PutMetricConfigRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PutMetricConfigResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Disable configuration",
        "description": "Disable configuration, metrics won't be calculated",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DisableMetricConfigResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "Get Metrics Configuration",
        "description": "Put new version of configuration.",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GetMetricConfigResponse"
                }
              }
            }
          },
          "404": {
            "description": "Either the dataset or config don't exist or the token has no permissions to access them."
          }
        }
      }
    },
    "/datasets/{dataset_id}/derive-stats-config": {
      "put": {
        "summary": "Derive the configuration",
        "description": "Creates new request for request derivation",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/datasets/{dataset_id}/enable-stats-config": {
      "post": {
        "summary": "Enable configuration",
        "description": "Enable configuration if it exists",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EnableMetricConfigResponse"
                }
              }
            }
          },
          "404": {
            "description": "Either the dataset or any config don't exist or the token has no permissions to access them."
          }
        }
      }
    },
    "/datasets/{dataset_id}/find-files": {
      "get": {
        "summary": "Find files",
        "description": "Lists snapshots and associated files",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/PerPage"
          },
          {
            "$ref": "#/components/parameters/Offset"
          },
          {
            "$ref": "#/components/parameters/FromTimestamp"
          },
          {
            "$ref": "#/components/parameters/FromSnapshot"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DatasetFileListResponse"
                }
              }
            }
          },
          "400": {
            "description": "Specified snapshot doesn't exist."
          },
          "404": {
            "description": "Either the dataset doesn't exist or the token has no permissions to access them."
          }
        }
      }
    },
    "/datasets/{dataset_id}/snapshots/{snapshot_id}/files-added/{file_id}/download": {
      "post": {
        "summary": "Issue file download url",
        "description": "Retrieve the download URL for a file",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          },
          {
            "$ref": "#/components/parameters/SnapshotId"
          },
          {
            "$ref": "#/components/parameters/FileId"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DownloadUrl"
                }
              }
            }
          },
          "404": {
            "description": "Either the dataset, the snapshot, or the file don't exist or the token has no permissions to access them."
          },
          "451": {
            "description": "File is expired according to its policy and can not be downloaded.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FileExpired"
                }
              }
            }
          }
        }
      }
    },
    "/datasets/{dataset_id}/refresh-schedule": {
      "put": {
        "summary": "Update the materialized view refresh configuration",
        "description": "Creates new request for request derivation",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateMaterializedViewRefreshRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "post": {
        "summary": "Create a refresh schedule for an existing materialized view",
        "description": "Creates new request for request derivation",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateMaterializedViewRefreshRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      },
      "delete": {
        "summary": "Archive the materialized view refresh configuration",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/datasets/{dataset_id}/refresh-materialized-view": {
      "post": {
        "summary": "Run a materialized view refresh now",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_DatasetId-2"
          }
        ],
        "tags": [
          "Datasets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TriggerMaterializedViewRefresh"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/destinations": {
      "post": {
        "summary": "Creates a destination",
        "tags": [
          "Destinations"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DestinationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Destination"
                }
              }
            }
          }
        }
      }
    },
    "/destinations/{destination_id}": {
      "get": {
        "summary": "Get a destination by id",
        "tags": [
          "Destinations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DestinationId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Destination"
                }
              }
            }
          },
          "404": {
            "description": "If the destination with that id doesn't exist"
          }
        }
      },
      "put": {
        "summary": "Updates the values of the quick settings",
        "tags": [
          "Destinations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DestinationId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/QuickSettings"
              },
              "example": {
                "bucket_suffix": "/my-subscription",
                "number_of_files": "5"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Destination"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Removes the destination from a subscription",
        "tags": [
          "Destinations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DestinationId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/destinations/subscription_id={subscription_id}": {
      "get": {
        "summary": "Search destinations for a subscription",
        "tags": [
          "Destinations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDestinations"
                }
              }
            }
          }
        }
      }
    },
    "/destinations/profile_id={profile_id}": {
      "get": {
        "summary": "Search destinations for a profile",
        "tags": [
          "Destinations"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_ProfileId-2"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedDestinations"
                }
              }
            }
          }
        }
      }
    },
    "/encryption-materials": {
      "get": {
        "summary": "List encryption materials",
        "description": "List encryption materials",
        "tags": [
          "Encryption Materials"
        ],
        "security": [
          {
            "BearerAuth": []
          },
          {
            "DataPlaneSecretAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/list_response"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The token used to authenticate the request is not associated with a company",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create an encryption material",
        "description": "Create an encryption material",
        "tags": [
          "Encryption Materials"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/create_request"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/create_response"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when:\n- The request cannot be parsed\n- The provided name is invalid\n- The provided permissions are invalid\n- The provided expiration date is invalid",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "403": {
            "description": "This error is raised when:\n- The token used to authenticate the request is not associated with a company",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/encryption-materials/{encryption_material_id}": {
      "delete": {
        "summary": "Archive a connection",
        "tags": [
          "Encryption Materials"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/EncryptionMaterialId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/installations": {
      "get": {
        "summary": "Lists all installations",
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_AppCategory"
          }
        ],
        "tags": [
          "Installations"
        ],
        "description": "Tests whether the whole stack is setup.",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Everything is fine",
            "content": {
              "application/json": {}
            }
          }
        }
      }
    },
    "/jobs": {
      "get": {
        "summary": "Get jobs",
        "description": "Returns a list of jobs associated with the specified company, including job ID, job type, timestamp information, and results.\n\nIt returns a maximum of 500 jobs at a time to manage response size.",
        "tags": [
          "Jobs"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/data_plane_id"
          },
          {
            "$ref": "#/components/parameters/dataset_id"
          },
          {
            "$ref": "#/components/parameters/offset"
          },
          {
            "$ref": "#/components/parameters/order_by"
          },
          {
            "$ref": "#/components/parameters/per_page"
          },
          {
            "$ref": "#/components/parameters/state"
          },
          {
            "$ref": "#/components/parameters/type"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/jobs/{job_id}": {
      "get": {
        "summary": "Get a job",
        "description": "This endpoint retrieves all details associated with a specific job ID from the jobs table.",
        "tags": [
          "Jobs"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/JobId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobResponse"
                }
              }
            }
          },
          "404": {
            "description": "This error is raised when the job cannot be found"
          }
        }
      }
    },
    "/mappings": {
      "get": {
        "summary": "Get mappings",
        "description": "Return all mappings, both private and global.",
        "tags": [
          "Mappings"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "attribute_id",
            "required": false,
            "description": "Attribute identifier. Can be specified multiple times to retrieve mappings for multiple attributes.",
            "style": "spaceDelimited",
            "explode": true,
            "schema": {
              "type": "array",
              "items": {
                "type": "integer"
              }
            }
          },
          {
            "in": "query",
            "name": "dataset_id",
            "required": false,
            "description": "Dataset identifier. Can be specified multiple times to retrieve mappings for multiple datasets.",
            "style": "spaceDelimited",
            "explode": true,
            "schema": {
              "type": "array",
              "items": {
                "type": "integer"
              }
            }
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a global mapping",
        "description": "Create a new global mapping.\n\nOnly admins can use this endpoint.",
        "tags": [
          "Mappings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MappingCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          }
        }
      }
    },
    "/mappings/system": {
      "get": {
        "summary": "Get system mappings",
        "description": "Return all `system` mappings.\n\nOnly admins can call this endpoint.",
        "tags": [
          "Mappings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a system mapping",
        "description": "Create a `system` mapping.\n\nOnly admins can call this endpoint.",
        "tags": [
          "Mappings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MappingCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          }
        }
      }
    },
    "/mappings/{mapping_id}": {
      "get": {
        "summary": "Get mapping",
        "description": "Return a specific mapping based on its id.",
        "tags": [
          "Mappings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/MappingId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update a mapping",
        "description": "Update the definition of a mapping between an attribute and a dataset.\n\nNote: the attribute and dataset with which a mapping is associated cannot be updated.",
        "tags": [
          "Mappings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/MappingId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MappingUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete a mapping",
        "description": "Mapping deletion cannot be undone.\n\nIf the mapping is still being used then this request fails.\n\nBoth owners (users belonging to the company the mapping belongs to) and admins can delete a mapping.",
        "parameters": [
          {
            "$ref": "#/components/parameters/MappingId"
          }
        ],
        "tags": [
          "Mappings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/mappings/{mapping_id}/accept": {
      "post": {
        "summary": "Accept a mapping",
        "description": "Accept a `system` proposed mapping, i.e. move it from the `status` of `pending` to `active`.\n\nThe mapping has to be `system` proposed and not `archived`.\n\nBoth owners (users belonging to the company the mapping belongs to) and admins can promote a mapping.",
        "tags": [
          "Mappings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/MappingId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          }
        }
      }
    },
    "/mappings/{mapping_id}/promote": {
      "post": {
        "summary": "Promote a mapping",
        "description": "Promote a `private` mapping, i.e. create a new mapping taht is available globally.\n\nA new mapping is created that is a copy of the source mapping, with its `scope` set to `global`.\nThis new mapping has its `derived_from` property set to the `id` of its source mapping.\n\nThe original mapping is left untouched.\n\nThe mapping has to be `private` and not `archived`.\n\nOnly admins can promote a mapping.",
        "tags": [
          "Mappings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/MappingId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          }
        }
      }
    },
    "/mappings/companies/{company_id}": {
      "get": {
        "summary": "Get mappings for a company",
        "description": "Return all private mappings related to a specific company based on its id",
        "tags": [
          "Mappings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_CompanyId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a private mapping",
        "description": "Create a private mapping.",
        "tags": [
          "Mappings"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_CompanyId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MappingCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Ok",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingResponse"
                }
              }
            }
          }
        }
      }
    },
    "/mappings/{mapping_id}/sample": {
      "get": {
        "summary": "Get mapping preview",
        "description": "Returns sampled dataset after attribute mapping for a given `mapping_id`\n\nThis endpoint should be used when mapping exist.\n\nA response is a list of JSON objects, where every object will have an `input` field, that represents the original key/value pairs from the dataset, and the `output` filed that will contain mapped fields where the key will be `attribute name`, and value will be JSON object of key/value pairs.",
        "tags": [
          "Mappings"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "size",
            "required": false,
            "description": "The number of rows to sample from the dataset.",
            "schema": {
              "type": "integer",
              "exclusiveMinimum": 0,
              "maximum": 1000
            }
          },
          {
            "in": "path",
            "name": "mapping_id",
            "required": true,
            "description": "Unique identifier for a mapping.",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "ea9dddd2-e3ee-40b5-b03e-c3cd37c8a6f0"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingPreviewResponse"
                }
              }
            }
          }
        }
      }
    },
    "/mappings/test": {
      "post": {
        "summary": "Test Mapping",
        "description": "Returns sampled dataset after attribute mapping for a given mapping.\n\nThis endpoint should be used when mapping does not exist.\n\nA response is a list of JSON objects, where every object will have an `input` field, that represents the original key/value pairs from the dataset, and the `output` filed that will contain mapped fields where the key will be `attribute name`, and value will be JSON object of key/value pairs.",
        "tags": [
          "Mappings"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "size",
            "required": false,
            "description": "The number of rows to sample from the dataset.",
            "schema": {
              "type": "integer",
              "exclusiveMinimum": 0,
              "maximum": 1000
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MappingCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MappingPreviewResponse"
                }
              }
            }
          }
        }
      }
    },
    "/model-inference/run": {
      "post": {
        "summary": "Run model inference",
        "description": "Create a job to perform an LLM call. Supported on both AWS and Snowflake data planes.",
        "tags": [
          "Model Inference"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RunRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RunResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed or can't be decoded into a valid 'RunResponse'.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/nql/validate": {
      "post": {
        "summary": "Validate an NQL query",
        "description": "The validate endpoint in the NQL API allows users to verify the syntax and structure\nof their NQL queries before executing them. This ensures that the queries are correctly\nformatted and will not cause errors when passing through the /run endpoint.\nThe primary goal of using the validate endpoint is to receive a 200 OK status code,\nwhich indicates that the query is valid.",
        "tags": [
          "NQL"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "nql"
                ],
                "properties": {
                  "nql": {
                    "$ref": "#/components/schemas/NQL"
                  },
                  "data_plane_id": {
                    "$ref": "#/components/schemas/DataPlaneId"
                  }
                }
              },
              "example": {
                "nql": "CREATE MATERIALIZED VIEW \"dataset_name\" AS SELECT \"company_data\".\"1\".x AS xx, \"company_data\".\"1\".y AS yy, \"company_data\".\"1\".z AS zz, \"company_data\".\"1\".x + \"company_data\".\"1\".y + \"company_data\".\"1\".z AS xyz_sum FROM \"company_data\".\"1\""
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Ast"
                },
                "examples": {
                  "create_materialized_view": {
                    "summary": "create materialized view",
                    "description": "NQL Query:\n\n```sql\nCREATE MATERIALIZED VIEW  \"dataset_name\" AS\nSELECT\n  \"company_data\".\"1\".x AS xx,\n  \"company_data\".\"1\".y AS yy,\n  \"company_data\".\"1\".z AS zz,\n  \"company_data\".\"1\".x +  \"company_data\".\"1\".y +  \"company_data\".\"1\".z AS xyz_sum\nFROM  \"company_data\".\"1\"\"\n```",
                    "value": {
                      "type": "create_materialized_view",
                      "nql": "CREATE MATERIALIZED VIEW \"dataset_name\" AS SELECT \"company_data\".\"1\".x AS xx, \"company_data\".\"1\".y AS yy, \"company_data\".\"1\".z AS zz, \"company_data\".\"1\".x + \"company_data\".\"1\".y + \"company_data\".\"1\".z AS xyz_sum FROM \"company_data\".\"1\"",
                      "name": "dataset_name",
                      "select": {
                        "type": "select",
                        "nql": "SELECT \"company_data\".\"1\".x AS xx, \"company_data\".\"1\".y AS yy, \"company_data\".\"1\".z AS zz, \"company_data\".\"1\".x + \"company_data\".\"1\".y + \"company_data\".\"1\".z AS xyz_sum FROM \"company_data\".\"1\"",
                        "columns": [
                          {
                            "as": "xx",
                            "nql": "\"company_data\".\"1\".x AS xx",
                            "type": "column",
                            "db": null,
                            "schema": "company_data",
                            "table": "1",
                            "column": "x",
                            "metadata": {
                              "column_type": "column"
                            }
                          },
                          {
                            "as": "yy",
                            "nql": "\"company_data\".\"1\".y AS yy",
                            "type": "column",
                            "db": null,
                            "schema": "company_data",
                            "table": "1",
                            "column": "y",
                            "metadata": {
                              "column_type": "column"
                            }
                          },
                          {
                            "as": "zz",
                            "nql": "\"company_data\".\"1\".z AS zz",
                            "type": "column",
                            "db": null,
                            "schema": "company_data",
                            "table": "1",
                            "column": "z",
                            "metadata": {
                              "column_type": "column"
                            }
                          },
                          {
                            "as": "xyz_sum",
                            "nql": "\"company_data\".\"1\".x + \"company_data\".\"1\".y + \"company_data\".\"1\".z AS xyz_sum",
                            "type": "binary_op",
                            "name": "+",
                            "left": {
                              "type": "binary_op",
                              "nql": "\"company_data\".\"1\".x + \"company_data\".\"1\".y",
                              "name": "+",
                              "left": {
                                "type": "column",
                                "nql": "\"company_data\".\"1\".x",
                                "db": null,
                                "schema": "company_data",
                                "table": "1",
                                "column": "x",
                                "metadata": {
                                  "column_type": "column"
                                }
                              },
                              "right": {
                                "type": "column",
                                "nql": "\"company_data\".\"1\".y",
                                "db": null,
                                "schema": "company_data",
                                "table": "1",
                                "column": "y",
                                "metadata": {
                                  "column_type": "column"
                                }
                              }
                            },
                            "right": {
                              "type": "column",
                              "nql": "\"company_data\".\"1\".z",
                              "db": null,
                              "schema": "company_data",
                              "table": "1",
                              "column": "z",
                              "metadata": {
                                "column_type": "column"
                              }
                            }
                          }
                        ],
                        "from": {
                          "type": "table",
                          "nql": "\"company_data\".\"1\"",
                          "db": null,
                          "schema": "company_data",
                          "table": "1",
                          "metadata": {
                            "id": 1,
                            "name": "dataset_name_1",
                            "table_type": "dataset"
                          }
                        },
                        "group_by": [],
                        "having": null,
                        "is_distinct": false,
                        "limit": null,
                        "order_by": [],
                        "qualify": null,
                        "where": null,
                        "windows": [],
                        "with": []
                      }
                    }
                  },
                  "explain": {
                    "summary": "explain",
                    "description": "```sql\nexplain\nselect\n  \"company_data\".\"1\".s,\n  \"company_data\".\"1\".arr\nfrom \"company_data\".\"1\"\nwhere \"company_data\".\"1\".x > -10.0\n```",
                    "value": {
                      "type": "explain",
                      "nql": "EXPLAIN SELECT \"company_data\".\"1\".s, \"company_data\".\"1\".arr FROM \"company_data\".\"1\" WHERE \"1\".x > CAST(-10.0 AS DOUBLE)",
                      "query": {
                        "type": "select",
                        "nql": "SELECT \"company_data\".\"1\".s, \"company_data\".\"1\".arr FROM \"company_data\".\"1\" WHERE \"1\".x > CAST(-10.0 AS DOUBLE)",
                        "columns": [
                          {
                            "type": "column",
                            "nql": "\"company_data\".\"1\".s",
                            "db": null,
                            "schema": "company_data",
                            "table": "1",
                            "column": "s",
                            "metadata": {
                              "column_type": "column"
                            }
                          },
                          {
                            "type": "column",
                            "nql": "\"company_data\".\"1\".arr",
                            "db": null,
                            "schema": "company_data",
                            "table": "1",
                            "column": "arr",
                            "metadata": {
                              "column_type": "column"
                            }
                          }
                        ],
                        "from": {
                          "type": "table",
                          "nql": "\"company_data\".\"1\"",
                          "db": null,
                          "schema": "company_data",
                          "table": "1",
                          "metadata": {
                            "id": 1,
                            "name": "dataset_name_1",
                            "table_type": "dataset"
                          }
                        },
                        "group_by": [],
                        "having": null,
                        "is_distinct": false,
                        "limit": null,
                        "order_by": [],
                        "qualify": null,
                        "where": {
                          "type": "binary_op",
                          "nql": "\"1\".x > CAST(-10.0 AS DOUBLE)",
                          "name": ">",
                          "left": {
                            "type": "column",
                            "nql": "\"1\".x",
                            "db": null,
                            "schema": "company_data",
                            "table": "1",
                            "column": "x",
                            "metadata": {
                              "column_type": "column"
                            }
                          },
                          "right": {
                            "type": "literal",
                            "nql": "-10.0",
                            "value_type": {
                              "type": "double"
                            },
                            "value": "-10.0"
                          }
                        },
                        "windows": [],
                        "with": []
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request\nvisit https://www.narrative.io/knowledge-base/support-troubleshooting/nql for more details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Response"
                }
              }
            }
          }
        }
      }
    },
    "/nql/run": {
      "post": {
        "summary": "Run a NQL Query",
        "description": "The run endpoint in the NQL API allows users to execute their NQL queries.\nThis endpoint processes the query and performs the specified operations\nwithin the specified data plane. Depending on the NQL provided, the run\nendpoint can create materialized views or generate forecasts.",
        "tags": [
          "NQL"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "nql"
                ],
                "properties": {
                  "nql": {
                    "$ref": "#/components/schemas/NQL"
                  },
                  "data_plane_id": {
                    "$ref": "#/components/schemas/DataPlaneId"
                  }
                }
              },
              "example": {
                "nql": "CREATE MATERIALIZED VIEW \"dataset_name\" AS SELECT \"company_data\".\"1\".x AS xx, \"company_data\".\"1\".y AS yy, \"company_data\".\"1\".z AS zz, \"company_data\".\"1\".x + \"company_data\".\"1\".y + \"company_data\".\"1\".z AS xyz_sum FROM \"company_data\".\"1\""
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NQL_RunResponse"
                },
                "examples": {
                  "create_materialized_view": {
                    "summary": "create materialized view",
                    "description": "NQL Query:\n\n```sql\nCREATE MATERIALIZED VIEW \"test_gui\"\n  EXPIRE = 'retain_everything'\n  WRITE_MODE = 'append'\n  EXTENDED_STATS = 'all' AS\nSELECT\n  1 as a,\n  2 as b\n```",
                    "value": {
                      "id": "7352a290-dea9-4932-b7d3-66723e145259",
                      "company_id": 1,
                      "completed_at": null,
                      "created_at": "2025-04-14T17:33:24.941123Z",
                      "failures": [],
                      "idempotency_key": "3c7afdbb-1b2a-458b-a8bf-ac7b7942cb6c",
                      "input": {
                        "compiled_select": "SELECT\n  *\nFROM\n  (VALUES\n      (1, 2)) `t` (`a`, `b`)",
                        "create_as_view": false,
                        "dataset": {
                          "id": 23499,
                          "company_id": 1,
                          "created_at": "2025-04-14T17:33:23.500965Z",
                          "data_plane": {
                            "type": "owned",
                            "id": "f79cbdae-4848-47ca-95e8-69588364d185",
                            "company_id": 1,
                            "created_at": "2016-01-01T00:00:00Z",
                            "description": "...",
                            "display_name": "Narrative Data Collaboration Platform (us-east-1)",
                            "external_id": "704349335716",
                            "platform": {
                              "type": "platform_aws",
                              "account_id": "704349335716",
                              "region": {
                                "type": "region_aws",
                                "id": "us-east-1"
                              }
                            },
                            "status": "active",
                            "updated_at": "2024-01-12T00:00:00Z",
                            "collaborators": {
                              "participants": {
                                "type": "all"
                              }
                            }
                          },
                          "display_name": "test_gui",
                          "is_narrative_managed": true,
                          "materialized_view_config": {
                            "nql": "SELECT 1 AS a, 2 AS b"
                          },
                          "name": "test_gui",
                          "retention_policy": {
                            "type": "retain_everything"
                          },
                          "schema": {
                            "file_config": {
                              "type": "json"
                            },
                            "type": "object",
                            "properties": {
                              "a": {
                                "display_name": "a",
                                "type": "long"
                              },
                              "b": {
                                "display_name": "b",
                                "type": "long"
                              }
                            }
                          },
                          "status": "pending",
                          "tags": [
                            "_nio_materialized_view"
                          ],
                          "updated_at": "2025-04-14T17:33:23.500965Z",
                          "write_mode": "append"
                        },
                        "nql": "SELECT 1 AS a, 2 AS b"
                      },
                      "request_source": {
                        "type": "api_user",
                        "company_id": 1,
                        "user_id": 1414
                      },
                      "result": null,
                      "state": "pending",
                      "updated_at": "2025-04-14T17:33:24.941123Z"
                    }
                  },
                  "explain": {
                    "summary": "explain",
                    "description": "To run a forecast query, add the `EXPLAIN` keyword at the beginning of the query\n```sql\nEXPLAIN\nSELECT hashed_email\nFROM company_data.\"23021\"\n```",
                    "value": {
                      "id": "ab97b835-216f-4048-aabf-e2ac22e563fc",
                      "company_id": 1,
                      "completed_at": null,
                      "created_at": "2025-04-14T17:44:46.843651Z",
                      "failures": [],
                      "idempotency_key": "4d864006-9b4d-4376-a4a9-c43393b24fbe",
                      "input": {
                        "nql": "EXPLAIN select hashed_email from company_data.\"23021\"",
                        "compiled_sql": "SELECT\n  SUM(NAMED_STRUCT('price_micro_cents_usd', 0, 'count_multiplier', 1)['price_micro_cents_usd'] * NAMED_STRUCT('price_micro_cents_usd', 0, 'count_multiplier', 1)['count_multiplier']) `totalCost`,\n  SUM(NAMED_STRUCT('price_micro_cents_usd', 0, 'count_multiplier', 1)['count_multiplier']) `totalRows`\nFROM\n  narrative.datasets.ds_23021"
                      },
                      "request_source": {
                        "type": "api_user",
                        "company_id": 1,
                        "user_id": 1414
                      },
                      "result": null,
                      "state": "pending",
                      "updated_at": "2025-04-14T17:44:46.843651Z"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request\nvisit https://www.narrative.io/knowledge-base/support-troubleshooting/nql for more details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Response"
                }
              }
            }
          }
        }
      }
    },
    "/nql/{job_id}": {
      "get": {
        "summary": "Get the result of a NQL forecast",
        "description": "This endpoint is used to poll forecast result after it's ran.",
        "tags": [
          "NQL"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/JobId"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForecastRunResponse"
                },
                "examples": {
                  "pending": {
                    "summary": "Pending NQL forecast",
                    "value": {
                      "id": "ef628399-1c83-44ff-8525-69c3796cfc7c",
                      "company_id": 1,
                      "completed_at": null,
                      "created_at": "2025-04-11T23:37:40.796820Z",
                      "failures": [],
                      "idempotency_key": "9c987819-b5e9-4357-abe6-52c1e6a2e8b5",
                      "input": {
                        "nql": "EXPLAIN SELECT company_data.\"9561\".\"STATE\" FROM company_data.\"9561\"",
                        "compiled_sql": "..."
                      },
                      "request_source": {
                        "type": "api_user",
                        "company_id": 1,
                        "user_id": 1414
                      },
                      "result": null,
                      "state": "running",
                      "updated_at": "2025-04-11T23:37:41.168859Z"
                    }
                  },
                  "compleated": {
                    "summary": "Compleated NQL forecast",
                    "value": {
                      "id": "ef628399-1c83-44ff-8525-69c3796cfc7c",
                      "company_id": 1,
                      "completed_at": "2025-04-11T23:37:49.983483Z",
                      "created_at": "2025-04-11T23:37:40.796820Z",
                      "failures": [],
                      "idempotency_key": "9c987819-b5e9-4357-abe6-52c1e6a2e8b5",
                      "input": {
                        "nql": "EXPLAIN SELECT company_data.\"9561\".\"STATE\" FROM company_data.\"9561\"",
                        "compiled_sql": "..."
                      },
                      "request_source": {
                        "type": "api_user",
                        "company_id": 1,
                        "user_id": 1414
                      },
                      "result": {
                        "rows": 123456789,
                        "cost": 1234567890,
                        "nql_type": "fore†cast",
                        "type": "success"
                      },
                      "state": "completed",
                      "updated_at": "2025-04-11T23:37:49.983488Z"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "This error is raised when the job cannot be found"
          }
        }
      }
    },
    "/payment-methods": {
      "description": "The `payment-methods` API allows you to set and get information about the `payment_method` objects owned by the authenticated account. Payment methods dictate how subscriptions will be charged.\n\n# Example Payment Method Object\n\n```json\n{\n  \"companyId\":1,\n  \"paymentMethodId\":\"pm_1IELxHLLDZZYA9lEXHZS4fun\",\n  \"cardBrand\":\"visa\",\n  \"cardLast4\":\"0000\"\n}\n\n# Fields\n- **companyId** The ID of the account assigned to this payment method\n- **paymentMethodId** The unique identifier for this payment method.\n- **cardBrand** (Optional) The brand of the credit card, if credit card\n- **cardLast4** (Optional) The last four digits of the credit card\n\n```\n",
      "get": {
        "summary": "Returns payment methods for company",
        "description": "# /payment-methods\n\nReturns payment methods for company",
        "tags": [
          "Payment Methods"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "companyId": {
                      "type": "integer",
                      "description": "The ID of the company"
                    },
                    "paymentMethodId": {
                      "type": "string",
                      "description": "The Stripe payment method ID"
                    },
                    "cardBrand": {
                      "type": "string",
                      "description": "The type of credit card"
                    },
                    "cardLast4": {
                      "type": "string",
                      "description": "The last four digits of the credit card"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/payment-methods/{payment_method_id}": {
      "delete": {
        "summary": "Deletes a payment method",
        "description": "# /payment-methods/{payment_method_id}\n\nDeletes a payment method",
        "tags": [
          "Payment Methods"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "payment_method_id",
            "required": true,
            "description": "Payment method id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success"
          }
        }
      }
    },
    "/payment-methods/credit-card/setup-intent": {
      "post": {
        "summary": "Creates a new setup intent",
        "description": "# /payment-methods/credit-card/setup-intent\n\nCreates a new setup intent",
        "tags": [
          "Payment Methods"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Stripe's setup intent payload"
          }
        }
      }
    },
    "/payment-methods/credit-card/setup-intent/{setup_intent_id}": {
      "post": {
        "summary": "Sets a valid SetupIntent as the primary payment method",
        "description": "# /payment-methods/credit-card/setup-intent/{setup_intent_id}\n\nSets a valid SetupIntent as the primary payment method",
        "tags": [
          "Payment Methods"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "setup_intent_id",
            "required": true,
            "description": "Setup Intent ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Success"
          }
        }
      }
    },
    "/admin/permissions": {
      "post": {
        "summary": "Create a permission",
        "description": "Create a new permission",
        "tags": [
          "Permissions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePermissionRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "This error is raised when the JSON is malformed.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "409": {
            "description": "This error is raised when permission already exists.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/admin/products": {
      "get": {
        "summary": "Get products",
        "description": "Get products paginated",
        "tags": [
          "Products"
        ],
        "parameters": [
          {
            "in": "query",
            "name": "per_page",
            "required": false,
            "description": "Number of records to return.",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "offset",
            "required": false,
            "description": "Number of records to skip (it's usually page_number * per_page).",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a product",
        "description": "Create a new product.",
        "tags": [
          "Products"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateProductRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the JSON is malformed, when company does not exists or when the same product already exists.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/admin/products/{sku}": {
      "get": {
        "summary": "Get product",
        "description": "Return single product",
        "parameters": [
          {
            "$ref": "#/components/parameters/Sku"
          }
        ],
        "tags": [
          "Products"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductResponse"
                }
              }
            }
          },
          "404": {
            "description": "If the product with that id doesn't exist"
          }
        }
      },
      "put": {
        "summary": "Update product",
        "description": "Update product by sku.",
        "parameters": [
          {
            "$ref": "#/components/parameters/Sku"
          }
        ],
        "tags": [
          "Products"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProductRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductResponse"
                }
              }
            }
          },
          "400": {
            "description": "If the product with that sku doesn't exist"
          }
        }
      }
    },
    "/admin/products/add-permission": {
      "post": {
        "summary": "Attach permission to product",
        "description": "Attaches given permission to a given product",
        "tags": [
          "Products"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateProductPermissionRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "This error is raised when the JSON is malformed, or  when product or permission doesn't exists.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/installations/{installation_id}/profiles": {
      "get": {
        "summary": "Returns app profiles",
        "parameters": [
          {
            "$ref": "#/components/parameters/InstallationId"
          }
        ],
        "tags": [
          "Profiles"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppProfilesResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Creates an app profile",
        "parameters": [
          {
            "$ref": "#/components/parameters/InstallationId"
          }
        ],
        "description": "The profile will be assigned a unique identifier upon creation. New profiles are \"disabled\" and should be activated after creation.",
        "tags": [
          "Profiles"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AppProfileRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The created profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppProfileResponse"
                }
              }
            }
          }
        }
      }
    },
    "/installations/{installation_id}/profiles/{app_profile_id}": {
      "get": {
        "summary": "Returns profile with {profile_id}",
        "tags": [
          "Profiles"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_ProfileId"
          },
          {
            "$ref": "#/components/parameters/InstallationId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppProfileResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Updates an existing app profile",
        "tags": [
          "Profiles"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_ProfileId"
          },
          {
            "$ref": "#/components/parameters/InstallationId"
          }
        ],
        "requestBody": {
          "description": "Profile creation payload",
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AppProfileUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The updated app profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppProfileResponse"
                }
              }
            }
          }
        }
      }
    },
    "/installations/{installation_id}/profiles/{app_profile_id}/enable": {
      "post": {
        "summary": "Enables a profile",
        "description": "Only profiles that are enabled will be considered when delivering subscriptions.",
        "tags": [
          "Profiles"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_ProfileId"
          },
          {
            "$ref": "#/components/parameters/InstallationId"
          }
        ],
        "responses": {
          "200": {
            "description": "The updated app profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppProfileResponse"
                }
              }
            }
          }
        }
      }
    },
    "/installations/{installation_id}/profiles/{app_profile_id}/disable": {
      "post": {
        "summary": "Disables a profile",
        "description": "Only profiles that are enabled will be considered when delivering subscriptions.",
        "tags": [
          "Profiles"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_ProfileId"
          },
          {
            "$ref": "#/components/parameters/InstallationId"
          }
        ],
        "responses": {
          "200": {
            "description": "The updated app profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppProfileResponse"
                }
              }
            }
          }
        }
      }
    },
    "/installations/{installation_id}/profiles/{app_profile_id}/archive": {
      "post": {
        "summary": "Archives a profile",
        "description": "Archiving prevents using the profile again in the future.",
        "tags": [
          "Profiles"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_ProfileId"
          },
          {
            "$ref": "#/components/parameters/InstallationId"
          }
        ],
        "responses": {
          "200": {
            "description": "The updated app profile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppProfileResponse"
                }
              }
            }
          }
        }
      }
    },
    "/v2/queries/{query_id}": {
      "get": {
        "summary": "Get a query by id",
        "description": "Get a query.",
        "tags": [
          "Queries"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/QueryId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueriesResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Updates a query",
        "description": "Updates a query",
        "parameters": [
          {
            "$ref": "#/components/parameters/QueryId"
          }
        ],
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateQueryRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueriesResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Deletes a query",
        "description": "Deletes a query",
        "parameters": [
          {
            "$ref": "#/components/parameters/QueryId"
          }
        ],
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/v2/queries": {
      "get": {
        "summary": "Get accessible queries",
        "description": "Get all accessible queries.",
        "tags": [
          "Queries"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/IsOwned"
          },
          {
            "$ref": "#/components/parameters/parameters_Tag"
          },
          {
            "$ref": "#/components/parameters/PageNumberQueryParam"
          },
          {
            "$ref": "#/components/parameters/PerPageQueryParam"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueriesPaginatedResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a query",
        "description": "Any number of properties can be updated on the same request.\nIf a property is not sent on the payload, the value won't be updated.",
        "tags": [
          "Queries"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateQueryRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/QueriesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/resources/buckets": {
      "get": {
        "summary": "Get buckets",
        "description": "Return the AWS S3 buckets assigned to the authenticated company.",
        "tags": [
          "Resources"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CompanyBucketsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create bucket",
        "description": "Create an AWS S3 bucket inside Narrative's AWS account assigned to the authenticated company.\n\nThe created bucket is uniquely accessible by the authenticated company and can be used to facilitate the automation of tasks like ingestion of data into a dataset.\n\nPay attention, that bucket-owner-full-control ACL is strictly required for \"bucket_policy\" type of access.",
        "tags": [
          "Resources"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CompanyBucketRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CompanyBucketResponse"
                }
              }
            }
          }
        }
      }
    },
    "/resources/update-access": {
      "post": {
        "summary": "Update access type",
        "description": "Update access type to the bucket.\nPay attention, that bucket-owner-full-control ACL is strictly required for \"bucket_policy\" type of access.\nAlso, bucket should be whitelisted for mutation. All buckets created by creation endpoint are mutable by default.\nBuckets created before 2023 could be immutable in case of customized policies.\nYou can call 'Get buckets' endpoint to check `is_access_mutable` property in response.",
        "tags": [
          "Resources"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBucketAccessTypeRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CompanyBucketResponse"
                }
              }
            }
          }
        }
      }
    },
    "/v2/inference": {
      "post": {
        "summary": "Infer the dataset schema of a file passed by multipart file.",
        "tags": [
          "Schema Inference"
        ],
        "security": [
          {}
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/MultipartFile"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "schema": {
                      "$ref": "#/components/schemas/DatasetSchema"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "description": "Error code.",
                      "type": "string"
                    },
                    "error_description": {
                      "description": "Human-friendly error message.",
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "error_description"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Internal error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "description": "Error code.",
                      "type": "string"
                    },
                    "error_description": {
                      "description": "Human-friendly error message.",
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "error_description"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/schema-presets/public": {
      "get": {
        "summary": "Returns all publicly available schema presets.",
        "description": "List the schema presets that are publicly available.",
        "tags": [
          "Schema Presets"
        ],
        "security": [
          {}
        ],
        "responses": {
          "200": {
            "description": "Returns all the schema presets accessible without authentication.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaPresetResponse"
                }
              }
            }
          }
        }
      }
    },
    "/schema-presets": {
      "get": {
        "summary": "Returns all available schema presets.",
        "description": "List the schema presets that are publicly available and the ones owned by the authenticated account.",
        "tags": [
          "Schema Presets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Returns all the schema presets available to the authenticated account or an empty list if no schema preset is available.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaPresetResponse"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a private schema preset.",
        "description": "Create a private schema preset owned by the authenticated account. Only members of the same organization are able to see this schema preset.",
        "tags": [
          "Schema Presets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SchemaPresetRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The newly create schema preset",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaPreset"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when:\n- The JSON is malformed or can't be decoded into 'SchemaPresetRequest'\n- When an attribute field is filterable but not required.\n- When trying to base a schema preset on a non-existing one.\n",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          }
        }
      }
    },
    "/schema-presets/{schema_preset_id}": {
      "get": {
        "summary": "Detail information on a schema preset by its id.",
        "description": "Returns detailed information on a specific schema preset given its id.",
        "tags": [
          "Schema Presets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SchemaPresetId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Returns the detail of a specific schema preset.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaPreset"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "404": {
            "description": "If a schema preset with that id don't exist."
          }
        }
      },
      "delete": {
        "summary": "Delete a schema preset by its id.",
        "description": "Archive (soft delete) a specific schema preset given its id. The schema preset will not be visible from that point forward.",
        "tags": [
          "Schema Presets"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SchemaPresetId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "204": {
            "description": "If the schema preset has been archived"
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "404": {
            "description": "If the schema preset with that id don't exist"
          }
        }
      }
    },
    "/admin/schema-presets": {
      "post": {
        "summary": "Create a public schema preset.",
        "description": "Create a **public** schema preset available platform wide. This endpoint is only available to administrators.",
        "tags": [
          "Schema Presets"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SchemaPresetRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SchemaPreset"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when:\n- The JSON is malformed or can't be decoded into 'SchemaPresetRequest'\n- When an attribute field is filterable but not required.\n- When trying to base a schema preset on a non-existing one.\n",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "401": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          },
          "403": {
            "description": "Authentication token is malformed, invalid or insufficient permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/schemapreset_Error"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions": {
      "get": {
        "operationId": "getSubscriptions",
        "summary": "Get subscriptions",
        "description": "Return all subscriptions belonging to the authenticated company.",
        "tags": [
          "Subscriptions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubscriptionsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "operationId": "createSubscription",
        "summary": "Create a subscription",
        "description": "Subscriptions created using this endpoint are left in the `pending` state and require activation.",
        "tags": [
          "Subscriptions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubscriptionCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubscriptionResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/cost-forecasts": {
      "get": {
        "summary": "Get cost forecasts",
        "description": "Return all cost forecasts belonging to the authenticated company.",
        "tags": [
          "Subscriptions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "The cost forecast for the subscription",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CostForecastsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a cost forecast",
        "description": "Create an estimate of the \"cost\" of servicing a set of subscription constraints.\n\nCost has two components:\n\n- The number of rows which must be read in order to find data which matches the subscription constraints.\n- An estimate of the \"size\" of those rows in bytes.\n\nNote: the number of rows reported in the cost is **not** an estimate of the number of rows which will be purchased as part of a subscription using the given constraints.",
        "tags": [
          "Subscriptions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MatchesRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MatchesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/cost-forecasts/{cost_forecast_id}": {
      "get": {
        "summary": "Get a cost forecast",
        "description": "Get a cost forecast by id.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/CostForecastId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CostForecastResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/matches": {
      "post": {
        "summary": "Get matches",
        "description": "Retrieve datasets matching a set of subscription constraints.",
        "tags": [
          "Subscriptions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MatchesRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MatchesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}": {
      "get": {
        "operationId": "getSubscription",
        "summary": "Get a subscription",
        "description": "Get a subscription by id.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubscriptionResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "operationId": "updateSubscription",
        "summary": "Update a subscription",
        "description": "Update a subscription\n\nNOTE: If the cadence of the subscription is modified, the frequency filter will\n      automatically be adjusted to match the new cadence.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubscriptionUpdateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubscriptionResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "operationId": "deleteSubscription",
        "summary": "Delete a subscription",
        "description": "Subscription deletion cannot be undone.\n\nIf a subscription is active it will be cancelled.",
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "tags": [
          "Subscriptions"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}/activate": {
      "post": {
        "tags": [
          "Subscriptions"
        ],
        "summary": "Activate a subscription",
        "description": "Activation will result in charges to your company's payment method.",
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubscriptionResponse"
                }
              }
            }
          },
          "400": {
            "description": "This error is raised when the subscription cannot be activated:\n- If the subscription is pending\n- The buyer company needs to have a non-zero credit limit",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "This error is raised when the subscription cannot be found"
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}/cancel": {
      "post": {
        "tags": [
          "Subscriptions"
        ],
        "summary": "Cancel a subscription",
        "description": "A cancelled subscription cannot be reactivated.",
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubscriptionResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}/checkout": {
      "post": {
        "tags": [
          "Subscriptions"
        ],
        "summary": "Checkout a subscription",
        "description": "Checkout creates and activates a subscription in a single API call.\n\nActivation will result in charges to your company's payment method.",
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubscriptionCreateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubscriptionResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}/cost-forecasts": {
      "get": {
        "summary": "Get subscription cost forecasts",
        "description": "Retrieve cost forecasts for a subscription.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CostForecastsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a cost forecast for a subscription",
        "description": "Create a cost forecast for a subscription, taking into account data already processed for the subscription.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CostForecastResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}/deliveries": {
      "get": {
        "summary": "Get deliveries",
        "description": "Retrieve metadata about files containing data purchased as part of the subscription.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeliveryFilesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}/deliveries/download": {
      "post": {
        "summary": "Get a delivered file",
        "description": "Retrieve a AWS S3 presigned URL to download a file delivered as part of a subscription.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DownloadFileRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DownloadFileResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}/matches": {
      "get": {
        "summary": "Get subscription matches",
        "description": "Retrieve datasets matching a subscription's constraints.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MatchesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/data-shops/subscriptions/{subscription_id}/schema": {
      "get": {
        "summary": "Get schema",
        "description": "Retrieve schema for deliveries from this subscription.",
        "tags": [
          "Subscriptions"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SubscriptionId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DataSchema"
                }
              }
            }
          }
        }
      }
    },
    "/uploads/{upload_path}": {
      "post": {
        "summary": "Upload a file",
        "description": "Sending a file to Narrative is a two step process. This endpoint allows you to request an `upload_url` which can be used in a `PUT` request to upload the file.\n\nFor example, once you have received an `upload_url` you could use it as follows:\n\n```bash\ncurl -v --upload-file my-file.csv {upload_url}\n```\n\nThe generated `upload_url` is only valid for 30 minutes after issuance.",
        "tags": [
          "Uploads"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/UploadPath"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "The upload url",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UploadUrl"
                }
              }
            }
          }
        }
      }
    },
    "/usage": {
      "post": {
        "operationId": "createUsage",
        "summary": "Create a usage event",
        "description": "Create a usage event to charge a customer for their use of a product.",
        "tags": [
          "Usage"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUsageRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateUsageResponse"
                }
              }
            }
          }
        }
      }
    },
    "/v2/views/{view_id}": {
      "get": {
        "summary": "Get a view by id",
        "description": "Get a view.",
        "tags": [
          "Views"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ViewId"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ViewsResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Updates a view",
        "description": "Updates a view",
        "parameters": [
          {
            "$ref": "#/components/parameters/ViewId"
          }
        ],
        "tags": [
          "Views"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateViewRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ViewsResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Archives a view",
        "description": "Archives a view",
        "parameters": [
          {
            "$ref": "#/components/parameters/ViewId"
          }
        ],
        "tags": [
          "Views"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/v2/views": {
      "get": {
        "summary": "Get accessible views",
        "description": "Get all accessible views.",
        "tags": [
          "Views"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/parameters_IsOwned"
          },
          {
            "$ref": "#/components/parameters/parameters_Tag-2"
          },
          {
            "$ref": "#/components/parameters/PageNumberQueryParam"
          },
          {
            "$ref": "#/components/parameters/PerPageQueryParam"
          }
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ViewsPaginatedResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a view",
        "description": "Any number of properties can be updated on the same request.\nIf a property is not sent on the payload, the value won't be updated.",
        "tags": [
          "Views"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateViewRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ViewsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/webhooks": {
      "get": {
        "summary": "List webhook subscriptions",
        "description": "Get all webhook subscriptions for the authenticated company.",
        "tags": [
          "Webhooks"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscriptionsResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a webhook subscription",
        "description": "Create a new webhook subscription for the authenticated company.",
        "tags": [
          "Webhooks"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateWebhookSubscriptionRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscriptionResponse"
                }
              }
            }
          }
        }
      }
    },
    "/webhooks/{webhook_subscription_id}": {
      "get": {
        "summary": "Get a webhook subscription by ID",
        "description": "Retrieve a specific webhook subscription.",
        "tags": [
          "Webhooks"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "webhook_subscription_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscriptionResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not Found"
          }
        }
      },
      "delete": {
        "summary": "Archive a webhook subscription",
        "description": "Archive the specified webhook subscription.",
        "tags": [
          "Webhooks"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "webhook_subscription_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Archived"
          },
          "404": {
            "description": "Not Found"
          }
        }
      }
    },
    "/whoami": {
      "get": {
        "summary": "Get a current user",
        "tags": [
          "Whoami"
        ],
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WhoamiResponse"
                }
              }
            }
          }
        }
      }
    }
  }
}
